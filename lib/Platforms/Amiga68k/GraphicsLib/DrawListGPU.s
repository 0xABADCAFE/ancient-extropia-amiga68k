
; Storm C Compiler
; Mendoza:Extropia/eXtropia/lib/Platforms/Amiga68k/GraphicsLib/DrawListGPU.cpp
	mc68030
	mc68881
	XREF	_0dt__DRAWLIST__T
	XREF	Delete__xTEXFONT__T
	XREF	Delete__xTEXSURF__T
	XREF	Create__xTEXSURF__TssEPvPUj
	XREF	Refresh__xDBSCREEN__T
	XREF	Close__xDBSCREEN__T
	XREF	Open__xDBSCREEN__T
	XREF	Close__xSCREEN__T
	XREF	Open__xSCREEN__T
	XREF	Set__xSCREEN__TP06xDMODEPCc
	XREF	Close__xDBWIN__T
	XREF	Open__xDBWIN__T
	XREF	Set__xDBWIN__TsssssPCc
	XREF	Idle__xDISPLAYIO_ASYNC__T
	XREF	Done__xDISPLAYIO_ASYNC__T
	XREF	Init__xDISPLAYIO_ASYNC__T
	XREF	MoveEvent__xDISPLAYIO__T
	XREF	ResizeEvent__xDISPLAYIO__T
	XREF	Idle__xDISPLAYIO__T
	XREF	HandleEvent__xDISPLAYIO__T
	XREF	ApplyInputModification__xDISPLAYIO__T
	XREF	ViewSurface__xDISPLAY__T
	XREF	DrawSurface__xDISPLAY__T
	XREF	Refresh__xDISPLAY__T
	XREF	Close__xDISPLAY__T
	XREF	Open__xDISPLAY__T
	XREF	Close__xFILEIO__T
	XREF	Write__xFILEIO__TPvUiUi
	XREF	Read__xFILEIO__TPvUiUi
	XREF	Open__xFILEIO__TPCcjj
	XREF	SendPacket__xFILEIO__TPv
	XREF	WaitPacket__xFILEIO__T
	XREF	InputQueued__xINPUT__T
	XREF	Idle__xINPUT__T
	XREF	ExitEvent__xINPUT__T
	XREF	MouseEvent__xINPUT__Tjjj
	XREF	ApplyInputModification__xINPUT__T
	XREF	_0dt__xKEY__T
	XREF	_0ct__xKEY__T
	XREF	KeyEvent__xKEY__Tjsj
	XREF	_0dt__xSURFACE__T
	XREF	_0dt__POOL_ST__T
	XREF	_0ct__POOL_ST__TUsUj
	XREF	FreeT__POOL_ST__TPv
	XREF	NewT__POOL_ST__TPvUs
	XREF	NewT__POOL_ST__TPv
	XREF	Create__POOL_ST__TUsUj
	XREF	PrintAlloc__POOL_ST__TR07ostreamjj
	XREF	_0dt__POOL_LT__T
	XREF	DrawLineStrip__x3D__jj
	XREF	DrawLines__x3D__jj
	XREF	SetDrawArea__x3D__ssss
	XREF	SetFogProperties__x3D__EUjfff
	XREF	SetColour__x3D__Uj
	XREF	SetVertexArray__x3D__P07DVERTEX
	XREF	DrawSurface__x3D__P08xSURFACE
	XREF	UnLink__xCHAINABLE__T
	XREF	_0ct__xTHREADABLE__TPCcUjjs
	XREF	ShutDown__xTHREADABLE__T
	XREF	Done__xTHREADABLE__T
	XREF	Init__xTHREADABLE__T
	XREF	_0dt__xLOCKABLE__T
	XREF	Zero__MEM__PvUi
	XREF	MessageBox__sysBASELIB__PcPcPce
	XREF	_system
	XREF	op__leftshift__ostream__Td
	XREF	op__leftshift__ostream__TUj
	XREF	op__leftshift__ostream__Tj
	XREF	op__leftshift__ostream__TPCc
	XREF	op__leftshift__ostream__Tc
	XREF	opfx__ostream__T
	XREF	read__istream__TPci
	XREF	get__istream__TRc
	XREF	getline__istream__TPcic
	XREF	get__istream__TPcic
	XREF	op__rightshift__istream__TRc
	XREF	op__rightshift__istream__TPc
	XREF	doallocate__streambuf__T
	XREF	xsgetn__streambuf__TPci
	XREF	xsputn__streambuf__TPCci
	XREF	underflow__streambuf__T
	XREF	overflow__streambuf__Ti
	XREF	setbuf__streambuf__TPcUi
	XREF	sputn__streambuf__TPCci
	XREF	_0dt__streambuf__T
	XREF	userword__ios__Ti
	XREF	init__ios__TP09streambuf
	XREF	_std__in
	XREF	_std__out
	XREF	_std__err
	XREF	_basefield__ios
	XREF	_adjustfield__ios
	XREF	_floatfield__ios
	XREF	_aNextBit__ios
	XREF	_aNextWord__ios
	XREF	_cin
	XREF	_cout
	XREF	_cerr
	XREF	_clog
	XREF	_st
	XREF	_gxSt
	XREF	_errSev__xBASELIB
	XREF	_errTbl__xBASELIB
	XREF	_SysBase
	XREF	_IntuitionBase
	XREF	_DOSBase
	XREF	_PowerPCBase
	XREF	_sysData__sysBASELIB
	XREF	_msgbuff__sysBASELIB
	XREF	_main__sysBASELIB
	XREF	_allocated__MEM
	XREF	_totSize__MEM
	XREF	_nextFree__MEM
	XREF	_cnt__MEM
	XREF	_maxAllocs__MEM
	XREF	_GfxBase
	XREF	_TimerBase
	XREF	_TimerBase__xTIMABLE
	XREF	_current__xTIMABLE
	XREF	_clockFreq__xTIMABLE
	XREF	_threadCnt__xTHREADABLE
	XREF	_main__xTHREADABLE
	XREF	_CyberGfxBase
	XREF	_formatNames__x2D
	XREF	_surfaceTypes__x2D
	XREF	_Warp3DBase
	XREF	_pointRender__SUPPORTS3D
	XREF	_lineRender__SUPPORTS3D
	XREF	_triangleRender__SUPPORTS3D
	XREF	_otherPrimitives__SUPPORTS3D
	XREF	_shadingModes__SUPPORTS3D
	XREF	_textureModes__SUPPORTS3D
	XREF	_textureFmts__SUPPORTS3D
	XREF	_alpha__SUPPORTS3D
	XREF	_fogModes__SUPPORTS3D
	XREF	_zBuffer__SUPPORTS3D
	XREF	_stencil__SUPPORTS3D
	XREF	_misc__SUPPORTS3D
	XREF	_primNames__SUPPORTS3D
	XREF	_renderNames__SUPPORTS3D
	XREF	_shadingNames__SUPPORTS3D
	XREF	_texModeNames__SUPPORTS3D
	XREF	_texFormatNames__SUPPORTS3D
	XREF	_alphaNames__SUPPORTS3D
	XREF	_fogNames__SUPPORTS3D
	XREF	_zBufferNames__SUPPORTS3D
	XREF	_stencilNames__SUPPORTS3D
	XREF	_miscNames__SUPPORTS3D
	XREF	_hw3D__SUPPORTS3D
	XREF	_context__x3D
	XREF	_drawRegion__x3D
	XREF	_fogData__x3D
	XREF	_flags__x3D
	XREF	_vertices__x3D
	XREF	_currTex__x3D
	XREF	_drawSurface__x3D
	XREF	_currCol__x3D
	XREF	_flags__xGFX
	XREF	_mode__xGFX
	XREF	_numModes__xGFX
	XREF	_rPool__xSURFACE
	XREF	_KeymapBase
	XREF	_useCount__xKEY
	XREF	_DiskfontBase
	XREF	_flags__DRAW
	XREF	_qTrigTab__DRAWLIST

	SECTION "_0ct__streampos__T:0",CODE

	rts

	SECTION "_opcodes__VGPU:0",CODE


L197
	dc.b	'<illegal> ',0
L193
	dc.b	'abort     ',0
L177
	dc.b	'blt bm2ds ',0
L178
	dc.b	'blt ds2bm ',0
L194
	dc.b	'breakpt   ',0
L167
	dc.b	'clip area ',0
L168
	dc.b	'clr rgb   ',0
L169
	dc.b	'clr zbf   ',0
L165
	dc.b	'done      ',0
L189
	dc.b	'dsbl st   ',0
L188
	dc.b	'enbl st   ',0
L195
	dc.b	'jsr       ',0
L171
	dc.b	'lines     ',0
L172
	dc.b	'linestrip ',0
L190
	dc.b	'lock mode ',0
L164
	dc.b	'noop      ',0
L176
	dc.b	'ostext    ',0
L170
	dc.b	'points    ',0
L192
	dc.b	'pop dvs   ',0
L191
	dc.b	'push dvs  ',0
L196
	dc.b	'ret       ',0
L166
	dc.b	'rsrv data ',0
L187
	dc.b	'set acmp  ',0
L179
	dc.b	'set blndfn',0
L182
	dc.b	'set col   ',0
L180
	dc.b	'set fogdat',0
L185
	dc.b	'set fogmd ',0
L184
	dc.b	'set lop   ',0
L181
	dc.b	'set rgbmsk',0
L183
	dc.b	'set tex   ',0
L186
	dc.b	'set zcmp  ',0
L174
	dc.b	'trifan    ',0
L173
	dc.b	'tris      ',0
L175
	dc.b	'tristrip  ',0

	SECTION "_opcodes__VGPU:1",DATA

	XDEF	_opcodes__VGPU
_opcodes__VGPU
	dc.l	L164,L165,L166,L167,L168,L169,L170,L171,L172,L173,L174
	dc.l	L175,L176,L177,L178,L179,L180,L181,L182,L183,L184,L185
	dc.l	L186,L187,L188,L189,L190,L191,L192,L193,L194,L195,L196
	dc.l	L197,0

	SECTION "_stack__VGPU:0",CODE


	XDEF	_INIT_8_DrawListGPU_cpp__stack__VGPU
_INIT_8_DrawListGPU_cpp__stack__VGPU
L199
;DVSTACKDATA		VGPU::stack[DVSTACK_DEPTH]	= {0};
	move.l	#_stack__VGPU,a0
	lea	$8(a0),a0
	moveq	#$1D,d0
L200
	clr.l	(a0)+
	dbra	d0,L200
	rts

	SECTION "_stack__VGPU:1",DATA

	XDEF	_stack__VGPU
_stack__VGPU
	dc.l	0
	ds.b	124

	SECTION "_stackPos__VGPU:1",DATA

	XDEF	_stackPos__VGPU
_stackPos__VGPU
	dc.l	0

	SECTION "_vertexBase__VGPU:1",DATA

	XDEF	_vertexBase__VGPU
_vertexBase__VGPU
	dc.l	0

	SECTION "_vertexTop__VGPU:1",DATA

	XDEF	_vertexTop__VGPU
_vertexTop__VGPU
	dc.l	0

	SECTION "_dataPos__VGPU:1",DATA

	XDEF	_dataPos__VGPU
_dataPos__VGPU
	dc.l	0

	SECTION "_instPos__VGPU:1",DATA

	XDEF	_instPos__VGPU
_instPos__VGPU
	dc.l	0

	SECTION "_exe_flags__VGPU:1",DATA

	XDEF	_exe_flags__VGPU
_exe_flags__VGPU
	dc.l	0

	SECTION "_exe_errReg__VGPU:1",DATA

	XDEF	_exe_errReg__VGPU
_exe_errReg__VGPU
	dc.l	0

	SECTION "_exe_stateReg__VGPU:1",DATA

	XDEF	_exe_stateReg__VGPU
_exe_stateReg__VGPU
	dc.l	0

	SECTION "_exe_colourReg__VGPU:1",DATA

	XDEF	_exe_colourReg__VGPU
_exe_colourReg__VGPU
	dc.l	0

	SECTION "_exe_texReg__VGPU:1",DATA

	XDEF	_exe_texReg__VGPU
_exe_texReg__VGPU
	dc.l	0

	SECTION "_exe_fogReg__VGPU:1",DATA

	XDEF	_exe_fogReg__VGPU
_exe_fogReg__VGPU
	dc.l	0

	SECTION "_funcTab__VGPU:1",DATA

	XDEF	_funcTab__VGPU
_funcTab__VGPU
	dc.l	_DrawDummy__VGPU__r8Pv,_DrawDummy__VGPU__r8Pv,_Skip__VGPU__r8Pv,_Clip__VGPU__r8Pv,_ClearRGB__VGPU__r8Pv,_ClearDepth__VGPU__r8Pv,_DrawPoints__VGPU__r8Pv,_DrawLines__VGPU__r8Pv,_DrawLineStrip__VGPU__r8Pv,_DrawTris__VGPU__r8Pv,_DrawTrifan__VGPU__r8Pv
	dc.l	_DrawTriStrip__VGPU__r8Pv,_DrawOSText__VGPU__r8Pv,_Blit__VGPU__r8Pv,_Blit2__VGPU__r8Pv,_BlendMode__VGPU__r8Pv,_FogParms__VGPU__r8Pv,_ColourMask__VGPU__r8Pv,_SetColour__VGPU__r8Pv,_SetTexture__VGPU__r8Pv,_SetLogic__VGPU__r8Pv,_SetFogMode__VGPU__r8Pv
	dc.l	_SetZCompare__VGPU__r8Pv,_SetACompare__VGPU__r8Pv,_Enable__VGPU__r8Pv,_Disable__VGPU__r8Pv,_Lock__VGPU__r8Pv,_PushDVS__VGPU__r8Pv,_PopDVS__VGPU__r8Pv,_Abort__VGPU__r8Pv,_BreakPoint__VGPU__r8Pv,_DrawDummy__VGPU__r8Pv,_DrawDummy__VGPU__r8Pv

	SECTION "ExecuteBuffer__VGPU__sP08DCOMMANDP07DVERTEXjj:0",CODE


;sint32 VGPU::ExecuteBuffer(bool initRegs, DCOMMAND* insts, DVERTEX* 
	XDEF	ExecuteBuffer__VGPU__sP08DCOMMANDP07DVERTEXjj
ExecuteBuffer__VGPU__sP08DCOMMANDP07DVERTEXjj
	movem.l	d2/d3/a2/a3/a6,-(a7)
	move.l	$26(a7),d0
	move.l	$22(a7),d2
	move.l	$1E(a7),a0
	move.l	$1A(a7),a2
L222
;	if (!x3D::Context() || !insts || !vData || num <= 0 || dcnt <= 0)
	tst.l	_context__x3D
	beq.b	L227
L223
	cmp.w	#0,a2
	beq.b	L227
L224
	cmp.w	#0,a0
	beq.b	L227
L225
	cmp.l	#0,d2
	ble.b	L227
L226
	cmp.l	#0,d0
	bgt.b	L230
L227
;		cout << "VGPU::ExecuteBuffer() : Illegal args\n";
	move.l	#L213,-(a7)
	move.l	_cout,a0
	cmp.w	#0,a0
	beq.b	L229
L228
	addq.w	#4,a0
L229
	move.l	a0,-(a7)
	jsr	op__leftshift__ostream__TPCc
	addq.w	#$8,a7
	move.l	#-$3010000,d0
	movem.l	(a7)+,d2/d3/a2/a3/a6
	rts
L230
;	vertexBase	= vData;
	move.l	a0,_vertexBase__VGPU
;	vertexTop		= vData+dcnt;
	asl.l	#5,d0
	add.l	a0,d0
	move.l	d0,_vertexTop__VGPU
;	x3D::SetVertexArray(vertexBase);
	move.l	_vertexBase__VGPU,-(a7)
	jsr	SetVertexArray__x3D__P07DVERTEX
	addq.w	#4,a7
;	dataPos = 0;
	clr.l	_dataPos__VGPU
;	instPos = 0;
	clr.l	_instPos__VGPU
;	if (x3D::LockHW()==FALSE)
	move.l	_flags__x3D,d0
	and.l	#1,d0
	beq.b	L232
L231
	moveq	#1,d0
	bra.b	L235
L232
	move.l	_context__x3D,a0
	move.l	_Warp3DBase,a6
	jsr	-$3C(a6)
	tst.l	d0
	bne.b	L234
L233
	or.l	#1,_flags__x3D
	moveq	#1,d0
	bra.b	L235
L234
	and.l	#-2,_flags__x3D
	moveq	#0,d0
L235
	tst.w	d0
	bne.b	L239
L236
;		cout << "VGPU::ExecuteBuffer() : locking failed\n";
	move.l	#L214,-(a7)
	move.l	_cout,a0
	cmp.w	#0,a0
	beq.b	L238
L237
	addq.w	#4,a0
L238
	move.l	a0,-(a7)
	jsr	op__leftshift__ostream__TPCc
	addq.w	#$8,a7
	move.l	#-$3050005,d0
	movem.l	(a7)+,d2/d3/a2/a3/a6
	rts
L239
;	sint32	lastOp = 0;
	moveq	#0,d3
;	void*		lastArg = 0;
	sub.l	a3,a3
;		exe_flags							= LOCKED;
	move.l	#1,_exe_flags__VGPU
;		exe_errReg						= ERR_NONE;
	clr.l	_exe_errReg__VGPU
;		register DCOMMAND* c	= insts;
	move.l	a2,a6
;		rsint32 i							=	num+1;
	addq.l	#1,d2
;		while (--i && exe_errReg==ERR_NONE)
	bra.b	L241
L240
;			lastOp 	= c->opcode;
	move.l	(a6),d3
;			lastArg	= c->arg;
	move.l	4(a6),a3
;			funcTab[c->opcode](c->arg);
	move.l	(a6),d0
	move.l	#_funcTab__VGPU,a2
	move.l	0(a2,d0.l*4),a1
	move.l	4(a6),a0
	jsr	(a1)
;	c++;
	addq.w	#$8,a6
; instPos++;
	addq.l	#1,_instPos__VGPU
L241
	subq.l	#1,d2
	tst.l	d2
	beq.b	L243
L242
	tst.l	_exe_errReg__VGPU
	beq.b	L240
L243
;		x3D::FlushFrame();
	move.l	_context__x3D,a0
	move.l	_Warp3DBase,a6
	jsr	-$1B0(a6)
;	x3D::UnLockHW();
	and.l	#-2,_flags__x3D
	move.l	_context__x3D,a0
	move.l	_Warp3DBase,a6
	jsr	-$42(a6)
;	if (exe_errReg)
	tst.l	_exe_errReg__VGPU
	beq	L250
L244
;		switch(exe_errReg)
	move.l	_exe_errReg__VGPU,d0
	cmp.l	#3,d0
	beq	L247
	bhi.b	L254
	cmp.l	#1,d0
	beq.b	L245
	cmp.l	#2,d0
	beq.b	L246
	bra	L249
L254
	cmp.l	#4,d0
	beq	L248
	bra	L249
;			
L245
;				sysBASELIB::MessageBox("Debug Info","Proceed","V
	move.l	_exe_texReg__VGPU,-(a7)
	move.l	_exe_colourReg__VGPU,-(a7)
	move.l	_exe_stateReg__VGPU,-(a7)
	move.l	a3,-(a7)
	move.l	#_opcodes__VGPU,a1
	move.l	0(a1,d3.l*4),-(a7)
	move.l	#L215,-(a7)
	move.l	#L216,-(a7)
	move.l	#L217,-(a7)
	jsr	MessageBox__sysBASELIB__PcPcPce
	add.w	#$20,a7
;			
L246
;				sysBASELIB::MessageBox("Debug Info","Proceed","V
	move.l	_exe_texReg__VGPU,-(a7)
	move.l	_exe_colourReg__VGPU,-(a7)
	move.l	_exe_stateReg__VGPU,-(a7)
	move.l	a3,-(a7)
	move.l	#_opcodes__VGPU,a1
	move.l	0(a1,d3.l*4),-(a7)
	move.l	#L218,-(a7)
	move.l	#L216,-(a7)
	move.l	#L217,-(a7)
	jsr	MessageBox__sysBASELIB__PcPcPce
	add.w	#$20,a7
;				
	bra	L250
L247
;				sysBASELIB::MessageBox("Debug Info","Proceed","V
	move.l	_exe_texReg__VGPU,-(a7)
	move.l	_exe_colourReg__VGPU,-(a7)
	move.l	_exe_stateReg__VGPU,-(a7)
	move.l	a3,-(a7)
	move.l	#_opcodes__VGPU,a1
	move.l	0(a1,d3.l*4),-(a7)
	move.l	#L219,-(a7)
	move.l	#L216,-(a7)
	move.l	#L217,-(a7)
	jsr	MessageBox__sysBASELIB__PcPcPce
	add.w	#$20,a7
;				
	bra	L250
L248
;				sysBASELIB::MessageBox("Debug Info","Proceed","V
	move.l	_exe_texReg__VGPU,-(a7)
	move.l	_exe_colourReg__VGPU,-(a7)
	move.l	_exe_stateReg__VGPU,-(a7)
	move.l	a3,-(a7)
	move.l	#_opcodes__VGPU,a1
	move.l	0(a1,d3.l*4),-(a7)
	move.l	#L220,-(a7)
	move.l	#L216,-(a7)
	move.l	#L217,-(a7)
	jsr	MessageBox__sysBASELIB__PcPcPce
	add.w	#$20,a7
;			
L249
;				sysBASELIB::MessageBox("Debug Info","Proceed","V
	move.l	_exe_texReg__VGPU,-(a7)
	move.l	_exe_colourReg__VGPU,-(a7)
	move.l	_exe_stateReg__VGPU,-(a7)
	move.l	_exe_errReg__VGPU,-(a7)
	move.l	a3,-(a7)
	move.l	#_opcodes__VGPU,a1
	move.l	0(a1,d3.l*4),-(a7)
	move.l	#L221,-(a7)
	move.l	#L216,-(a7)
	move.l	#L217,-(a7)
	jsr	MessageBox__sysBASELIB__PcPcPce
	add.w	#$24,a7
;				
L250
	tst.l	_exe_errReg__VGPU
	bne.b	L252
L251
	moveq	#0,d0
	bra.b	L253
L252
	move.l	#-$3050005,d0
L253
	movem.l	(a7)+,d2/d3/a2/a3/a6
	rts

L217
	dc.b	'Debug Info',0
L216
	dc.b	'Proceed',0
L218
	dc.b	'VGPU : %s %0X',$A,'Draw failed',$A,$A
	dc.b	'stateReg : %0X',$A,'colourReg : %0X',$A,'texReg : %p',0
L215
	dc.b	'VGPU : %s %0X',$A,'Locking failed',$A,$A
	dc.b	'stateReg : %0X',$A,'colourReg : %0X',$A,'texReg : %p',0
L219
	dc.b	'VGPU : %s %0X',$A,'Stack overflow',$A,$A
	dc.b	'stateReg : %0X',$A,'colourReg : %0X',$A,'texReg : %p',0
L220
	dc.b	'VGPU : %s %0X',$A,'Stack underflow',$A,$A
	dc.b	'stateReg : %0X',$A,'colourReg : %0X',$A,'texReg : %p',0
L221
	dc.b	'VGPU : %s %0X',$A,'Undiagnosed error %d',$A,$A
	dc.b	'stateReg : %0X',$A,'colourReg : %0X',$A,'texReg : %p',0
L213
	dc.b	'VGPU::ExecuteBuffer() : Illegal args',$A,0
L214
	dc.b	'VGPU::ExecuteBuffer() : locking failed',$A,0

	SECTION "_DrawDummy__VGPU__r8Pv:0",CODE


;void VGPU::_DrawDummy(REGP(0) void* arg)
	XDEF	_DrawDummy__VGPU__r8Pv
_DrawDummy__VGPU__r8Pv
L255
;void VGPU::_DrawDummy(REGP(0) void* arg)
	rts

	SECTION "_Skip__VGPU__r8Pv:0",CODE


;void VGPU::_Skip(REGP(0) void* arg)
	XDEF	_Skip__VGPU__r8Pv
_Skip__VGPU__r8Pv
L256
;	ruint32 num = (uint32)arg;
;	dataPos+=num;
	move.l	_dataPos__VGPU,d0
	add.l	a0,d0
	move.l	d0,_dataPos__VGPU
	rts

	SECTION "_Clip__VGPU__r8Pv:0",CODE


;void VGPU::_Clip(REGP(0) void* arg)
	XDEF	_Clip__VGPU__r8Pv
_Clip__VGPU__r8Pv
L257
;	register DVERTEX* v = vertexBase+dataPos;
	move.l	_dataPos__VGPU,d0
	asl.l	#5,d0
	move.l	_vertexBase__VGPU,a1
	lea	0(a1,d0.l),a0
;	x3D::SetDrawArea(v->x1, v->y1, v->x2, v->y2);
	move.w	$E(a0),-(a7)
	move.w	$A(a0),-(a7)
	move.w	6(a0),-(a7)
	move.w	2(a0),-(a7)
	jsr	SetDrawArea__x3D__ssss
	addq.w	#$8,a7
;	dataPos++;
	addq.l	#1,_dataPos__VGPU
	rts

	SECTION "_ClearRGB__VGPU__r8Pv:0",CODE


;void VGPU::_ClearRGB(REGP(0) void* arg)
	XDEF	_ClearRGB__VGPU__r8Pv
_ClearRGB__VGPU__r8Pv
	move.l	a6,-(a7)
L258
;	exe_errReg = (x3D::Clear((uint32)arg) ? 0 : ERR_DRAW);
	move.l	a0,d0
	move.l	_context__x3D,a0
	move.l	_Warp3DBase,a6
	jsr	-$1C2(a6)
	tst.l	d0
	seq	d0
	and.l	#1,d0
	tst.w	d0
	beq.b	L260
L259
	moveq	#0,d0
	bra.b	L261
L260
	moveq	#2,d0
L261
	move.l	d0,_exe_errReg__VGPU
	move.l	(a7)+,a6
	rts

	SECTION "_ClearDepth__VGPU__r8Pv:0",CODE


;void VGPU::_ClearDepth(REGP(0) void* arg)
	XDEF	_ClearDepth__VGPU__r8Pv
_ClearDepth__VGPU__r8Pv
L266	EQU	-$8
	link	a5,#L266
	move.l	a6,-(a7)
L262
;	float64 d = ((float32)arg);
	fmove.l	a0,fp0
	fmove.d	fp0,-$8(a5)
;	exe_errReg = (x3D::ClearZBuffer(d) ? 0 : ERR_DRAW);
	move.l	_context__x3D,a0
	move.l	_Warp3DBase,a6
	lea	-$8(a5),a1
	jsr	-$E4(a6)
	tst.l	d0
	seq	d0
	and.l	#1,d0
	tst.w	d0
	beq.b	L264
L263
	moveq	#0,d0
	bra.b	L265
L264
	moveq	#2,d0
L265
	move.l	d0,_exe_errReg__VGPU
	move.l	(a7)+,a6
	unlk	a5
	rts

	SECTION "_DrawPoints__VGPU__r8Pv:0",CODE


;void VGPU::_DrawPoints(REGP(0) void* arg)
	XDEF	_DrawPoints__VGPU__r8Pv
_DrawPoints__VGPU__r8Pv
L267
;	uint32 cnt = (uint32)arg;
	move.l	a0,d1
;	exe_errReg = (x3D::DrawPoints(dataPos, cnt) ? 0 : ERR_DRAW);
	bra.b	L269
L268
	moveq	#0,d0
	bra.b	L270
L269
	moveq	#2,d0
L270
	move.l	d0,_exe_errReg__VGPU
;	dataPos+=cnt;
	add.l	d1,_dataPos__VGPU
	rts

	SECTION "_DrawLines__VGPU__r8Pv:0",CODE


;void VGPU::_DrawLines(REGP(0) void* arg)
	XDEF	_DrawLines__VGPU__r8Pv
_DrawLines__VGPU__r8Pv
	move.l	d2,-(a7)
L271
;	uint32 cnt = (uint32)arg;
	move.l	a0,d2
;	exe_errReg = (x3D::DrawLines(dataPos, cnt) ? 0 : ERR_DRAW);
	move.l	d2,-(a7)
	move.l	_dataPos__VGPU,-(a7)
	jsr	DrawLines__x3D__jj
	addq.w	#$8,a7
	tst.w	d0
	beq.b	L273
L272
	moveq	#0,d0
	bra.b	L274
L273
	moveq	#2,d0
L274
	move.l	d0,_exe_errReg__VGPU
;	dataPos+=cnt;
	add.l	d2,_dataPos__VGPU
	move.l	(a7)+,d2
	rts

	SECTION "_DrawLineStrip__VGPU__r8Pv:0",CODE


;void VGPU::_DrawLineStrip(REGP(0) void* arg)
	XDEF	_DrawLineStrip__VGPU__r8Pv
_DrawLineStrip__VGPU__r8Pv
	move.l	d2,-(a7)
L275
;	uint32 cnt = (uint32)arg;
	move.l	a0,d2
;	exe_errReg = (x3D::DrawLineStrip(dataPos, cnt) ? 0 : ERR_DRAW);
	move.l	d2,-(a7)
	move.l	_dataPos__VGPU,-(a7)
	jsr	DrawLineStrip__x3D__jj
	addq.w	#$8,a7
	tst.w	d0
	beq.b	L277
L276
	moveq	#0,d0
	bra.b	L278
L277
	moveq	#2,d0
L278
	move.l	d0,_exe_errReg__VGPU
;	dataPos+=cnt;
	add.l	d2,_dataPos__VGPU
	move.l	(a7)+,d2
	rts

	SECTION "_DrawTris__VGPU__r8Pv:0",CODE


;void VGPU::_DrawTris(REGP(0) void* arg)
	XDEF	_DrawTris__VGPU__r8Pv
_DrawTris__VGPU__r8Pv
	movem.l	d2/a6,-(a7)
L279
;	uint32 cnt = (uint32)arg;
	move.l	a0,d2
;	exe_errReg = (x3D::DrawTris(dataPos, cnt) ? 0 : ERR_DRAW);
	move.l	_dataPos__VGPU,d1
	move.l	_context__x3D,a0
	move.l	_Warp3DBase,a6
	moveq	#0,d0
	jsr	-$204(a6)
	tst.l	d0
	seq	d0
	and.l	#1,d0
	tst.w	d0
	beq.b	L281
L280
	moveq	#0,d0
	bra.b	L282
L281
	moveq	#2,d0
L282
	move.l	d0,_exe_errReg__VGPU
;	dataPos+=cnt;
	add.l	d2,_dataPos__VGPU
	movem.l	(a7)+,d2/a6
	rts

	SECTION "_DrawTrifan__VGPU__r8Pv:0",CODE


;void VGPU::_DrawTrifan(REGP(0) void* arg)
	XDEF	_DrawTrifan__VGPU__r8Pv
_DrawTrifan__VGPU__r8Pv
	movem.l	d2/a6,-(a7)
L283
;	uint32 cnt = (uint32)arg;
	move.l	a0,d2
;	exe_errReg = (x3D::DrawTriFan(dataPos, cnt) ? 0 : ERR_DRAW);
	move.l	_dataPos__VGPU,d1
	move.l	_context__x3D,a0
	move.l	_Warp3DBase,a6
	moveq	#1,d0
	jsr	-$204(a6)
	tst.l	d0
	seq	d0
	and.l	#1,d0
	tst.w	d0
	beq.b	L285
L284
	moveq	#0,d0
	bra.b	L286
L285
	moveq	#2,d0
L286
	move.l	d0,_exe_errReg__VGPU
;	dataPos+=cnt;
	add.l	d2,_dataPos__VGPU
	movem.l	(a7)+,d2/a6
	rts

	SECTION "_DrawTriStrip__VGPU__r8Pv:0",CODE


;void VGPU::_DrawTriStrip(REGP(0) void* arg)
	XDEF	_DrawTriStrip__VGPU__r8Pv
_DrawTriStrip__VGPU__r8Pv
	movem.l	d2/a6,-(a7)
L287
;	uint32 cnt = (uint32)arg;
	move.l	a0,d2
;	exe_errReg = (x3D::DrawTriStrip(dataPos, cnt) ? 0 : ERR_DRAW);
	move.l	_dataPos__VGPU,d1
	move.l	_context__x3D,a0
	move.l	_Warp3DBase,a6
	moveq	#2,d0
	jsr	-$204(a6)
	tst.l	d0
	seq	d0
	and.l	#1,d0
	tst.w	d0
	beq.b	L289
L288
	moveq	#0,d0
	bra.b	L290
L289
	moveq	#2,d0
L290
	move.l	d0,_exe_errReg__VGPU
;	dataPos+=cnt;
	add.l	d2,_dataPos__VGPU
	movem.l	(a7)+,d2/a6
	rts

	SECTION "_DrawOSText__VGPU__r8Pv:0",CODE


;void VGPU::_DrawOSText(REGP(0) void* arg)
	XDEF	_DrawOSText__VGPU__r8Pv
_DrawOSText__VGPU__r8Pv
L291
;void VGPU::_DrawOSText(REGP(0) void* arg)
	rts

	SECTION "_Blit__VGPU__r8Pv:0",CODE


;void VGPU::_Blit(REGP(0) void* arg)
	XDEF	_Blit__VGPU__r8Pv
_Blit__VGPU__r8Pv
	movem.l	d2-d7/a2/a6,-(a7)
L292
;	register DVERTEX* v = vertexBase+dataPos;
	move.l	_dataPos__VGPU,d0
	asl.l	#5,d0
	move.l	_vertexBase__VGPU,a2
	lea	0(a2,d0.l),a1
;	x2D::BlitDirect((sysSURFACE*)arg, x3D::DrawSurface()->Handle()
	move.w	$16(a1),d3
	move.w	$12(a1),d2
	move.w	$E(a1),d5
	move.w	$A(a1),d4
	move.w	6(a1),d1
	move.w	2(a1),d0
	move.l	_drawSurface__x3D,a1
	tst.l	$C(a1)
	beq.b	L294
L293
	move.l	$C(a1),a1
	move.l	4(a1),a1
	bra.b	L295
L294
	sub.l	a1,a1
L295
	ext.l	d5
	move.w	d1,d6
	ext.l	d6
	sub.l	d6,d5
	ext.l	d4
	move.w	d0,d6
	ext.l	d6
	sub.l	d6,d4
	ext.l	d3
	ext.l	d2
	ext.l	d1
	ext.l	d0
	move.l	_GfxBase,a6
	move.l	#$C0,d6
	move.l	#$FF,d7
	sub.l	a2,a2
	jsr	-$1E(a6)
;	dataPos++;
	addq.l	#1,_dataPos__VGPU
	movem.l	(a7)+,d2-d7/a2/a6
	rts

	SECTION "_Blit2__VGPU__r8Pv:0",CODE


;void VGPU::_Blit2(REGP(0) void* arg)
	XDEF	_Blit2__VGPU__r8Pv
_Blit2__VGPU__r8Pv
	movem.l	d2-d7/a2/a6,-(a7)
	move.l	a0,a1
L296
;	register DVERTEX* v = vertexBase+dataPos;
	move.l	_dataPos__VGPU,d0
	asl.l	#5,d0
	move.l	_vertexBase__VGPU,a2
	lea	0(a2,d0.l),a0
;	x2D::BlitDirect(x3D::DrawSurface()->Handle(), (sysSURFACE*)ar
	move.w	$16(a0),d3
	move.w	$12(a0),d2
	move.w	$E(a0),d5
	move.w	6(a0),d4
	move.w	2(a0),d1
	move.w	$A(a0),d0
	move.l	_drawSurface__x3D,a0
	tst.l	$C(a0)
	beq.b	L298
L297
	move.l	$C(a0),a0
	move.l	4(a0),a0
	bra.b	L299
L298
	sub.l	a0,a0
L299
	ext.l	d5
	move.w	d1,d6
	ext.l	d6
	sub.l	d6,d5
	ext.l	d4
	move.w	d0,d6
	ext.l	d6
	sub.l	d6,d4
	ext.l	d3
	ext.l	d2
	ext.l	d1
	ext.l	d0
	move.l	_GfxBase,a6
	move.l	#$C0,d6
	move.l	#$FF,d7
	sub.l	a2,a2
	jsr	-$1E(a6)
;	dataPos++;
	addq.l	#1,_dataPos__VGPU
	movem.l	(a7)+,d2-d7/a2/a6
	rts

	SECTION "_BlendMode__VGPU__r8Pv:0",CODE


;void VGPU::_BlendMode(REGP(0) void* arg)
	XDEF	_BlendMode__VGPU__r8Pv
_BlendMode__VGPU__r8Pv
	movem.l	d2/a6,-(a7)
L300
;	ruint32 fac = (uint32)arg;
	move.l	a0,d0
;	x3D::SetBlendMode((BFUNC)(fac>>16), (BFUNC)(fac&0x0000FFFF));
	move.l	d0,d1
	and.l	#$FFFF,d1
	moveq	#$10,d2
	lsr.l	d2,d0
	move.l	_context__x3D,a0
	move.l	_Warp3DBase,a6
	jsr	-$BA(a6)
	movem.l	(a7)+,d2/a6
	rts

	SECTION "_FogParms__VGPU__r8Pv:0",CODE


;void VGPU::_FogParms(REGP(0) void* arg)
	XDEF	_FogParms__VGPU__r8Pv
_FogParms__VGPU__r8Pv
	move.l	a2,-(a7)
L301
;	register DVERTEX* v = vertexBase+dataPos;
	move.l	_dataPos__VGPU,d0
	asl.l	#5,d0
	move.l	_vertexBase__VGPU,a2
	lea	0(a2,d0.l),a1
;	exe_errReg = (x3D::SetFogProperties((FMODE)arg, v->data1, v->fy1, 
	move.l	$8(a1),-(a7)
	move.l	$8(a1),-(a7)
	move.l	4(a1),-(a7)
	move.l	(a1),-(a7)
	move.l	a0,-(a7)
	jsr	SetFogProperties__x3D__EUjfff
	add.w	#$14,a7
	tst.w	d0
	beq.b	L303
L302
	moveq	#0,d0
	bra.b	L304
L303
	moveq	#5,d0
L304
	move.l	d0,_exe_errReg__VGPU
;	dataPos++;
	addq.l	#1,_dataPos__VGPU
	move.l	(a7)+,a2
	rts

	SECTION "_ColourMask__VGPU__r8Pv:0",CODE


;void VGPU::_ColourMask(REGP(0) void* arg)
	XDEF	_ColourMask__VGPU__r8Pv
_ColourMask__VGPU__r8Pv
	movem.l	d2-d4/a6,-(a7)
L305
;	ruint32 c = (uint32)arg;
	move.l	a0,d0
;	exe_errReg = (x3D::SetMaskARGB(c) ? 0 : ERR_UNDEF);
	move.l	d0,d3
	and.l	#-$1000000,d3
	move.l	d0,d2
	and.l	#$FF,d2
	move.l	d0,d1
	and.l	#$FF00,d1
	and.l	#$FF0000,d0
	move.l	_context__x3D,a0
	move.l	_Warp3DBase,a6
	jsr	-$CC(a6)
	tst.l	d0
	seq	d0
	and.l	#1,d0
	tst.w	d0
	beq.b	L307
L306
	moveq	#0,d0
	bra.b	L308
L307
	moveq	#5,d0
L308
	move.l	d0,_exe_errReg__VGPU
	movem.l	(a7)+,d2-d4/a6
	rts

	SECTION "_SetColour__VGPU__r8Pv:0",CODE


;void VGPU::_SetColour(REGP(0) void* arg)
	XDEF	_SetColour__VGPU__r8Pv
_SetColour__VGPU__r8Pv
L309
;	ruint32 clr = (uint32)arg;
	move.l	a0,d0
;	exe_colourReg = clr;
	move.l	d0,_exe_colourReg__VGPU
;	exe_errReg = (x3D::SetColour(clr) ? 0 : ERR_UNDEF);
	move.l	d0,-(a7)
	jsr	SetColour__x3D__Uj
	addq.w	#4,a7
	tst.w	d0
	beq.b	L311
L310
	moveq	#0,d0
	bra.b	L312
L311
	moveq	#5,d0
L312
	move.l	d0,_exe_errReg__VGPU
	rts

	SECTION "_SetTexture__VGPU__r8Pv:0",CODE


;void VGPU::_SetTexture(REGP(0) void* arg)
	XDEF	_SetTexture__VGPU__r8Pv
_SetTexture__VGPU__r8Pv
	move.l	a6,-(a7)
	move.l	a0,a1
L313
;	exe_texReg = (sysTEXTURE*)arg;
	move.l	a1,_exe_texReg__VGPU
;	x3D::SetTexture((sysTEXTURE*)arg);
	move.l	a1,_currTex__x3D
	move.l	_context__x3D,a0
	move.l	_Warp3DBase,a6
	moveq	#0,d0
	jsr	-$1FE(a6)
	move.l	(a7)+,a6
	rts

	SECTION "_SetLogic__VGPU__r8Pv:0",CODE


;void VGPU::_SetLogic(REGP(0) void* arg)
	XDEF	_SetLogic__VGPU__r8Pv
_SetLogic__VGPU__r8Pv
	move.l	a6,-(a7)
L314
;	x3D::SetLogicOperation((LMODE)arg);
	move.l	a0,d1
	move.l	_context__x3D,a0
	move.l	_Warp3DBase,a6
	jsr	-$120(a6)
	move.l	(a7)+,a6
	rts

	SECTION "_SetFogMode__VGPU__r8Pv:0",CODE


;void VGPU::_SetFogMode(REGP(0) void* arg)
	XDEF	_SetFogMode__VGPU__r8Pv
_SetFogMode__VGPU__r8Pv
	move.l	a6,-(a7)
L315
;	exe_errReg = (x3D::SetFogMode((FMODE)arg) ? 0 : ERR_UNDEF);
	move.l	a0,d1
	move.l	_context__x3D,a0
	move.l	_Warp3DBase,a6
	move.l	#_fogData__x3D,a1
	jsr	-$C6(a6)
	tst.l	d0
	seq	d0
	and.l	#1,d0
	tst.w	d0
	beq.b	L317
L316
	moveq	#0,d0
	bra.b	L318
L317
	moveq	#5,d0
L318
	move.l	d0,_exe_errReg__VGPU
	move.l	(a7)+,a6
	rts

	SECTION "_SetZCompare__VGPU__r8Pv:0",CODE


;void VGPU::_SetZCompare(REGP(0) void* arg)
	XDEF	_SetZCompare__VGPU__r8Pv
_SetZCompare__VGPU__r8Pv
	move.l	a6,-(a7)
L319
;	exe_errReg = (x3D::SetZCompare((ZMODE)arg) ? 0 : ERR_UNDEF);
	move.l	a0,d1
	move.l	_context__x3D,a0
	move.l	_Warp3DBase,a6
	jsr	-$F6(a6)
	tst.l	d0
	seq	d0
	and.l	#1,d0
	tst.w	d0
	beq.b	L321
L320
	moveq	#0,d0
	bra.b	L322
L321
	moveq	#5,d0
L322
	move.l	d0,_exe_errReg__VGPU
	move.l	(a7)+,a6
	rts

	SECTION "_SetACompare__VGPU__r8Pv:0",CODE


;void VGPU::_SetACompare(REGP(0) void* arg)
	XDEF	_SetACompare__VGPU__r8Pv
_SetACompare__VGPU__r8Pv
	move.l	a6,-(a7)
L323
;	register DVERTEX* v = vertexBase+dataPos;
	move.l	_dataPos__VGPU,d0
	asl.l	#5,d0
	move.l	_vertexBase__VGPU,a1
	lea	0(a1,d0.l),a0
;	exe_errReg = (x3D::SetAlphaCompare(AMODE(v->data1), v->fy1) ? 0 : 
	lea	4(a0),a1
	move.l	(a0),d1
	move.l	_context__x3D,a0
	move.l	_Warp3DBase,a6
	jsr	-$B4(a6)
	tst.l	d0
	seq	d0
	and.l	#1,d0
	tst.w	d0
	beq.b	L325
L324
	moveq	#0,d0
	bra.b	L326
L325
	moveq	#5,d0
L326
	move.l	d0,_exe_errReg__VGPU
;	dataPos++;
	addq.l	#1,_dataPos__VGPU
	move.l	(a7)+,a6
	rts

	SECTION "_Enable__VGPU__r8Pv:0",CODE


;void VGPU::_Enable(REGP(0) void* arg)
	XDEF	_Enable__VGPU__r8Pv
_Enable__VGPU__r8Pv
	movem.l	d2/a6,-(a7)
L327
;	ruint32 state = (uint32)arg;
	move.l	a0,d0
;	exe_stateReg |= state;
	or.l	d0,_exe_stateReg__VGPU
;	exe_errReg = (x3D::Enable((STATE)state) ? 0 : ERR_UNDEF);
	move.l	_context__x3D,a0
	move.l	_Warp3DBase,a6
	moveq	#1,d1
	jsr	-$30(a6)
	tst.l	d0
	seq	d0
	and.l	#1,d0
	tst.w	d0
	beq.b	L329
L328
	moveq	#0,d0
	bra.b	L330
L329
	moveq	#5,d0
L330
	move.l	d0,_exe_errReg__VGPU
	movem.l	(a7)+,d2/a6
	rts

	SECTION "_Disable__VGPU__r8Pv:0",CODE


;void VGPU::_Disable(REGP(0) void* arg)
	XDEF	_Disable__VGPU__r8Pv
_Disable__VGPU__r8Pv
	movem.l	d2/a6,-(a7)
L331
;	ruint32 state = (uint32)arg;
	move.l	a0,d0
;	exe_stateReg &= ~state;
	move.l	d0,d1
	not.l	d1
	and.l	d1,_exe_stateReg__VGPU
;	exe_errReg = (x3D::Disable((STATE)state) ? 0 : ERR_UNDEF);
	move.l	_context__x3D,a0
	move.l	_Warp3DBase,a6
	moveq	#2,d1
	jsr	-$30(a6)
	tst.l	d0
	seq	d0
	and.l	#1,d0
	tst.w	d0
	beq.b	L333
L332
	moveq	#0,d0
	bra.b	L334
L333
	moveq	#5,d0
L334
	move.l	d0,_exe_errReg__VGPU
	movem.l	(a7)+,d2/a6
	rts

	SECTION "_Lock__VGPU__r8Pv:0",CODE


;void VGPU::_Lock(REGP(0) void* arg)
	XDEF	_Lock__VGPU__r8Pv
_Lock__VGPU__r8Pv
	move.l	a6,-(a7)
L335
;	if (((uint32)arg)==LOCKED)
	move.l	a0,d0
	cmp.l	#1,d0
	bne.b	L345
L336
;		if (x3D::LockHW())
	move.l	_flags__x3D,d0
	and.l	#1,d0
	beq.b	L338
L337
	moveq	#1,d0
	bra.b	L341
L338
	move.l	_context__x3D,a0
	move.l	_Warp3DBase,a6
	jsr	-$3C(a6)
	tst.l	d0
	bne.b	L340
L339
	or.l	#1,_flags__x3D
	moveq	#1,d0
	bra.b	L341
L340
	and.l	#-2,_flags__x3D
	moveq	#0,d0
L341
	tst.w	d0
	beq.b	L343
L342
;			exe_flags |= LOCKED;
	or.l	#1,_exe_flags__VGPU
	bra.b	L344
L343
;			exe_errReg = ERR_LOCK;
	move.l	#1,_exe_errReg__VGPU
;			exe_flags &= ~LOCKED;
	and.l	#-2,_exe_flags__VGPU
L344
	bra.b	L346
L345
;		exe_flags &= ~LOCKED;
	and.l	#-2,_exe_flags__VGPU
;		x3D::UnLockHW();
	and.l	#-2,_flags__x3D
	move.l	_context__x3D,a0
	move.l	_Warp3DBase,a6
	jsr	-$42(a6)
L346
	move.l	(a7)+,a6
	rts

	SECTION "_PushDVS__VGPU__r8Pv:0",CODE


;void VGPU::_PushDVS(REGP(0) void* arg)
	XDEF	_PushDVS__VGPU__r8Pv
_PushDVS__VGPU__r8Pv
	movem.l	d2/a2,-(a7)
L347
;	if (stackPos<DVSTACK_DEPTH && arg!=NOTSET)
	move.l	_stackPos__VGPU,d0
	cmp.l	#$10,d0
	bge.b	L354
L348
	cmp.w	#0,a0
	beq.b	L354
L349
;		stack[stackPos].vertexBase		= vertexBase;
	move.l	_stackPos__VGPU,d0
	move.l	#_stack__VGPU,a2
	move.l	_vertexBase__VGPU,0(a2,d0.l*8)
;		stack[stackPos++].vertexPos		= dataPos;
	move.l	_stackPos__VGPU,d0
	addq.l	#1,_stackPos__VGPU
	move.l	#_stack__VGPU,a2
	move.l	_dataPos__VGPU,4(a2,d0.l*8)
;		register DVERTEX* v = (DVERTEX*)arg;
	move.l	a0,a2
;		if (v>vertexBase && v<vertexTop)
	cmp.l	_vertexBase__VGPU,a2
	bls.b	L352
L350
	cmp.l	_vertexTop__VGPU,a2
	bhs.b	L352
L351
;			dataPos = v-vertexBase;
	move.l	a2,d0
	sub.l	_vertexBase__VGPU,d0
	moveq	#5,d1
	asr.l	d1,d0
	move.l	d0,_dataPos__VGPU
	bra.b	L353
L352
;			x3D::SetVertexArray(v);
	move.l	a2,-(a7)
	jsr	SetVertexArray__x3D__P07DVERTEX
	addq.w	#4,a7
;			vertexBase = v;
	move.l	a2,_vertexBase__VGPU
;			dataPos = 0;
	clr.l	_dataPos__VGPU
L353
	bra.b	L355
L354
;		exe_errReg = ERR_STACK_OVER;
	move.l	#3,_exe_errReg__VGPU
L355
	movem.l	(a7)+,d2/a2
	rts

	SECTION "_PopDVS__VGPU__r8Pv:0",CODE


;void VGPU::_PopDVS(REGP(0) void* arg)
	XDEF	_PopDVS__VGPU__r8Pv
_PopDVS__VGPU__r8Pv
	move.l	a2,-(a7)
L356
;	if (stackPos>0)
	move.l	_stackPos__VGPU,d0
	cmp.l	#0,d0
	ble.b	L360
L357
;		register DVERTEX* v = stack[--stackPos].vertexBase;
	subq.l	#1,_stackPos__VGPU
	move.l	_stackPos__VGPU,d0
	move.l	#_stack__VGPU,a1
	move.l	0(a1,d0.l*8),a2
;		if (vertexBase != v)
	move.l	_vertexBase__VGPU,a0
	cmp.l	a2,a0
	beq.b	L359
L358
;			x3D::SetVertexArray(v);
	move.l	a2,-(a7)
	jsr	SetVertexArray__x3D__P07DVERTEX
	addq.w	#4,a7
;			vertexBase = v;
	move.l	a2,_vertexBase__VGPU
L359
;		dataPos		= stack[stackPos].vertexPos;
	move.l	_stackPos__VGPU,d0
	move.l	#_stack__VGPU,a1
	move.l	4(a1,d0.l*8),_dataPos__VGPU
	bra.b	L361
L360
;		exe_errReg = ERR_STACK_UNDER;
	move.l	#4,_exe_errReg__VGPU
L361
	move.l	(a7)+,a2
	rts

	SECTION "_Abort__VGPU__r8Pv:0",CODE


;void VGPU::_Abort(REGP(0) void* arg)
	XDEF	_Abort__VGPU__r8Pv
_Abort__VGPU__r8Pv
L362
;	exe_errReg = ERR_UNDEF;
	move.l	#5,_exe_errReg__VGPU
	rts

	SECTION "_BreakPoint__VGPU__r8Pv:0",CODE


;void VGPU::_BreakPoint(REGP(0) void* arg)
	XDEF	_BreakPoint__VGPU__r8Pv
_BreakPoint__VGPU__r8Pv
	movem.l	a2/a6,-(a7)
	move.l	a0,a2
L366
;	if (exe_flags & LOCKED)
	move.l	_exe_flags__VGPU,d0
	and.l	#1,d0
	beq.b	L368
L367
;		x3D::UnLockHW();
	and.l	#-2,_flags__x3D
	move.l	_context__x3D,a0
	move.l	_Warp3DBase,a6
	jsr	-$42(a6)
L368
;		sysBASELIB::MessageBox("Debug Info","Proceed","VGPU 
	move.l	_exe_fogReg__VGPU,-(a7)
	move.l	_exe_texReg__VGPU,-(a7)
	move.l	_exe_colourReg__VGPU,-(a7)
	move.l	_exe_stateReg__VGPU,-(a7)
	move.l	_exe_flags__VGPU,-(a7)
	move.l	_dataPos__VGPU,-(a7)
	move.l	_instPos__VGPU,-(a7)
	move.l	a2,-(a7)
	move.l	#L363,-(a7)
	move.l	#L364,-(a7)
	move.l	#L365,-(a7)
	jsr	MessageBox__sysBASELIB__PcPcPce
	add.w	#$2C,a7
;	if (exe_flags & LOCKED)
	move.l	_exe_flags__VGPU,d0
	and.l	#1,d0
	beq.b	L378
L369
;		exe_errReg = (x3D::LockHW() ? 0 : ERR_LOCK);
	move.l	_flags__x3D,d0
	and.l	#1,d0
	beq.b	L371
L370
	moveq	#1,d0
	bra.b	L374
L371
	move.l	_context__x3D,a0
	move.l	_Warp3DBase,a6
	jsr	-$3C(a6)
	tst.l	d0
	bne.b	L373
L372
	or.l	#1,_flags__x3D
	moveq	#1,d0
	bra.b	L374
L373
	and.l	#-2,_flags__x3D
	moveq	#0,d0
L374
	tst.w	d0
	beq.b	L376
L375
	moveq	#0,d0
	bra.b	L377
L376
	moveq	#1,d0
L377
	move.l	d0,_exe_errReg__VGPU
L378
	movem.l	(a7)+,a2/a6
	rts

L365
	dc.b	'Debug Info',0
L364
	dc.b	'Proceed',0
L363
	dc.b	'VGPU breakpoint %d',$A
	dc.b	'instPos : %d',$A,'dataPos : %d',$A,'exe_flags %0X',$A,'exe_stateReg'
	dc.b	' : %0X',$A
	dc.b	'exe_colourReg : %0X',$A,'exe_texReg : %0p',$A,'exe_fogReg : %d',0

	END
