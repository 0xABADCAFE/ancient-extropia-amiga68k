
; Storm C Compiler
; Mendoza:Extropia/eXtropia/prj/AXON/main.cpp
	mc68030
	mc68881
	XREF	_0dt__BUILDING__T
	XREF	_0ct__BUILDING__T
	XREF	Render__BUILDING__TR04VIEW
	XREF	Place__BUILDING__TRC05VEC3Dfsss
	XREF	_0dt__PINETREE__T
	XREF	_0ct__PINETREE__T
	XREF	Render__PINETREE__TR04VIEW
	XREF	Place__PINETREE__TRC05VEC3Dfsss
	XREF	Render__RGBCUBE__TR04VIEW
	XREF	Place__RGBCUBE__TRC05VEC3Dfsss
	XREF	Render__MODEL__TR04VIEW
	XREF	Rotate__MODEL__Tsss
	XREF	Move__MODEL__TRC05VEC3D
	XREF	Place__MODEL__TRC05VEC3Dfsss
	XREF	ClipBox__MODEL__T
	XREF	Render__WORLDMAP__R04VIEW
	XREF	Done__WORLDMAP_
	XREF	Init__WORLDMAP__UjffffPc
	XREF	_0dt__MAPCELL__T
	XREF	Visibility__MAPCELL__TR04VIEW
	XREF	AddThing__MAPCELL__TR05MODELfffsss
	XREF	_0dt__VIEW__T
	XREF	_0ct__VIEW__TsssssPCc
	XREF	Camera__VIEW__Tfffss
	XREF	Close__VIEW__T
	XREF	Open__VIEW__T
	XREF	MoveEvent__VIEW__T
	XREF	ResizeEvent__VIEW__T
	XREF	ExitEvent__VIEW__T
	XREF	KeyEvent__VIEW__Tjs
	XREF	MouseEvent__VIEW__Tjjj
	XREF	Done__AXON_
	XREF	Init__AXON_
	XREF	op__multAsgn__TRANSFORM__TRC09TRANSFORM
	XREF	Rotate__TRANSFORM__Tfff
	XREF	Define__PLANE__TP03C3DP03C3DP03C3D
	XREF	Define__PLANE__TP05VEC3DP05VEC3DP05VEC3D
	XREF	_sqrt__r
	XREF	Done__xDRAW_
	XREF	Init__xDRAW__Uj
	XREF	SimpleText__xDRAW__UjUjPce
	XREF	RectShV__xDRAW__r14PUjUjUj
	XREF	Delete__xTEXTURE__T
	XREF	Create__xTEXTURE__TsssPvPUj
	XREF	Close__xDBWIN__T
	XREF	Open__xDBWIN__T
	XREF	Set__xDBWIN__TsssssPCc
	XREF	Idle__xDISPLAYIO_ASYNC__T
	XREF	Done__xDISPLAYIO_ASYNC__T
	XREF	Init__xDISPLAYIO_ASYNC__T
	XREF	MoveEvent__xDISPLAYIO__T
	XREF	ResizeEvent__xDISPLAYIO__T
	XREF	Idle__xDISPLAYIO__T
	XREF	HandleEvent__xDISPLAYIO__T
	XREF	ApplyInputModification__xDISPLAYIO__T
	XREF	ViewSurface__xDISPLAY__T
	XREF	DrawSurface__xDISPLAY__T
	XREF	Refresh__xDISPLAY__T
	XREF	Close__xDISPLAY__T
	XREF	Open__xDISPLAY__T
	XREF	_0dt__xSURFACE__T
	XREF	Done__xGFX_
	XREF	Init__xGFX_
	XREF	_0dt__POOL_ST__T
	XREF	_0ct__POOL_ST__TUsUj
	XREF	FreeT__POOL_ST__TPv
	XREF	NewT__POOL_ST__TPvUs
	XREF	NewT__POOL_ST__TPv
	XREF	Create__POOL_ST__TUsUj
	XREF	PrintAlloc__POOL_ST__TR07ostreamjj
	XREF	_0dt__POOL_LT__T
	XREF	Close__xFILEIO__T
	XREF	Write__xFILEIO__TPvUiUi
	XREF	Read__xFILEIO__TPvUiUi
	XREF	Open__xFILEIO__TPCcjj
	XREF	SendPacket__xFILEIO__TPv
	XREF	WaitPacket__xFILEIO__T
	XREF	InputQueued__xINPUT__T
	XREF	Idle__xINPUT__T
	XREF	ExitEvent__xINPUT__T
	XREF	KeyEvent__xINPUT__Tjs
	XREF	MouseEvent__xINPUT__Tjjj
	XREF	ApplyInputModification__xINPUT__T
	XREF	UnLink__xCHAINABLE__T
	XREF	_0ct__xTHREADABLE__TPCcUjjs
	XREF	ShutDown__xTHREADABLE__T
	XREF	Done__xTHREADABLE__T
	XREF	Init__xTHREADABLE__T
	XREF	_0dt__xLOCKABLE__T
	XREF	FreeLock__xLOCKABLE__Ts
	XREF	WaitLock__xLOCKABLE__T
	XREF	_0dt__sysRTLIB__T
	XREF	MessageBox__sysBASELIB__PcPcPce
	XREF	Error__xBASELIB__jPc
	XREF	Done__xBASELIB_
	XREF	Init__xBASELIB_
	XREF	_system
	XREF	_rand
	XREF	op__leftshift__ostream__Td
	XREF	op__leftshift__ostream__TUj
	XREF	op__leftshift__ostream__Tj
	XREF	op__leftshift__ostream__TPCc
	XREF	op__leftshift__ostream__Tc
	XREF	opfx__ostream__T
	XREF	read__istream__TPci
	XREF	get__istream__TRc
	XREF	getline__istream__TPcic
	XREF	get__istream__TPcic
	XREF	op__rightshift__istream__TRc
	XREF	op__rightshift__istream__TPc
	XREF	doallocate__streambuf__T
	XREF	xsgetn__streambuf__TPci
	XREF	xsputn__streambuf__TPCci
	XREF	underflow__streambuf__T
	XREF	overflow__streambuf__Ti
	XREF	setbuf__streambuf__TPcUi
	XREF	sputn__streambuf__TPCci
	XREF	_0dt__streambuf__T
	XREF	userword__ios__Ti
	XREF	init__ios__TP09streambuf
	XREF	_ftell
	XREF	_fseek
	XREF	_fwrite
	XREF	_fread
	XREF	_vfprintf
	XREF	_sprintf
	XREF	_fflush
	XREF	_feof
	XREF	_fclose
	XREF	_fopen
	XREF	_fgets
	XREF	_memset
	XREF	_memmove
	XREF	_strncpy
	XREF	op__delete__PvUi
	XREF	_std__in
	XREF	_std__out
	XREF	_std__err
	XREF	_basefield__ios
	XREF	_adjustfield__ios
	XREF	_floatfield__ios
	XREF	_aNextBit__ios
	XREF	_aNextWord__ios
	XREF	_cin
	XREF	_cout
	XREF	_cerr
	XREF	_clog
	XREF	_st
	XREF	_gxSt
	XREF	_errBuff__xBASELIB
	XREF	_errSev__xBASELIB
	XREF	_errTbl__xBASELIB
	XREF	_SysBase
	XREF	_IntuitionBase
	XREF	_DOSBase
	XREF	_sysData__sysBASELIB
	XREF	_msgbuff__sysBASELIB
	XREF	_main__sysBASELIB
	XREF	_allocated__MEM
	XREF	_totSize__MEM
	XREF	_nextFree__MEM
	XREF	_cnt__MEM
	XREF	_maxAllocs__MEM
	XREF	_GfxBase
	XREF	_TimerBase
	XREF	_TimerBase__xTIMABLE
	XREF	_current__xTIMABLE
	XREF	_clockFreq__xTIMABLE
	XREF	_threadCnt__xTHREADABLE
	XREF	_main__xTHREADABLE
	XREF	_CyberGfxBase
	XREF	_Warp3DBase
	XREF	_graphics__x2D
	XREF	_cyberGfx__x2D
	XREF	_formatNames__x2D
	XREF	_surfaceTypes__x2D
	XREF	_warp3D__x3D
	XREF	_hw3D__x3D
	XREF	_pointRender__x3D
	XREF	_lineRender__x3D
	XREF	_triangleRender__x3D
	XREF	_otherPrimitives__x3D
	XREF	_shadingModes__x3D
	XREF	_textureModes__x3D
	XREF	_textureFmts__x3D
	XREF	_alpha__x3D
	XREF	_fogModes__x3D
	XREF	_zBuffer__x3D
	XREF	_stencil__x3D
	XREF	_misc__x3D
	XREF	_primNames__x3D
	XREF	_renderNames__x3D
	XREF	_shadingNames__x3D
	XREF	_texModeNames__x3D
	XREF	_texFormatNames__x3D
	XREF	_alphaNames__x3D
	XREF	_fogNames__x3D
	XREF	_zBufferNames__x3D
	XREF	_stencilNames__x3D
	XREF	_miscNames__x3D
	XREF	_drawSurface__x3D
	XREF	_context__x3D
	XREF	_drawRegion__x3D
	XREF	_fogData__x3D
	XREF	_flags__xGFX
	XREF	_mode__xGFX
	XREF	_numModes__xGFX
	XREF	_rPool__xSURFACE
	XREF	_DiskfontBase
	XREF	_fontInfo__xDRAW
	XREF	_fontData__xDRAW
	XREF	_fonts__xDRAW
	XREF	_flags__xDRAW
	XREF	_flushCnt__xDRAW
	XREF	_cTab__xDRAW
	XREF	_sTab__xDRAW
	XREF	_fault__xDRAW
	XREF	_vBufPos__xDRAW
	XREF	_zDepth__xDRAW
	XREF	_maxVBufPos__xDRAW
	XREF	_vArraySize__xDRAW
	XREF	_vArray__xDRAW
	XREF	_vBuffer__xDRAW
	XREF	_nestCount__xDRAW
	XREF	_currentCol__xDRAW
	XREF	_sineData__QTRIG
	XREF	_gradData__QTRIG
	XREF	_vCachePtr__AXON
	XREF	_vCache__AXON
	XREF	_heap__TEXTUREHEAP
	XREF	_keys__TEXTUREHEAP
	XREF	_index__TEXTUREHEAP
	XREF	_heapSize__TEXTUREHEAP
	XREF	_lastTexture__TEXTUREHEAP
	XREF	_lastKey__TEXTUREHEAP
	XREF	_dimension__WORLDMAP
	XREF	_logDim__WORLDMAP
	XREF	_fracLimit__WORLDMAP
	XREF	_worldGrid__WORLDMAP
	XREF	_minZ__WORLDMAP
	XREF	_maxZ__WORLDMAP
	XREF	_floodLevel__WORLDMAP
	XREF	_scale__WORLDMAP
	XREF	_unitName__WORLDMAP
	XREF	_detailLevel__WORLDMAP
	XREF	_cell__WORLDMAP
	XREF	_visible__WORLDMAP
	XREF	_wet__WORLDMAP
	XREF	_things__WORLDMAP
	XREF	_frames__WORLDMAP
	XREF	_frameTime__WORLDMAP
	XREF	_totalTime__WORLDMAP
	XREF	_stopWatch__WORLDMAP
	XREF	_ground__WORLDMAP
	XREF	_water__WORLDMAP
	XREF	_count__PINETREE
	XREF	_texture__PINETREE
	XREF	_points__PINETREE
	XREF	_count__BUILDING
	XREF	_texture__BUILDING
	XREF	_points__BUILDING

	SECTION "_0ct__streampos__T:0",CODE

	rts

	SECTION "_buildings__APP:1",DATA

	XDEF	_buildings__APP
_buildings__APP
	dc.l	0

	SECTION "_trees__APP:1",DATA

	XDEF	_trees__APP
_trees__APP
	dc.l	0

	SECTION "_view__APP:0",CODE


	XDEF	_INIT_8_main_cpp__view__APP
_INIT_8_main_cpp__view__APP
L319
;VIEW			APP::view(128,128,640,480,16,"WorldMap Display");
	lea	_view__APP,a0
	move.l	#_0virttab__04VIEW__04VIEW,$A6(a0)
	move.l	a0,a1
	move.l	a1,$9E(a0)
	clr.b	$AA(a0)
	move.l	#_0virttab__06xDBWIN__04VIEW,$52(a0)
	lea	$18C(a0),a1
	move.l	a1,4(a0)
	lea	$198(a0),a1
	move.l	a1,(a0)
	move.b	#3,$8(a0)
	move.l	#_0virttab__04AREA__04VIEW,$194(a0)
	move.l	#_0virttab__09xLOCKABLE__04VIEW,$1CE(a0)
	move.l	#_0virttab__08xSURFACE__08xSURFACE,$66(a0)
	move.l	#_0virttab__08xSURFACE__08xSURFACE,$86(a0)
	move.l	#L318,-(a7)
	move.w	#$10,-(a7)
	move.w	#$1E0,-(a7)
	move.w	#$280,-(a7)
	move.w	#$80,-(a7)
	move.w	#$80,-(a7)
	pea	_view__APP
	jsr	_0ct__VIEW__TsssssPCc
	add.w	#$12,a7
	rts

	XDEF	_EXIT_8_main_cpp__view__APP
_EXIT_8_main_cpp__view__APP
L320
	move.l	#_view__APP,-(a7)
	jsr	_0dt__VIEW__T
	addq.w	#4,a7
	rts

L318
	dc.b	'WorldMap Display',0

	SECTION "_view__APP:1",DATA

	XDEF	_view__APP
_view__APP
	ds.b	466

	SECTION "Init__APP_:0",CODE


;sint32 APP::Init()
	XDEF	Init__APP_
Init__APP_
	movem.l	d2-d4/a2/a6,-(a7)
	fmovem.x fp2/fp3,-(a7)
L334
;	if (xGFX::Init()!=OK)
	jsr	Init__xGFX_
	tst.l	d0
	beq.b	L336
L335
;	
; 		sysBASELIB::MessageBox("Program Aborted", "OK", xB
	move.l	#L321,-(a7)
	move.l	#-$3050008,-(a7)
	jsr	Error__xBASELIB__jPc
	addq.w	#$8,a7
	move.l	d0,-(a7)
	move.l	#L322,-(a7)
	move.l	#L323,-(a7)
	jsr	MessageBox__sysBASELIB__PcPcPce
	add.w	#$C,a7
;		Done();
	jsr	Done__APP_
	move.l	#-$3050008,d0
	fmovem.x (a7)+,fp2/fp3
	movem.l	(a7)+,d2-d4/a2/a6
	rts
L336
;	else if (xDRAW::Init()!=OK)
	pea	$200.w
	jsr	Init__xDRAW__Uj
	addq.w	#4,a7
	tst.l	d0
	beq.b	L338
L337
;	
; 		sysBASELIB::MessageBox("Program Aborted", "OK", xB
	move.l	#L324,-(a7)
	move.l	#-$3050008,-(a7)
	jsr	Error__xBASELIB__jPc
	addq.w	#$8,a7
	move.l	d0,-(a7)
	move.l	#L322,-(a7)
	move.l	#L323,-(a7)
	jsr	MessageBox__sysBASELIB__PcPcPce
	add.w	#$C,a7
;		Done();
	jsr	Done__APP_
	move.l	#-$3050005,d0
	fmovem.x (a7)+,fp2/fp3
	movem.l	(a7)+,d2-d4/a2/a6
	rts
L338
;	else if (AXON::Init()!=OK)
	jsr	Init__AXON_
	tst.l	d0
	beq.b	L340
L339
;	
; 		sysBASELIB::MessageBox("Program Aborted", "OK", xB
	move.l	#L325,-(a7)
	move.l	#-$3030001,-(a7)
	jsr	Error__xBASELIB__jPc
	addq.w	#$8,a7
	move.l	d0,-(a7)
	move.l	#L322,-(a7)
	move.l	#L323,-(a7)
	jsr	MessageBox__sysBASELIB__PcPcPce
	add.w	#$C,a7
;		Done();
	jsr	Done__APP_
	move.l	#-$3050005,d0
	fmovem.x (a7)+,fp2/fp3
	movem.l	(a7)+,d2-d4/a2/a6
	rts
L340
;	if (view.Open()!=OK)
	move.l	#_view__APP,-(a7)
	jsr	Open__VIEW__T
	addq.w	#4,a7
	tst.l	d0
	beq.b	L342
L341
;	
;		sysBASELIB::MessageBox("Program Aborted", "OK", "Fai
	move.l	#L326,-(a7)
	move.l	#L322,-(a7)
	move.l	#L323,-(a7)
	jsr	MessageBox__sysBASELIB__PcPcPce
	add.w	#$C,a7
;		Done();
	jsr	Done__APP_
	move.l	#-$3050005,d0
	fmovem.x (a7)+,fp2/fp3
	movem.l	(a7)+,d2-d4/a2/a6
	rts
L342
;	else if (WORLDMAP::Init(6, 1000F, 5F, -100F, 200F, "metres")!
	move.l	#L327,-(a7)
	move.l	#$43480000,-(a7)
	move.l	#$C2C80000,-(a7)
	move.l	#$40A00000,-(a7)
	move.l	#$447A0000,-(a7)
	pea	6.w
	jsr	Init__WORLDMAP__UjffffPc
	add.w	#$18,a7
	tst.l	d0
	beq.b	L344
L343
;	
; 		sysBASELIB::MessageBox("Program Aborted", "OK", "W
	move.l	#L328,-(a7)
	move.l	#L322,-(a7)
	move.l	#L323,-(a7)
	jsr	MessageBox__sysBASELIB__PcPcPce
	add.w	#$C,a7
;		Done();
	jsr	Done__APP_
	move.l	#-$3050005,d0
	fmovem.x (a7)+,fp2/fp3
	movem.l	(a7)+,d2-d4/a2/a6
	rts
L344
;	
;		trees = New(trees, 500);
	move.l	#$1F4,d3
	moveq	#1,d2
	move.l	d3,d0
	mulu.l	#$98,d0
	move.l	d0,d1
	addq.l	#$8,d1
	tst.l	_allocated__MEM
	bne.b	L346
L345
	sub.l	a0,a0
	bra	L360
L346
	move.w	d2,d0
	move.l	d1,d4
	move.l	_cnt__MEM,d1
	cmp.l	#$200,d1
	bne.b	L348
L347
	move.l	#L329,-(a7)
	move.l	#L330,-(a7)
	move.l	#L331,-(a7)
	jsr	MessageBox__sysBASELIB__PcPcPce
	add.w	#$C,a7
	move.l	#-$3010002,d0
	bra	L357
L348
	cmp.w	#1,d0
	bne.b	L350
L349
	move.l	#$10001,d1
	bra.b	L351
L350
	moveq	#1,d1
L351
	move.l	_SysBase,a6
	move.l	d4,d0
	jsr	-$2AC(a6)
	move.l	d0,a0
	cmp.w	#0,a0
	beq	L356
L352
	move.l	_nextFree__MEM,d2
	move.l	d2,d0
	muls.l	#$C,d0
	move.l	_allocated__MEM,a2
	move.l	a0,0(a2,d0.l)
	move.l	_SysBase,a6
	sub.l	a1,a1
	jsr	-$126(a6)
	move.l	d2,d1
	muls.l	#$C,d1
	move.l	_allocated__MEM,a1
	move.l	d0,4(a1,d1.l)
	move.l	d2,d0
	muls.l	#$C,d0
	move.l	_allocated__MEM,a1
	move.l	d4,$8(a1,d0.l)
	add.l	d4,_totSize__MEM
	addq.l	#1,_cnt__MEM
	bra.b	L354
L353
	addq.l	#1,_nextFree__MEM
L354
	move.l	_nextFree__MEM,d0
	muls.l	#$C,d0
	move.l	_allocated__MEM,a1
	move.l	0(a1,d0.l),a0
	cmp.w	#0,a0
	bne.b	L353
L355
	move.l	d2,d0
	bra.b	L357
L356
	move.l	#-$3030001,d0
L357
	tst.l	d0
	bmi.b	L359
L358
	muls.l	#$C,d0
	move.l	_allocated__MEM,a1
	move.l	0(a1,d0.l),a0
	bra.b	L360
L359
	sub.l	a0,a0
L360
	cmp.w	#0,a0
	beq.b	L367
L361
	move.l	d3,(a0)
	move.l	#$98,4(a0)
	move.l	a0,d0
	addq.l	#$8,d0
	move.l	d0,a6
	moveq	#0,d2
	bra.b	L365
L362
	move.l	d2,d0
	muls.l	#$98,d0
	lea	0(a6,d0.l),a0
	cmp.w	#0,a0
	beq.b	L364
L363
	move.l	#_0virttab__08PINETREE__08PINETREE,$8C(a0)
	move.l	a0,-(a7)
	jsr	_0ct__PINETREE__T
	addq.w	#4,a7
L364
	addq.l	#1,d2
L365
	cmp.l	d3,d2
	blo.b	L362
L366
	bra.b	L368
L367
	sub.l	a6,a6
L368
	move.l	a6,_trees__APP
;		if (trees)
	tst.l	_trees__APP
	beq	L375
L369
;		
;			sint32 i = 500;
	move.l	#$1F4,d4
;			while (--i)
	bra	L373
L370
;			
;				sint32 x = QRnd(64);
	jsr	_rand
	fmove.l	d0,fp0
	fmove.s	#$.42800000,fp2
	fmul.x	fp0,fp2
	fdiv.s	#$.46FFFE00,fp2
	fmove.l	fp2,d3
;	sint32 y = QRnd(64);
	jsr	_rand
	fmove.l	d0,fp0
	fmove.s	#$.42800000,fp2
	fmul.x	fp0,fp2
	fdiv.s	#$.46FFFE00,fp2
	fmove.l	fp2,d2
;	float32 s = 5F + QRnd();
	jsr	_rand
	fmove.l	d0,fp0
	fmove.s	#$.3F800000,fp2
	fmul.x	fp0,fp2
	fdiv.s	#$.46FFFE00,fp2
	fmove.x	fp2,fp3
	fadd.s	#$.40A00000,fp3
;				while(WORLDMAP::Cell(x,y).AddThing(trees[i], QRnd(1000F/64F)
	bra.b	L372
L371
;				
;					x = QRnd(64);
	jsr	_rand
	fmove.l	d0,fp0
	fmove.s	#$.42800000,fp2
	fmul.x	fp0,fp2
	fdiv.s	#$.46FFFE00,fp2
	fmove.l	fp2,d3
; y = QRnd(64);
	jsr	_rand
	fmove.l	d0,fp0
	fmove.s	#$.42800000,fp2
	fmul.x	fp0,fp2
	fdiv.s	#$.46FFFE00,fp2
	fmove.l	fp2,d2
L372
	clr.w	-(a7)
	clr.w	-(a7)
	clr.w	-(a7)
	fmove.s	fp3,-(a7)
	jsr	_rand
	fmove.l	d0,fp0
	fmove.s	#$.417A0000,fp2
	fmul.x	fp0,fp2
	fdiv.s	#$.46FFFE00,fp2
	fmove.s	fp2,-(a7)
	jsr	_rand
	fmove.l	d0,fp0
	fmove.s	#$.417A0000,fp2
	fmul.x	fp0,fp2
	fdiv.s	#$.46FFFE00,fp2
	fmove.s	fp2,-(a7)
	move.l	d4,d0
	muls.l	#$98,d0
	move.l	_trees__APP,a1
	pea	0(a1,d0.l)
	moveq	#0,d0
	move.w	d2,d0
	mulu.l	_dimension__WORLDMAP,d0
	moveq	#0,d1
	move.w	d3,d1
	add.l	d1,d0
	asl.l	#$8,d0
	move.l	_cell__WORLDMAP,a1
	pea	0(a1,d0.l)
	jsr	AddThing__MAPCELL__TR05MODELfffsss
	add.w	#$1A,a7
	tst.w	d0
	beq	L371
L373
	subq.l	#1,d4
	tst.l	d4
	bne	L370
L374
	bra.b	L376
L375
;		
;	 		sysBASELIB::MessageBox("Program Aborted", "OK", 
	move.l	#L332,-(a7)
	move.l	#L322,-(a7)
	move.l	#L323,-(a7)
	jsr	MessageBox__sysBASELIB__PcPcPce
	add.w	#$C,a7
;			Done();
	jsr	Done__APP_
	move.l	#-$3030001,d0
	fmovem.x (a7)+,fp2/fp3
	movem.l	(a7)+,d2-d4/a2/a6
	rts
L376
;		buildings = New(buildings, 32);
	moveq	#$20,d3
	moveq	#1,d2
	move.l	d3,d0
	mulu.l	#$98,d0
	move.l	d0,d1
	addq.l	#$8,d1
	tst.l	_allocated__MEM
	bne.b	L378
L377
	sub.l	a0,a0
	bra	L392
L378
	move.w	d2,d0
	move.l	d1,d4
	move.l	_cnt__MEM,d1
	cmp.l	#$200,d1
	bne.b	L380
L379
	move.l	#L329,-(a7)
	move.l	#L330,-(a7)
	move.l	#L331,-(a7)
	jsr	MessageBox__sysBASELIB__PcPcPce
	add.w	#$C,a7
	move.l	#-$3010002,d0
	bra	L389
L380
	cmp.w	#1,d0
	bne.b	L382
L381
	move.l	#$10001,d1
	bra.b	L383
L382
	moveq	#1,d1
L383
	move.l	_SysBase,a6
	move.l	d4,d0
	jsr	-$2AC(a6)
	move.l	d0,a0
	cmp.w	#0,a0
	beq	L388
L384
	move.l	_nextFree__MEM,d2
	move.l	d2,d0
	muls.l	#$C,d0
	move.l	_allocated__MEM,a2
	move.l	a0,0(a2,d0.l)
	move.l	_SysBase,a6
	sub.l	a1,a1
	jsr	-$126(a6)
	move.l	d2,d1
	muls.l	#$C,d1
	move.l	_allocated__MEM,a1
	move.l	d0,4(a1,d1.l)
	move.l	d2,d0
	muls.l	#$C,d0
	move.l	_allocated__MEM,a1
	move.l	d4,$8(a1,d0.l)
	add.l	d4,_totSize__MEM
	addq.l	#1,_cnt__MEM
	bra.b	L386
L385
	addq.l	#1,_nextFree__MEM
L386
	move.l	_nextFree__MEM,d0
	muls.l	#$C,d0
	move.l	_allocated__MEM,a1
	move.l	0(a1,d0.l),a0
	cmp.w	#0,a0
	bne.b	L385
L387
	move.l	d2,d0
	bra.b	L389
L388
	move.l	#-$3030001,d0
L389
	tst.l	d0
	bmi.b	L391
L390
	muls.l	#$C,d0
	move.l	_allocated__MEM,a1
	move.l	0(a1,d0.l),a0
	bra.b	L392
L391
	sub.l	a0,a0
L392
	cmp.w	#0,a0
	beq.b	L399
L393
	move.l	d3,(a0)
	move.l	#$98,4(a0)
	move.l	a0,d0
	addq.l	#$8,d0
	move.l	d0,a6
	moveq	#0,d2
	bra.b	L397
L394
	move.l	d2,d0
	muls.l	#$98,d0
	lea	0(a6,d0.l),a0
	cmp.w	#0,a0
	beq.b	L396
L395
	move.l	#_0virttab__08BUILDING__08BUILDING,$8C(a0)
	move.l	a0,-(a7)
	jsr	_0ct__BUILDING__T
	addq.w	#4,a7
L396
	addq.l	#1,d2
L397
	cmp.l	d3,d2
	blo.b	L394
L398
	bra.b	L400
L399
	sub.l	a6,a6
L400
	move.l	a6,_buildings__APP
;		if (buildings)
	tst.l	_buildings__APP
	beq	L407
L401
;		
;			sint32 i = 32;
	moveq	#$20,d3
;			while (--i)
	bra	L405
L402
;			
;				sint32 x = QRnd(64);
	jsr	_rand
	fmove.l	d0,fp0
	fmove.s	#$.42800000,fp2
	fmul.x	fp0,fp2
	fdiv.s	#$.46FFFE00,fp2
	fmove.l	fp2,d2
;	sint32 y = QRnd(64);
	jsr	_rand
	fmove.l	d0,fp0
	fmove.s	#$.42800000,fp2
	fmul.x	fp0,fp2
	fdiv.s	#$.46FFFE00,fp2
	fmove.l	fp2,d0
;				while(WORLDMAP::Cell(x,y).AddThing(buildings[i], 500F/64F, 5
	bra.b	L404
L403
;				
;					x = QRnd(64);
	jsr	_rand
	fmove.l	d0,fp0
	fmove.s	#$.42800000,fp2
	fmul.x	fp0,fp2
	fdiv.s	#$.46FFFE00,fp2
	fmove.l	fp2,d2
; y = QRnd(64);
	jsr	_rand
	fmove.l	d0,fp0
	fmove.s	#$.42800000,fp2
	fmul.x	fp0,fp2
	fdiv.s	#$.46FFFE00,fp2
	fmove.l	fp2,d0
L404
	clr.w	-(a7)
	clr.w	-(a7)
	clr.w	-(a7)
	move.l	#$41200000,-(a7)
	move.l	#$40FA0000,-(a7)
	move.l	#$40FA0000,-(a7)
	move.l	d3,d1
	muls.l	#$98,d1
	move.l	_buildings__APP,a1
	pea	0(a1,d1.l)
	move.w	d2,d1
	and.l	#$FFFF,d0
	mulu.l	_dimension__WORLDMAP,d0
	and.l	#$FFFF,d1
	add.l	d1,d0
	asl.l	#$8,d0
	move.l	_cell__WORLDMAP,a1
	pea	0(a1,d0.l)
	jsr	AddThing__MAPCELL__TR05MODELfffsss
	add.w	#$1A,a7
	tst.w	d0
	beq	L403
L405
	subq.l	#1,d3
	tst.l	d3
	bne	L402
L406
	bra.b	L408
L407
;		
; 			sysBASELIB::MessageBox("Program Aborted", "OK", 
	move.l	#L333,-(a7)
	move.l	#L322,-(a7)
	move.l	#L323,-(a7)
	jsr	MessageBox__sysBASELIB__PcPcPce
	add.w	#$C,a7
;			Done();
	jsr	Done__APP_
	move.l	#-$3030001,d0
	fmovem.x (a7)+,fp2/fp3
	movem.l	(a7)+,d2-d4/a2/a6
	rts
L408
;	view.Camera(500, 500, 20, 45, 30);
	move.w	#$1E,-(a7)
	move.w	#$2D,-(a7)
	move.l	#$41A00000,-(a7)
	move.l	#$43FA0000,-(a7)
	move.l	#$43FA0000,-(a7)
	move.l	#_view__APP,-(a7)
	jsr	Camera__VIEW__Tfffss
	add.w	#$14,a7
	moveq	#0,d0
	fmovem.x (a7)+,fp2/fp3
	movem.l	(a7)+,d2-d4/a2/a6
	rts

L325
	dc.b	'AXON',0
L331
	dc.b	'Debug',0
L333
	dc.b	'Failed to create building objects',0
L326
	dc.b	'Failed to create display',0
L332
	dc.b	'Failed to create tree objects',0
L329
	dc.b	'MEM::AllocIndex()',$A,'Maximum allocation reached',0
L322
	dc.b	'OK',0
L330
	dc.b	'Proceed',0
L323
	dc.b	'Program Aborted',0
L328
	dc.b	'WORLDMAP initialisation failed',0
L327
	dc.b	'metres',0
L324
	dc.b	'xDRAW',0
L321
	dc.b	'xGFX',0

	SECTION "Done__APP_:0",CODE


;sint32 APP::Done()
	XDEF	Done__APP_
Done__APP_
	movem.l	d2/a2/a3/a6,-(a7)
L415
;	if (trees)
	tst.l	_trees__APP
	beq	L440
L416
;		Delete(trees);
	move.l	_trees__APP,a2
	cmp.w	#0,a2
	beq	L439
L417
	move.l	a2,d0
	subq.l	#$8,d0
	move.l	d0,a3
	moveq	#0,d2
	bra.b	L421
L418
	move.l	d2,d0
	muls.l	#$98,d0
	lea	0(a2,d0.l),a6
	cmp.w	#0,a6
	beq.b	L420
L419
	move.l	$8C(a6),a0
	move.l	a6,d0
	add.l	$44(a0),d0
	move.l	d0,-(a7)
	move.l	$40(a0),a0
	jsr	(a0)
	addq.w	#4,a7
	move.l	$8C(a6),a0
	move.l	$38(a0),-(a7)
	move.l	$3C(a0),d0
	add.l	a6,d0
	move.l	d0,-(a7)
	jsr	op__delete__PvUi
	addq.w	#$8,a7
L420
	addq.l	#1,d2
L421
	move.l	a3,a0
	cmp.l	(a0),d2
	blo.b	L418
L422
	move.l	a3,a1
	tst.l	_allocated__MEM
	beq	L439
L423
	cmp.w	#0,a1
	beq	L438
L424
	moveq	#0,d0
	moveq	#0,d1
	bra.b	L426
L425
	move.l	d0,d1
	muls.l	#$C,d1
	move.l	_allocated__MEM,a2
	move.l	a1,d2
	cmp.l	0(a2,d1.l),d2
	seq	d2
	and.l	#1,d2
	move.l	d2,d1
	addq.l	#1,d0
L426
	tst.l	d1
	bne.b	L428
L427
	cmp.l	#$200,d0
	blt.b	L425
L428
	tst.l	d1
	bne.b	L430
L429
	move.l	#L409,-(a7)
	move.l	#L410,-(a7)
	move.l	#L411,-(a7)
	jsr	MessageBox__sysBASELIB__PcPcPce
	add.w	#$C,a7
	bra	L439
L430
	move.l	d0,d2
	subq.l	#1,d2
	cmp.l	#$200,d2
	blo.b	L432
L431
	move.l	#L412,-(a7)
	move.l	#L410,-(a7)
	move.l	#L411,-(a7)
	jsr	MessageBox__sysBASELIB__PcPcPce
	add.w	#$C,a7
	bra	L437
L432
	move.l	d2,d0
	muls.l	#$C,d0
	move.l	_allocated__MEM,a1
	move.l	0(a1,d0.l),a0
	cmp.w	#0,a0
	bne.b	L434
L433
	move.l	#L413,-(a7)
	move.l	#L410,-(a7)
	move.l	#L411,-(a7)
	jsr	MessageBox__sysBASELIB__PcPcPce
	add.w	#$C,a7
	bra	L437
L434
	move.l	d2,d0
	muls.l	#$C,d0
	move.l	_allocated__MEM,a1
	move.l	_SysBase,a6
	move.l	0(a1,d0.l),a1
	jsr	-$2B2(a6)
	move.l	d2,d0
	muls.l	#$C,d0
	move.l	_allocated__MEM,a1
	move.l	_totSize__MEM,d1
	sub.l	$8(a1,d0.l),d1
	move.l	d1,_totSize__MEM
	move.l	d2,d0
	muls.l	#$C,d0
	move.l	_allocated__MEM,a1
	clr.l	0(a1,d0.l)
	move.l	d2,d0
	muls.l	#$C,d0
	move.l	_allocated__MEM,a1
	clr.l	4(a1,d0.l)
	move.l	d2,d0
	muls.l	#$C,d0
	move.l	_allocated__MEM,a1
	clr.l	$8(a1,d0.l)
	subq.l	#1,_cnt__MEM
	cmp.l	_nextFree__MEM,d2
	bhs.b	L436
L435
	move.l	d2,_nextFree__MEM
L436
L437
	bra.b	L439
L438
	move.l	#L414,-(a7)
	move.l	#L410,-(a7)
	move.l	#L411,-(a7)
	jsr	MessageBox__sysBASELIB__PcPcPce
	add.w	#$C,a7
L439
L440
;	if (buildings)
	tst.l	_buildings__APP
	beq	L465
L441
;		Delete(buildings);
	move.l	_buildings__APP,a2
	cmp.w	#0,a2
	beq	L464
L442
	move.l	a2,d0
	subq.l	#$8,d0
	move.l	d0,a3
	moveq	#0,d2
	bra.b	L446
L443
	move.l	d2,d0
	muls.l	#$98,d0
	lea	0(a2,d0.l),a6
	cmp.w	#0,a6
	beq.b	L445
L444
	move.l	$8C(a6),a0
	move.l	a6,d0
	add.l	$44(a0),d0
	move.l	d0,-(a7)
	move.l	$40(a0),a0
	jsr	(a0)
	addq.w	#4,a7
	move.l	$8C(a6),a0
	move.l	$38(a0),-(a7)
	move.l	$3C(a0),d0
	add.l	a6,d0
	move.l	d0,-(a7)
	jsr	op__delete__PvUi
	addq.w	#$8,a7
L445
	addq.l	#1,d2
L446
	move.l	a3,a0
	cmp.l	(a0),d2
	blo.b	L443
L447
	move.l	a3,a1
	tst.l	_allocated__MEM
	beq	L464
L448
	cmp.w	#0,a1
	beq	L463
L449
	moveq	#0,d0
	moveq	#0,d1
	bra.b	L451
L450
	move.l	d0,d1
	muls.l	#$C,d1
	move.l	_allocated__MEM,a2
	move.l	a1,d2
	cmp.l	0(a2,d1.l),d2
	seq	d2
	and.l	#1,d2
	move.l	d2,d1
	addq.l	#1,d0
L451
	tst.l	d1
	bne.b	L453
L452
	cmp.l	#$200,d0
	blt.b	L450
L453
	tst.l	d1
	bne.b	L455
L454
	move.l	#L409,-(a7)
	move.l	#L410,-(a7)
	move.l	#L411,-(a7)
	jsr	MessageBox__sysBASELIB__PcPcPce
	add.w	#$C,a7
	bra	L464
L455
	move.l	d0,d2
	subq.l	#1,d2
	cmp.l	#$200,d2
	blo.b	L457
L456
	move.l	#L412,-(a7)
	move.l	#L410,-(a7)
	move.l	#L411,-(a7)
	jsr	MessageBox__sysBASELIB__PcPcPce
	add.w	#$C,a7
	bra	L462
L457
	move.l	d2,d0
	muls.l	#$C,d0
	move.l	_allocated__MEM,a1
	move.l	0(a1,d0.l),a0
	cmp.w	#0,a0
	bne.b	L459
L458
	move.l	#L413,-(a7)
	move.l	#L410,-(a7)
	move.l	#L411,-(a7)
	jsr	MessageBox__sysBASELIB__PcPcPce
	add.w	#$C,a7
	bra	L462
L459
	move.l	d2,d0
	muls.l	#$C,d0
	move.l	_allocated__MEM,a1
	move.l	_SysBase,a6
	move.l	0(a1,d0.l),a1
	jsr	-$2B2(a6)
	move.l	d2,d0
	muls.l	#$C,d0
	move.l	_allocated__MEM,a1
	move.l	_totSize__MEM,d1
	sub.l	$8(a1,d0.l),d1
	move.l	d1,_totSize__MEM
	move.l	d2,d0
	muls.l	#$C,d0
	move.l	_allocated__MEM,a1
	clr.l	0(a1,d0.l)
	move.l	d2,d0
	muls.l	#$C,d0
	move.l	_allocated__MEM,a1
	clr.l	4(a1,d0.l)
	move.l	d2,d0
	muls.l	#$C,d0
	move.l	_allocated__MEM,a1
	clr.l	$8(a1,d0.l)
	subq.l	#1,_cnt__MEM
	cmp.l	_nextFree__MEM,d2
	bhs.b	L461
L460
	move.l	d2,_nextFree__MEM
L461
L462
	bra.b	L464
L463
	move.l	#L414,-(a7)
	move.l	#L410,-(a7)
	move.l	#L411,-(a7)
	jsr	MessageBox__sysBASELIB__PcPcPce
	add.w	#$C,a7
L464
L465
;	WORLDMAP::Done();
	jsr	Done__WORLDMAP_
;	view.Close();
	move.l	#_view__APP,-(a7)
	jsr	Close__VIEW__T
	addq.w	#4,a7
;	AXON::Done();
	jsr	Done__AXON_
;	xDRAW::Done();
	jsr	Done__xDRAW_
;	xGFX::Done();
	jsr	Done__xGFX_
	moveq	#0,d0
	movem.l	(a7)+,d2/a2/a3/a6
	rts

L411
	dc.b	'Debug',0
L409
	dc.b	'MEM::Free()',$A,'Address not recognised',0
L414
	dc.b	'MEM::Free()',$A,'Attempt to free null address',0
L412
	dc.b	'MEM::FreeIndex()',$A,'Index overflow',0
L413
	dc.b	'MEM::FreeIndex()',$A,'Memory already free',0
L410
	dc.b	'Proceed',0

	SECTION "Run__APP_:0",CODE


;sint32 APP::Run()
	XDEF	Run__APP_
Run__APP_
L508	EQU	-$14
	link	a5,#L508
	movem.l	d2-d7/a6,-(a7)
L467
;	uint32 bg[] = {0xFF000020, 0xFF4080FF};
	lea	-$8(a5),a0
	move.l	#-$FFFFE0,(a0)+
	move.l	#-$BF7F01,(a0)
;	uint32 br = Coord(view.Width(), view.Height());
	move.l	#_view__APP,a0
	cmp.w	#0,a0
	beq.b	L469
L468
	move.l	4(a0),a0
L469
	move.w	2(a0),d0
	ext.l	d0
	move.w	d0,d1
	move.l	#_view__APP,a0
	cmp.w	#0,a0
	beq.b	L471
L470
	move.l	4(a0),a0
L471
	move.w	(a0),d0
	ext.l	d0
	ext.l	d0
	moveq	#$10,d2
	asl.l	d2,d0
	move.l	d0,d7
	move.w	d1,d0
	ext.l	d0
	and.l	#$FFFF,d0
	move.l	d7,d1
	or.l	d0,d1
	move.l	d1,d7
;	while(!view.State(VIEW::QUIT))
	bra	L506
L472
;	
;		xDRAW::Begin();
	move.l	_nestCount__xDRAW,d0
	addq.l	#1,_nestCount__xDRAW
	tst.l	d0
	bne.b	L478
L473
	move.l	_flags__xDRAW,d0
	and.l	#1,d0
	beq.b	L475
L474
	bra	L487
L475
	or.l	#3,_flags__xDRAW
	move.l	_flags__xDRAW,d0
	and.l	#$40,d0
	beq.b	L477
L476
	and.l	#-$41,_flags__xDRAW
	bra.b	L478
L477
	clr.l	_vBufPos__xDRAW
L478
	move.l	_flags__xDRAW,d0
	and.l	#$10,d0
	beq.b	L486
L479
	move.l	_flags__xDRAW,d0
	and.l	#$20,d0
	beq.b	L481
L480
	moveq	#0,d0
	bra.b	L484
L481
	move.l	_context__x3D,a0
	move.l	_Warp3DBase,a6
	jsr	-$3C(a6)
	tst.l	d0
	bne.b	L483
L482
	or.l	#$20,_flags__xDRAW
	moveq	#0,d0
	bra.b	L484
L483
	and.l	#-$21,_flags__xDRAW
	move.l	#-$3050005,d0
L484
	tst.l	d0
L485
L486
L487
;		
;			xDRAW::Disable(x3D::ALPHA_BLEND);
	move.l	_context__x3D,a0
	move.l	_Warp3DBase,a6
	move.l	#$2000,d0
	moveq	#2,d1
	jsr	-$30(a6)
;			xDRAW::Disable(x3D::DEPTH_BUFFER);
	move.l	_context__x3D,a0
	move.l	_Warp3DBase,a6
	move.l	#$800,d0
	moveq	#2,d1
	jsr	-$30(a6)
;			xDRAW::RectShV(bg, 0, br);
	move.l	d7,-(a7)
	clr.l	-(a7)
	lea	-$8(a5),a6
	jsr	RectShV__xDRAW__r14PUjUjUj
	addq.w	#$8,a7
;			t = WORLDMAP::Render(view);
	move.l	#_view__APP,-(a7)
	jsr	Render__WORLDMAP__R04VIEW
	addq.w	#4,a7
	move.l	d0,d2
;		xDRAW::End();
	tst.l	_nestCount__xDRAW
	bne.b	L489
L488
	bra	L500
L489
	subq.l	#1,_nestCount__xDRAW
	tst.l	_nestCount__xDRAW
	bne.b	L495
L490
	bra.b	L492
L491
	bra.b	L500
L492
	and.l	#-2,_flags__xDRAW
	move.l	_context__x3D,a0
	move.l	_Warp3DBase,a6
	jsr	-$1B0(a6)
	move.l	_vBufPos__xDRAW,d0
	cmp.l	_maxVBufPos__xDRAW,d0
	ble.b	L494
L493
	move.l	_vBufPos__xDRAW,_maxVBufPos__xDRAW
L494
	clr.l	_vBufPos__xDRAW
	addq.l	#1,_flushCnt__xDRAW
L495
	move.l	_flags__xDRAW,d0
	and.l	#$10,d0
	beq.b	L499
L496
	bra.b	L498
L497
	bra.b	L499
L498
	and.l	#-$21,_flags__xDRAW
	move.l	_context__x3D,a0
	move.l	_Warp3DBase,a6
	jsr	-$42(a6)
L499
L500
;		xDRAW::SimpleText(Coord(8,16), xDRAW::ST_PARAGRAPH1, "Ori
	move.l	d2,-(a7)
	move.l	#_view__APP,a0
	fmove.s	$178(a0),fp0
	fmove.d	fp0,-(a7)
	move.l	#_view__APP,a0
	move.w	$186(a0),d0
	ext.l	d0
	move.l	d0,-(a7)
	move.l	#_view__APP,a0
	move.w	$184(a0),d0
	ext.l	d0
	move.l	d0,-(a7)
	move.l	#_view__APP,a0
	fmove.s	$110(a0),fp0
	fmove.d	fp0,-(a7)
	move.l	#_view__APP,a0
	fmove.s	$10C(a0),fp0
	fmove.d	fp0,-(a7)
	move.l	#L466,-(a7)
	pea	2.w
	moveq	#$8,d0
	ext.l	d0
	moveq	#$10,d2
	asl.l	d2,d0
	moveq	#$10,d1
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	jsr	SimpleText__xDRAW__UjUjPce
	add.w	#$30,a7
;		view.Refresh();
	move.l	#_view__APP,a0
	move.l	$4E(a0),a1
	move.w	$A(a1),d5
	ext.l	d5
	move.l	$4E(a0),a1
	move.b	$37(a1),d0
	ext.w	d0
	ext.l	d0
	sub.l	d0,d5
	move.l	$4E(a0),a1
	move.b	$39(a1),d0
	ext.w	d0
	ext.l	d0
	sub.l	d0,d5
	move.l	$4E(a0),a1
	move.w	$8(a1),d4
	ext.l	d4
	move.l	$4E(a0),a1
	move.b	$36(a1),d0
	ext.w	d0
	ext.l	d0
	sub.l	d0,d4
	move.l	$4E(a0),a1
	move.b	$38(a1),d0
	ext.w	d0
	ext.l	d0
	sub.l	d0,d4
	move.l	$4E(a0),a1
	move.b	$37(a1),d3
	ext.w	d3
	move.l	$4E(a0),a1
	move.b	$36(a1),d2
	ext.w	d2
	lea	$7E(a0),a1
	ext.l	d5
	ext.l	d4
	ext.l	d3
	ext.l	d2
	moveq	#0,d1
	ext.l	d1
	moveq	#0,d0
	ext.l	d0
	move.l	_GfxBase,a6
	move.l	#$C0,d6
	move.l	$6A(a0),a0
	move.l	$C(a1),a1
	jsr	-$228(a6)
;		view.HandleInput();
	moveq	#$8,d2
	move.l	#_view__APP,a6
L501
	move.l	a6,a0
	cmp.w	#0,a0
	beq.b	L503
L502
	add.w	#$9E,a0
L503
	move.l	$8(a0),a1
	move.l	a0,d0
	add.l	$54(a1),d0
	move.l	d0,-(a7)
	move.l	$50(a1),a1
	jsr	(a1)
	addq.w	#4,a7
	tst.w	d0
	beq.b	L505
L504
	subq.l	#1,d2
	tst.l	d2
	bne.b	L501
L505
;		view.WaitSync();
	move.l	_GfxBase,a6
	jsr	-$10E(a6)
L506
	move.l	#_view__APP,a0
	move.l	#$1000000,d0
	and.l	$180(a0),d0
	beq	L472
L507
	moveq	#0,d0
	movem.l	(a7)+,d2-d7/a6
	unlk	a5
	rts

L466
	dc.b	'Origin : %f,%f, yaw : %d, pitch : %d, zoom : %f, took : %d ms',0

	SECTION "main_:0",CODE


;int main()
	XDEF	main_
main_
L513
;	if (xBASELIB::Init()!=OK)
	jsr	Init__xBASELIB_
	tst.l	d0
	beq.b	L517
L514
;	
;		cout << "xBASE library initialisation failed\n";
	move.l	#L509,-(a7)
	move.l	_cout,a0
	cmp.w	#0,a0
	beq.b	L516
L515
	addq.w	#4,a0
L516
	move.l	a0,-(a7)
	jsr	op__leftshift__ostream__TPCc
	addq.w	#$8,a7
	moveq	#$A,d0
	rts
L517
;	if (APP::Init()==OK)
	jsr	Init__APP_
	tst.l	d0
	bne.b	L519
L518
;	
;		APP::Run();
	jsr	Run__APP_
; 		sysBASELIB::MessageBox("Info", "OK", "Finished\nRe
	fmove.l	_totalTime__WORLDMAP,fp0
	fmove.l	_frames__WORLDMAP,fp1
	fdiv.x	fp1,fp0
	fmove.d	fp0,-(a7)
	move.l	_frames__WORLDMAP,d0
	move.l	d0,-(a7)
	move.l	#L510,-(a7)
	move.l	#L511,-(a7)
	move.l	#L512,-(a7)
	jsr	MessageBox__sysBASELIB__PcPcPce
	add.w	#$18,a7
;		APP::Done();
	jsr	Done__APP_
L519
;	xBASELIB::Done();
	jsr	Done__xBASELIB_
	moveq	#0,d0
	rts

L510
	dc.b	'Finished',$A,'Rendered %d frames, average time %f ms/frame',0
L512
	dc.b	'Info',0
L511
	dc.b	'OK',0
L509
	dc.b	'xBASE library initialisation failed',$A,0

	SECTION "Width__AREA__T:0",CODE

	CNOP	0,2

	XDEF	Width__AREA__T
Width__AREA__T
	move.l	4(a7),a0
L520
	move.w	(a0),d0
	ext.l	d0
	rts

	SECTION "Height__AREA__T:0",CODE

	CNOP	0,2

	XDEF	Height__AREA__T
Height__AREA__T
	move.l	4(a7),a0
L521
	move.w	2(a0),d0
	ext.l	d0
	rts

	SECTION "Depth__AREA__T:0",CODE

	CNOP	0,2

	XDEF	Depth__AREA__T
Depth__AREA__T
	move.l	4(a7),a0
L522
	move.w	4(a0),d0
	ext.l	d0
	rts

	SECTION "Format__AREA__T:0",CODE

	CNOP	0,2

	XDEF	Format__AREA__T
Format__AREA__T
	move.l	4(a7),a0
L523
	move.w	6(a0),d0
	ext.l	d0
	rts

	SECTION "InputQueued__xDISPLAYIO__T:0",CODE

	CNOP	0,2

	XDEF	InputQueued__xDISPLAYIO__T
InputQueued__xDISPLAYIO__T
	move.l	4(a7),a0
L524
	move.l	a0,-(a7)
	jsr	HandleEvent__xDISPLAYIO__T
	addq.w	#4,a7
	rts

	SECTION "Refresh__xDBWIN__T:0",CODE

	CNOP	0,2

	XDEF	Refresh__xDBWIN__T
Refresh__xDBWIN__T
	movem.l	d2-d6/a6,-(a7)
	move.l	$1C(a7),a0
L525
	move.l	$4E(a0),a1
	move.w	$A(a1),d5
	ext.l	d5
	move.l	$4E(a0),a1
	move.b	$37(a1),d0
	ext.w	d0
	ext.l	d0
	sub.l	d0,d5
	move.l	$4E(a0),a1
	move.b	$39(a1),d0
	ext.w	d0
	ext.l	d0
	sub.l	d0,d5
	move.l	$4E(a0),a1
	move.w	$8(a1),d4
	ext.l	d4
	move.l	$4E(a0),a1
	move.b	$36(a1),d0
	ext.w	d0
	ext.l	d0
	sub.l	d0,d4
	move.l	$4E(a0),a1
	move.b	$38(a1),d0
	ext.w	d0
	ext.l	d0
	sub.l	d0,d4
	move.l	$4E(a0),a1
	move.b	$37(a1),d3
	ext.w	d3
	move.l	$4E(a0),a1
	move.b	$36(a1),d2
	ext.w	d2
	lea	$7E(a0),a1
	ext.l	d5
	ext.l	d4
	ext.l	d3
	ext.l	d2
	moveq	#0,d1
	ext.l	d1
	moveq	#0,d0
	ext.l	d0
	move.l	_GfxBase,a6
	move.l	#$C0,d6
	move.l	$6A(a0),a0
	move.l	$C(a1),a1
	jsr	-$228(a6)
	movem.l	(a7)+,d2-d6/a6
	rts

	SECTION "DrawSurface__xDBWIN__T:0",CODE

	CNOP	0,2

	XDEF	DrawSurface__xDBWIN__T
DrawSurface__xDBWIN__T
	move.l	4(a7),a0
L526
	moveq	#$5E,d0
	add.l	a0,d0
	rts

	SECTION "ViewSurface__xDBWIN__T:0",CODE

	CNOP	0,2

	XDEF	ViewSurface__xDBWIN__T
ViewSurface__xDBWIN__T
	move.l	4(a7),a0
L527
	moveq	#$7E,d0
	add.l	a0,d0
	rts

	SECTION "ClipBox__PINETREE__T:0",CODE

	CNOP	0,2

	XDEF	ClipBox__PINETREE__T
ClipBox__PINETREE__T
L528
	rts

	SECTION "Move__PINETREE__TRC05VEC3D:0",CODE

	CNOP	0,2

	XDEF	Move__PINETREE__TRC05VEC3D
Move__PINETREE__TRC05VEC3D
L529
	rts

	SECTION "Rotate__PINETREE__Tsss:0",CODE

	CNOP	0,2

	XDEF	Rotate__PINETREE__Tsss
Rotate__PINETREE__Tsss
L530
	rts

	SECTION "ClipBox__BUILDING__T:0",CODE

	CNOP	0,2

	XDEF	ClipBox__BUILDING__T
ClipBox__BUILDING__T
L531
	rts

	SECTION "Move__BUILDING__TRC05VEC3D:0",CODE

	CNOP	0,2

	XDEF	Move__BUILDING__TRC05VEC3D
Move__BUILDING__TRC05VEC3D
L532
	rts

	SECTION "Rotate__BUILDING__Tsss:0",CODE

	CNOP	0,2

	XDEF	Rotate__BUILDING__Tsss
Rotate__BUILDING__Tsss
L533
	rts

	SECTION "_0virttab__08xSURFACE__08xSURFACE:0",CODE

	XDEF	_0virttab__08xSURFACE__08xSURFACE
_0virttab__08xSURFACE__08xSURFACE
	dc.l	$20,0
	dc.l	_0dt__xSURFACE__T,0
	dc.l	Format__AREA__T,0
	dc.l	Depth__AREA__T,0
	dc.l	Height__AREA__T,0
	dc.l	Width__AREA__T,0
	dc.l	$20,0
	dc.l	_0dt__xSURFACE__T,0

	SECTION "_0virttab__04VIEW__04VIEW:0",CODE

	XDEF	_0virttab__04VIEW__04VIEW
_0virttab__04VIEW__04VIEW
	dc.l	InputQueued__xDISPLAYIO__T,-4
	dc.l	Idle__xDISPLAYIO__T,-4
	dc.l	ExitEvent__VIEW__T,-$A2
	dc.l	KeyEvent__VIEW__Tjs,-$A2
	dc.l	MouseEvent__VIEW__Tjjj,-$A2
	dc.l	ApplyInputModification__xDISPLAYIO__T,-4
	dc.l	$1D2,-$9E
	dc.l	_0dt__VIEW__T,-$9E
	dc.l	MoveEvent__VIEW__T,-$9E
	dc.l	ResizeEvent__VIEW__T,-$9E
	dc.l	InputQueued__xDISPLAYIO__T,0
	dc.l	Idle__xDISPLAYIO__T,0
	dc.l	ApplyInputModification__xDISPLAYIO__T,0
	dc.l	$1D2,0
	dc.l	_0dt__VIEW__T,0
	dc.l	Close__VIEW__T,0
	dc.l	Open__VIEW__T,0
	dc.l	MoveEvent__VIEW__T,0
	dc.l	ResizeEvent__VIEW__T,0
	dc.l	ExitEvent__VIEW__T,0
	dc.l	KeyEvent__VIEW__Tjs,0
	dc.l	MouseEvent__VIEW__Tjjj,0

	SECTION "_0virttab__04AREA__04VIEW:0",CODE

	XDEF	_0virttab__04AREA__04VIEW
_0virttab__04AREA__04VIEW
	dc.l	$1D2,-$18C
	dc.l	_0dt__VIEW__T,-$18C
	dc.l	Format__AREA__T,0
	dc.l	Depth__AREA__T,0
	dc.l	Height__AREA__T,0
	dc.l	Width__AREA__T,0

	SECTION "_0virttab__09xLOCKABLE__04VIEW:0",CODE

	XDEF	_0virttab__09xLOCKABLE__04VIEW
_0virttab__09xLOCKABLE__04VIEW
	dc.l	$1D2,-$198
	dc.l	_0dt__VIEW__T,-$198

	SECTION "_0virttab__06xDBWIN__04VIEW:0",CODE

	XDEF	_0virttab__06xDBWIN__04VIEW
_0virttab__06xDBWIN__04VIEW
	dc.l	$1D2,0
	dc.l	_0dt__VIEW__T,0
	dc.l	ViewSurface__xDBWIN__T,0
	dc.l	DrawSurface__xDBWIN__T,0
	dc.l	Refresh__xDBWIN__T,0
	dc.l	Close__VIEW__T,0
	dc.l	Open__VIEW__T,0
	dc.l	$1D2,0
	dc.l	_0dt__VIEW__T,0
	dc.l	ViewSurface__xDBWIN__T,0
	dc.l	DrawSurface__xDBWIN__T,0
	dc.l	Refresh__xDBWIN__T,0
	dc.l	Close__VIEW__T,0
	dc.l	Open__VIEW__T,0

	SECTION "_0virttab__08PINETREE__08PINETREE:0",CODE

	XDEF	_0virttab__08PINETREE__08PINETREE
_0virttab__08PINETREE__08PINETREE
	dc.l	$98,0
	dc.l	_0dt__PINETREE__T,0
	dc.l	Render__PINETREE__TR04VIEW,0
	dc.l	Rotate__PINETREE__Tsss,0
	dc.l	Move__PINETREE__TRC05VEC3D,0
	dc.l	Place__PINETREE__TRC05VEC3Dfsss,0
	dc.l	ClipBox__PINETREE__T,0
	dc.l	$98,0
	dc.l	_0dt__PINETREE__T,0
	dc.l	Render__PINETREE__TR04VIEW,0
	dc.l	Rotate__PINETREE__Tsss,0
	dc.l	Move__PINETREE__TRC05VEC3D,0
	dc.l	Place__PINETREE__TRC05VEC3Dfsss,0
	dc.l	ClipBox__PINETREE__T,0

	SECTION "_0virttab__08BUILDING__08BUILDING:0",CODE

	XDEF	_0virttab__08BUILDING__08BUILDING
_0virttab__08BUILDING__08BUILDING
	dc.l	$98,0
	dc.l	_0dt__BUILDING__T,0
	dc.l	Render__BUILDING__TR04VIEW,0
	dc.l	Rotate__BUILDING__Tsss,0
	dc.l	Move__BUILDING__TRC05VEC3D,0
	dc.l	Place__BUILDING__TRC05VEC3Dfsss,0
	dc.l	ClipBox__BUILDING__T,0
	dc.l	$98,0
	dc.l	_0dt__BUILDING__T,0
	dc.l	Render__BUILDING__TR04VIEW,0
	dc.l	Rotate__BUILDING__Tsss,0
	dc.l	Move__BUILDING__TRC05VEC3D,0
	dc.l	Place__BUILDING__TRC05VEC3Dfsss,0
	dc.l	ClipBox__BUILDING__T,0

	END
