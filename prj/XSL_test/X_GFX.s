
; Storm C Compiler
; Mendoza:Extropia/eXtropia/prj/XSL_test/X_GFX.cpp
	mc68030
	mc68881
	XREF	pbackfail__filebuf__Ti
	XREF	xsgetn__filebuf__TPci
	XREF	xsputn__filebuf__TPCci
	XREF	underflow__filebuf__T
	XREF	overflow__filebuf__Ti
	XREF	doallocate__filebuf__T
	XREF	sync__filebuf__T
	XREF	setbuf__filebuf__TPcUi
	XREF	seekpos__filebuf__T09streamposi
	XREF	seekoff__filebuf__TjE13seek_dir__iosi
	XREF	_0dt__filebuf__T
	XREF	ElipseScTxShC__xDRAW__r14PUjUjUjr11R08xTEXTURE
	XREF	ElipseShPt__xDRAW__r14PUjUjUjUj
	XREF	ElipseShC__xDRAW__r14PUjUjUj
	XREF	Elipse__xDRAW__UjUjUj
	XREF	CircleShPt__xDRAW__r14PUjUjUjUj
	XREF	CircleShC__xDRAW__r14PUjUjUj
	XREF	Circle__xDRAW__UjUjUj
	XREF	RectScTxShV__xDRAW__r14PUjUjUjr11R08xTEXTURE
	XREF	RectScTx__xDRAW__UjUjUjr14R08xTEXTURE
	XREF	RectShA__xDRAW__r14PUjUjUj
	XREF	RectShV__xDRAW__r14PUjUjUj
	XREF	RectShH__xDRAW__r14PUjUjUj
	XREF	Rect__xDRAW__UjUjUj
	XREF	TriShA__xDRAW__r14PUjUjUjUj
	XREF	Tri__xDRAW__UjUjUjUj
	XREF	LoadLST__xTEXTURE__TPCcs
	XREF	Load__xTEXTURE__TPCcj
	XREF	LoadPPM__xTEXTURE__TPCcUj
	XREF	DefineCell__xTEXTURE__TUjss
	XREF	Delete__xTEXTURE__T
	XREF	Create__xTEXTURE__TsssPvPUj
	XREF	Close__xDBWIN__T
	XREF	Open__xDBWIN__T
	XREF	Set__xDBWIN__TsssssPCc
	XREF	Idle__xDISPLAYIO_ASYNC__T
	XREF	Done__xDISPLAYIO_ASYNC__T
	XREF	Init__xDISPLAYIO_ASYNC__T
	XREF	MoveEvent__xDISPLAYIO__T
	XREF	ResizeEvent__xDISPLAYIO__T
	XREF	Idle__xDISPLAYIO__T
	XREF	HandleEvent__xDISPLAYIO__T
	XREF	ApplyInputModification__xDISPLAYIO__T
	XREF	ViewSurface__xDISPLAY__T
	XREF	DrawSurface__xDISPLAY__T
	XREF	Refresh__xDISPLAY__T
	XREF	Close__xDISPLAY__T
	XREF	Open__xDISPLAY__T
	XREF	_0dt__xSURFACE__T
	XREF	_0dt__POOL_ST__T
	XREF	_0ct__POOL_ST__TUsUj
	XREF	FreeT__POOL_ST__TPv
	XREF	NewT__POOL_ST__TPvUs
	XREF	NewT__POOL_ST__TPv
	XREF	Create__POOL_ST__TUsUj
	XREF	PrintAlloc__POOL_ST__TR07ostreamjj
	XREF	_0dt__POOL_LT__T
	XREF	Close__xFILEIO__T
	XREF	Write__xFILEIO__TPvUiUi
	XREF	Read__xFILEIO__TPvUiUi
	XREF	Open__xFILEIO__TPCcjj
	XREF	SendPacket__xFILEIO__TPv
	XREF	WaitPacket__xFILEIO__T
	XREF	InputQueued__xINPUT__T
	XREF	Idle__xINPUT__T
	XREF	ExitEvent__xINPUT__T
	XREF	KeyEvent__xINPUT__Tjs
	XREF	MouseEvent__xINPUT__Tjjj
	XREF	ApplyInputModification__xINPUT__T
	XREF	UnLink__xCHAINABLE__T
	XREF	_0ct__xTHREADABLE__TPCcUjjs
	XREF	ShutDown__xTHREADABLE__T
	XREF	Done__xTHREADABLE__T
	XREF	Init__xTHREADABLE__T
	XREF	_0dt__xLOCKABLE__T
	XREF	FreeLock__xLOCKABLE__Ts
	XREF	WaitLock__xLOCKABLE__T
	XREF	DebugInfo__MEM_
	XREF	_0dt__sysRTLIB__T
	XREF	MessageBox__sysBASELIB__PcPcPce
	XREF	Error__xBASELIB__jPc
	XREF	_system
	XREF	_rand
	XREF	op__leftshift__ostream__Td
	XREF	op__leftshift__ostream__TUj
	XREF	op__leftshift__ostream__Tj
	XREF	op__leftshift__ostream__TPCc
	XREF	op__leftshift__ostream__Tc
	XREF	opfx__ostream__T
	XREF	read__istream__TPci
	XREF	get__istream__TRc
	XREF	getline__istream__TPcic
	XREF	get__istream__TPcic
	XREF	op__rightshift__istream__TRc
	XREF	op__rightshift__istream__TPc
	XREF	doallocate__streambuf__T
	XREF	xsgetn__streambuf__TPci
	XREF	xsputn__streambuf__TPCci
	XREF	underflow__streambuf__T
	XREF	overflow__streambuf__Ti
	XREF	setbuf__streambuf__TPcUi
	XREF	sputn__streambuf__TPCci
	XREF	_0dt__streambuf__T
	XREF	userword__ios__Ti
	XREF	init__ios__TP09streambuf
	XREF	_ftell
	XREF	_fseek
	XREF	_fwrite
	XREF	_fread
	XREF	_vfprintf
	XREF	_sprintf
	XREF	_fflush
	XREF	_feof
	XREF	_fclose
	XREF	_fopen
	XREF	_fgets
	XREF	_memset
	XREF	_memmove
	XREF	_strncpy
	XREF	_std__in
	XREF	_std__out
	XREF	_std__err
	XREF	_basefield__ios
	XREF	_adjustfield__ios
	XREF	_floatfield__ios
	XREF	_aNextBit__ios
	XREF	_aNextWord__ios
	XREF	_cin
	XREF	_cout
	XREF	_cerr
	XREF	_clog
	XREF	_st
	XREF	_gxSt
	XREF	_errBuff__xBASELIB
	XREF	_errSev__xBASELIB
	XREF	_errTbl__xBASELIB
	XREF	_SysBase
	XREF	_IntuitionBase
	XREF	_DOSBase
	XREF	_sysData__sysBASELIB
	XREF	_msgbuff__sysBASELIB
	XREF	_main__sysBASELIB
	XREF	_allocated__MEM
	XREF	_totSize__MEM
	XREF	_nextFree__MEM
	XREF	_cnt__MEM
	XREF	_maxAllocs__MEM
	XREF	_GfxBase
	XREF	_TimerBase
	XREF	_TimerBase__xTIMABLE
	XREF	_current__xTIMABLE
	XREF	_clockFreq__xTIMABLE
	XREF	_threadCnt__xTHREADABLE
	XREF	_main__xTHREADABLE
	XREF	_CyberGfxBase
	XREF	_Warp3DBase
	XREF	_graphics__x2D
	XREF	_cyberGfx__x2D
	XREF	_formatNames__x2D
	XREF	_surfaceTypes__x2D
	XREF	_warp3D__x3D
	XREF	_hw3D__x3D
	XREF	_pointRender__x3D
	XREF	_lineRender__x3D
	XREF	_triangleRender__x3D
	XREF	_otherPrimitives__x3D
	XREF	_shadingModes__x3D
	XREF	_textureModes__x3D
	XREF	_textureFmts__x3D
	XREF	_alpha__x3D
	XREF	_fogModes__x3D
	XREF	_zBuffer__x3D
	XREF	_stencil__x3D
	XREF	_misc__x3D
	XREF	_primNames__x3D
	XREF	_renderNames__x3D
	XREF	_shadingNames__x3D
	XREF	_texModeNames__x3D
	XREF	_texFormatNames__x3D
	XREF	_alphaNames__x3D
	XREF	_fogNames__x3D
	XREF	_zBufferNames__x3D
	XREF	_stencilNames__x3D
	XREF	_miscNames__x3D
	XREF	_drawSurface__x3D
	XREF	_context__x3D
	XREF	_drawRegion__x3D
	XREF	_fogData__x3D
	XREF	_flags__xGFX
	XREF	_mode__xGFX
	XREF	_numModes__xGFX
	XREF	_rPool__xSURFACE
	XREF	_DiskfontBase
	XREF	_fontInfo__xDRAW
	XREF	_fontData__xDRAW
	XREF	_fonts__xDRAW
	XREF	_flags__xDRAW
	XREF	_flushCnt__xDRAW
	XREF	_cTab__xDRAW
	XREF	_sTab__xDRAW
	XREF	_fault__xDRAW
	XREF	_vBufPos__xDRAW
	XREF	_zDepth__xDRAW
	XREF	_maxVBufPos__xDRAW
	XREF	_vArraySize__xDRAW
	XREF	_vArray__xDRAW
	XREF	_vBuffer__xDRAW
	XREF	_nestCount__xDRAW
	XREF	_currentCol__xDRAW

	SECTION "_0ct__streampos__T:0",CODE

	rts

	SECTION "_fill0:1",DATA

	XDEF	_fill0
_fill0
	dc.l	$7FFF0000,-$FF0100,-$FFFF01,-1

	SECTION "_fill1:1",DATA

	XDEF	_fill1
_fill1
	dc.l	$80303080,-$FF7F01,-$DFF0

	SECTION "_fill2:1",DATA

	XDEF	_fill2
_fill2
	dc.l	$80FFFF10,-$DF7FC0,-$EFDF01

	SECTION "_fill3:1",DATA

	XDEF	_fill3
_fill3
	dc.l	$2F1020FF,-$2F2F01

	SECTION "_fill4:1",DATA

	XDEF	_fill4
_fill4
	dc.l	-$DFBFE0,-$BF5FC0

	SECTION "_fill5:1",DATA

	XDEF	_fill5
_fill5
	dc.l	$18FF5050,-$AFEFF0

	SECTION "_fill6:1",DATA

	XDEF	_fill6
_fill6
	dc.l	-$3F3FC1,-$3F3F01,-$3F4000,-$3FBFC1

	SECTION "Primitives__R08xDISPLAY:0",CODE


;uint32 Primitives(xDISPLAY& win)
	XDEF	Primitives__R08xDISPLAY
Primitives__R08xDISPLAY
	XREF	sym_handlers
L285	EQU	-$6C
	link	a5,#L285
	movem.l	d2-d5/a6,-(a7)
L244
;	sint16 x = win.Width()/4;
	move.l	$8(a5),a0
	cmp.w	#0,a0
	beq.b	L246
L245
	move.l	4(a0),a0
L246
	move.l	$8(a0),a1
	move.l	a0,d0
	add.l	$2C(a1),d0
	move.l	d0,-(a7)
	move.l	$28(a1),a1
	jsr	(a1)
	addq.w	#4,a7
	divsl.l	#4,d0
	move.w	d0,d2
;	sint16 y = win.Height()/4;
	move.l	$8(a5),a0
	cmp.w	#0,a0
	beq.b	L248
L247
	move.l	4(a0),a0
L248
	move.l	$8(a0),a1
	move.l	a0,d0
	add.l	$24(a1),d0
	move.l	d0,-(a7)
	move.l	$20(a1),a1
	jsr	(a1)
	addq.w	#4,a7
	divsl.l	#4,d0
	move.w	d0,d3
;	xTIMER t;
	lea	-$1C(a5),a0
	move.l	a0,-$60(a5)
	moveq	#$32,d4
	move.l	sym_handlers,-$48(a5)
	move.l	-$60(a5),-$58(a5)
	tst.l	_TimerBase__xTIMABLE
	bne.b	L250
L249
	move.l	_SysBase,a1
	lea	$15E(a1),a0
	move.l	_SysBase,a6
	move.l	#L243,a1
	jsr	-$114(a6)
	move.l	d0,_TimerBase__xTIMABLE
	move.l	_TimerBase,a6
	move.l	#_current__xTIMABLE,a0
	jsr	-$3C(a6)
	move.l	d0,_clockFreq__xTIMABLE
L250
	lea	-$60(a5),a0
	move.l	-$58(a5),-(a0)
	move.l	#_0dt__xTIMABLE__T,-(a0)
	move.l	sym_handlers,-(a0)
	move.l	a0,sym_handlers
	move.l	d4,d0
	move.l	-$60(a5),a0
	cmp.l	#1,d0
	bls.b	L252
L251
	bra.b	L253
L252
	moveq	#1,d0
L253
	move.l	d0,$14(a0)
	move.l	$14(a0),d0
	mulu.l	_clockFreq__xTIMABLE,d0
	divul.l	#$3E8,d0
	move.l	d0,$10(a0)
	move.l	-$60(a5),-$50(a5)
	move.l	_TimerBase,a6
	move.l	#_current__xTIMABLE,a0
	jsr	-$3C(a6)
	move.l	-$50(a5),a0
	lea	$8(a0),a1
	lea	_current__xTIMABLE,a0
	move.l	(a0),(a1)
	move.l	4(a0),4(a1)
	lea	_current__xTIMABLE,a1
	move.l	-$60(a5),a0
	move.l	(a1),(a0)
	move.l	4(a1),4(a0)
	move.l	-$48(a5),sym_handlers
	lea	-$1C(a5),a1
	move.l	a1,-(a1)
	move.l	#_0dt__xTIMER__T,-(a1)
	move.l	sym_handlers,-(a1)
	move.l	a1,sym_handlers
;	t.Set();
	lea	-$1C(a5),a0
	move.l	a0,-$54(a5)
	move.l	_TimerBase,a6
	move.l	#_current__xTIMABLE,a0
	jsr	-$3C(a6)
	move.l	-$54(a5),a0
	lea	$8(a0),a1
	lea	_current__xTIMABLE,a0
	move.l	(a0),(a1)
	move.l	4(a0),4(a1)
;	xDRAW::Begin();
	move.l	_nestCount__xDRAW,d0
	addq.l	#1,_nestCount__xDRAW
	tst.l	d0
	bne.b	L259
L254
	move.l	_flags__xDRAW,d0
	and.l	#1,d0
	beq.b	L256
L255
	bra	L268
L256
	or.l	#3,_flags__xDRAW
	move.l	_flags__xDRAW,d0
	and.l	#$40,d0
	beq.b	L258
L257
	and.l	#-$41,_flags__xDRAW
	bra.b	L259
L258
	clr.l	_vBufPos__xDRAW
L259
	move.l	_flags__xDRAW,d0
	and.l	#$10,d0
	beq.b	L267
L260
	move.l	_flags__xDRAW,d0
	and.l	#$20,d0
	beq.b	L262
L261
	moveq	#0,d0
	bra.b	L265
L262
	move.l	_context__x3D,a0
	move.l	_Warp3DBase,a6
	jsr	-$3C(a6)
	tst.l	d0
	bne.b	L264
L263
	or.l	#$20,_flags__xDRAW
	moveq	#0,d0
	bra.b	L265
L264
	and.l	#-$21,_flags__xDRAW
	move.l	#-$3050005,d0
L265
	tst.l	d0
L266
L267
L268
;		xDRAW::Clear();
	move.l	_context__x3D,a0
	move.l	_Warp3DBase,a6
	moveq	#0,d0
	jsr	-$1C2(a6)
;		xDRAW::Disable(xDRAW::ALPHA_BLEND);
	move.l	_context__x3D,a0
	move.l	_Warp3DBase,a6
	move.l	#$2000,d0
	moveq	#2,d1
	jsr	-$30(a6)
;		xDRAW::Rect(0xFFFF0000, Coord(4,4), Coord(x-4,y-4));
	move.w	d3,d0
	ext.l	d0
	subq.l	#4,d0
	move.w	d0,d1
	move.w	d2,d0
	ext.l	d0
	subq.l	#4,d0
	ext.l	d0
	moveq	#$10,d4
	asl.l	d4,d0
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	moveq	#4,d0
	ext.l	d0
	moveq	#$10,d4
	asl.l	d4,d0
	moveq	#4,d1
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.l	#-$10000,-(a7)
	jsr	Rect__xDRAW__UjUjUj
	add.w	#$C,a7
;		xDRAW::RectShH(fill1, Coord(x+4,4), Coord(2*x-4,y-4));
	move.w	d3,d0
	ext.l	d0
	subq.l	#4,d0
	move.w	d0,d1
	move.w	d2,d0
	ext.l	d0
	moveq	#1,d4
	asl.l	d4,d0
	subq.l	#4,d0
	ext.l	d0
	moveq	#$10,d4
	asl.l	d4,d0
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.w	d2,d0
	ext.l	d0
	addq.l	#4,d0
	ext.l	d0
	moveq	#$10,d4
	asl.l	d4,d0
	moveq	#4,d1
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.l	#_fill1,a6
	jsr	RectShH__xDRAW__r14PUjUjUj
	addq.w	#$8,a7
;		xDRAW::RectShV(fill4, Coord(2*x+4,4), Coord(3*x-4,y-4));
	move.w	d3,d0
	ext.l	d0
	subq.l	#4,d0
	move.w	d0,d1
	move.w	d2,d0
	muls	#3,d0
	subq.l	#4,d0
	ext.l	d0
	moveq	#$10,d4
	asl.l	d4,d0
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.w	d2,d0
	ext.l	d0
	moveq	#1,d4
	asl.l	d4,d0
	addq.l	#4,d0
	ext.l	d0
	moveq	#$10,d4
	asl.l	d4,d0
	moveq	#4,d1
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.l	#_fill4,a6
	jsr	RectShV__xDRAW__r14PUjUjUj
	addq.w	#$8,a7
;		xDRAW::RectShA(fill0, Coord(3*x+4,4), Coord(4*x-4,y-4));
	move.w	d3,d0
	ext.l	d0
	subq.l	#4,d0
	move.w	d0,d1
	move.w	d2,d0
	ext.l	d0
	moveq	#2,d4
	asl.l	d4,d0
	subq.l	#4,d0
	ext.l	d0
	moveq	#$10,d4
	asl.l	d4,d0
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.w	d2,d0
	muls	#3,d0
	addq.l	#4,d0
	ext.l	d0
	moveq	#$10,d4
	asl.l	d4,d0
	moveq	#4,d1
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.l	#_fill0,a6
	jsr	RectShA__xDRAW__r14PUjUjUj
	addq.w	#$8,a7
;		xDRAW::Tri(0xFF00FF00, Coord(4,2*y-4), Coord(x/2+4,y+4), 
	move.w	d3,d0
	ext.l	d0
	moveq	#1,d1
	asl.l	d1,d0
	subq.l	#4,d0
	move.w	d0,d1
	move.w	d2,d0
	ext.l	d0
	subq.l	#4,d0
	ext.l	d0
	moveq	#$10,d4
	asl.l	d4,d0
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.w	d3,d0
	ext.l	d0
	addq.l	#4,d0
	move.w	d0,d1
	move.w	d2,d0
	ext.l	d0
	divs	#2,d0
	ext.l	d0
	addq.l	#4,d0
	ext.l	d0
	moveq	#$10,d4
	asl.l	d4,d0
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.w	d3,d0
	ext.l	d0
	moveq	#1,d1
	asl.l	d1,d0
	subq.l	#4,d0
	move.w	d0,d1
	moveq	#4,d0
	ext.l	d0
	moveq	#$10,d4
	asl.l	d4,d0
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.l	#-$FF0100,-(a7)
	jsr	Tri__xDRAW__UjUjUjUj
	add.w	#$10,a7
;		xDRAW::TriShA(fill1, Coord(x+4,2*y-4), Coord(x/2+x+4,y+4)
	move.w	d3,d0
	ext.l	d0
	moveq	#1,d1
	asl.l	d1,d0
	subq.l	#4,d0
	move.w	d0,d1
	move.w	d2,d0
	ext.l	d0
	moveq	#1,d4
	asl.l	d4,d0
	subq.l	#4,d0
	ext.l	d0
	moveq	#$10,d4
	asl.l	d4,d0
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.w	d3,d0
	ext.l	d0
	addq.l	#4,d0
	move.w	d0,d4
	move.w	d2,d0
	ext.l	d0
	divs	#2,d0
	ext.l	d0
	move.w	d2,d1
	ext.l	d1
	add.l	d1,d0
	addq.l	#4,d0
	ext.l	d0
	moveq	#$10,d1
	asl.l	d1,d0
	move.w	d4,d1
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.w	d3,d0
	ext.l	d0
	moveq	#1,d1
	asl.l	d1,d0
	subq.l	#4,d0
	move.w	d0,d1
	move.w	d2,d0
	ext.l	d0
	addq.l	#4,d0
	ext.l	d0
	moveq	#$10,d4
	asl.l	d4,d0
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.l	#_fill1,a6
	jsr	TriShA__xDRAW__r14PUjUjUjUj
	add.w	#$C,a7
;		xDRAW::Circle(0xFFFF00FF, Coord(x/2,y/2+2*y), (x/2-4));
	move.w	d2,d0
	ext.l	d0
	divs	#2,d0
	ext.l	d0
	subq.l	#4,d0
	move.l	d0,-(a7)
	move.w	d3,d0
	ext.l	d0
	divs	#2,d0
	ext.l	d0
	move.w	d3,d1
	ext.l	d1
	moveq	#1,d4
	asl.l	d4,d1
	add.l	d1,d0
	move.w	d0,d1
	move.w	d2,d0
	ext.l	d0
	divs	#2,d0
	ext.l	d0
	ext.l	d0
	moveq	#$10,d4
	asl.l	d4,d0
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.l	#-$FF01,-(a7)
	jsr	Circle__xDRAW__UjUjUj
	add.w	#$C,a7
;		xDRAW::CircleShC(fill2, Coord(x+x/2,y/2+2*y), (x/2-4));
	move.w	d2,d0
	ext.l	d0
	divs	#2,d0
	ext.l	d0
	subq.l	#4,d0
	move.l	d0,-(a7)
	move.w	d3,d0
	ext.l	d0
	divs	#2,d0
	ext.l	d0
	move.w	d3,d1
	ext.l	d1
	moveq	#1,d4
	asl.l	d4,d1
	add.l	d1,d0
	move.w	d0,d4
	move.w	d2,d1
	ext.l	d1
	move.w	d2,d0
	ext.l	d0
	divs	#2,d0
	ext.l	d0
	add.l	d0,d1
	move.w	d1,d0
	ext.l	d0
	moveq	#$10,d1
	asl.l	d1,d0
	move.w	d4,d1
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.l	#_fill2,a6
	jsr	CircleShC__xDRAW__r14PUjUjUj
	addq.w	#$8,a7
;		xDRAW::CircleShPt(fill3, Coord(x/2,y/2+3*y), Coord(-32,-3
	move.w	d2,d0
	ext.l	d0
	divs	#2,d0
	ext.l	d0
	subq.l	#4,d0
	move.l	d0,-(a7)
	moveq	#-$20,d0
	ext.l	d0
	moveq	#$10,d4
	asl.l	d4,d0
	moveq	#-$20,d1
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.w	d3,d0
	ext.l	d0
	divs	#2,d0
	ext.l	d0
	move.w	d3,d1
	muls	#3,d1
	add.l	d1,d0
	move.w	d0,d1
	move.w	d2,d0
	ext.l	d0
	divs	#2,d0
	ext.l	d0
	ext.l	d0
	moveq	#$10,d4
	asl.l	d4,d0
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.l	#_fill3,a6
	jsr	CircleShPt__xDRAW__r14PUjUjUjUj
	add.w	#$C,a7
;		xDRAW::Elipse(0xFF0000FF, Coord(3*x, y/2+y), Coord(x-4,y/
	move.w	d3,d0
	ext.l	d0
	divs	#2,d0
	ext.l	d0
	subq.l	#4,d0
	move.w	d0,d1
	move.w	d2,d0
	ext.l	d0
	subq.l	#4,d0
	ext.l	d0
	moveq	#$10,d4
	asl.l	d4,d0
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.w	d3,d0
	ext.l	d0
	divs	#2,d0
	ext.l	d0
	move.w	d3,d1
	ext.l	d1
	add.l	d1,d0
	move.w	d0,d1
	move.w	d2,d0
	muls	#3,d0
	ext.l	d0
	moveq	#$10,d4
	asl.l	d4,d0
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.l	#-$FFFF01,-(a7)
	jsr	Elipse__xDRAW__UjUjUj
	add.w	#$C,a7
;		xDRAW::ElipseShC(fill3, Coord(3*x, y/2+2*y), Coord(x-4,y/
	move.w	d3,d0
	ext.l	d0
	divs	#2,d0
	ext.l	d0
	subq.l	#4,d0
	move.w	d0,d1
	move.w	d2,d0
	ext.l	d0
	subq.l	#4,d0
	ext.l	d0
	moveq	#$10,d4
	asl.l	d4,d0
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.w	d3,d0
	ext.l	d0
	divs	#2,d0
	ext.l	d0
	move.w	d3,d1
	ext.l	d1
	moveq	#1,d4
	asl.l	d4,d1
	add.l	d1,d0
	move.w	d0,d1
	move.w	d2,d0
	muls	#3,d0
	ext.l	d0
	moveq	#$10,d4
	asl.l	d4,d0
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.l	#_fill3,a6
	jsr	ElipseShC__xDRAW__r14PUjUjUj
	addq.w	#$8,a7
;		xDRAW::ElipseShPt(fill5, Coord(3*x, y/2+3*y), Coord(-40, 
	move.w	d3,d0
	ext.l	d0
	divs	#2,d0
	ext.l	d0
	subq.l	#4,d0
	move.w	d0,d1
	move.w	d2,d0
	ext.l	d0
	subq.l	#4,d0
	ext.l	d0
	moveq	#$10,d4
	asl.l	d4,d0
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	moveq	#-$28,d0
	ext.l	d0
	moveq	#$10,d4
	asl.l	d4,d0
	moveq	#-$14,d1
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.w	d3,d0
	ext.l	d0
	divs	#2,d0
	ext.l	d0
	move.w	d3,d1
	muls	#3,d1
	add.l	d1,d0
	move.w	d0,d1
	move.w	d2,d0
	muls	#3,d0
	ext.l	d0
	moveq	#$10,d2
	asl.l	d2,d0
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.l	#_fill5,a6
	jsr	ElipseShPt__xDRAW__r14PUjUjUjUj
	add.w	#$C,a7
;	xDRAW::End();
	tst.l	_nestCount__xDRAW
	bne.b	L270
L269
	bra	L281
L270
	subq.l	#1,_nestCount__xDRAW
	tst.l	_nestCount__xDRAW
	bne.b	L276
L271
	bra.b	L273
L272
	bra.b	L281
L273
	and.l	#-2,_flags__xDRAW
	move.l	_context__x3D,a0
	move.l	_Warp3DBase,a6
	jsr	-$1B0(a6)
	move.l	_vBufPos__xDRAW,d0
	cmp.l	_maxVBufPos__xDRAW,d0
	ble.b	L275
L274
	move.l	_vBufPos__xDRAW,_maxVBufPos__xDRAW
L275
	clr.l	_vBufPos__xDRAW
	addq.l	#1,_flushCnt__xDRAW
L276
	move.l	_flags__xDRAW,d0
	and.l	#$10,d0
	beq.b	L280
L277
	bra.b	L279
L278
	bra.b	L280
L279
	and.l	#-$21,_flags__xDRAW
	move.l	_context__x3D,a0
	move.l	_Warp3DBase,a6
	jsr	-$42(a6)
L280
L281
;	uint32 ms = t.ElapsedSet();
	lea	-$1C(a5),a0
	move.l	a0,-$5C(a5)
	move.l	_TimerBase,a6
	move.l	#_current__xTIMABLE,a0
	jsr	-$3C(a6)
	move.l	_current__xTIMABLE,d1
	move.l	-$5C(a5),a1
	cmp.l	$8(a1),d1
	bne.b	L283
L282
	move.l	_current__xTIMABLE+4,d0
	move.l	-$5C(a5),a1
	sub.l	$C(a1),d0
	bra.b	L284
L283
	move.l	-$5C(a5),a1
	moveq	#-1,d0
	sub.l	$C(a1),d0
	move.l	_current__xTIMABLE+4,d1
	add.l	d1,d0
L284
	move.l	d0,d2
	mulu.l	#$3E8,d2
	divul.l	_clockFreq__xTIMABLE,d2
;	win.Refresh();
	move.l	$8(a5),a1
	move.l	$52(a1),a0
	move.l	$8(a5),d0
	add.l	$24(a0),d0
	move.l	d0,$8(a5)
	move.l	$8(a5),-(a7)
	move.l	$20(a0),a0
	jsr	(a0)
	addq.w	#4,a7
	lea	-$28(a5),a0
	XREF	lib_destruct_a0
	jsr	lib_destruct_a0
	move.l	d2,d0
	movem.l	(a7)+,d2-d5/a6
	unlk	a5
	rts

L243
	dc.b	'timer.device',0

	SECTION "TriangleFX__R08xDISPLAY:0",CODE


;uint32 TriangleFX(xDISPLAY& win)
	XDEF	TriangleFX__R08xDISPLAY
TriangleFX__R08xDISPLAY
L331	EQU	-$6C
	link	a5,#L331
	movem.l	d2-d5/a6,-(a7)
L287
;	sint16 winW = win.Width();
	move.l	$8(a5),a0
	cmp.w	#0,a0
	beq.b	L289
L288
	move.l	4(a0),a0
L289
	move.l	$8(a0),a1
	move.l	a0,d0
	add.l	$2C(a1),d0
	move.l	d0,-(a7)
	move.l	$28(a1),a1
	jsr	(a1)
	addq.w	#4,a7
	move.w	d0,d3
;	sint16 winH = win.Height();
	move.l	$8(a5),a0
	cmp.w	#0,a0
	beq.b	L291
L290
	move.l	4(a0),a0
L291
	move.l	$8(a0),a1
	move.l	a0,d0
	add.l	$24(a1),d0
	move.l	d0,-(a7)
	move.l	$20(a1),a1
	jsr	(a1)
	addq.w	#4,a7
	move.w	d0,d4
;	xDRAW::Enable(xDRAW::ALPHA_BLEND);
	move.l	_context__x3D,a0
	move.l	_Warp3DBase,a6
	move.l	#$2000,d0
	moveq	#1,d1
	jsr	-$30(a6)
;	xTIMER t;
	lea	-$1C(a5),a0
	move.l	a0,-$60(a5)
	moveq	#$32,d2
	move.l	sym_handlers,-$48(a5)
	move.l	-$60(a5),-$58(a5)
	tst.l	_TimerBase__xTIMABLE
	bne.b	L293
L292
	move.l	_SysBase,a1
	lea	$15E(a1),a0
	move.l	_SysBase,a6
	move.l	#L286,a1
	jsr	-$114(a6)
	move.l	d0,_TimerBase__xTIMABLE
	move.l	_TimerBase,a6
	move.l	#_current__xTIMABLE,a0
	jsr	-$3C(a6)
	move.l	d0,_clockFreq__xTIMABLE
L293
	lea	-$60(a5),a0
	move.l	-$58(a5),-(a0)
	move.l	#_0dt__xTIMABLE__T,-(a0)
	move.l	sym_handlers,-(a0)
	move.l	a0,sym_handlers
	move.l	d2,d0
	move.l	-$60(a5),a0
	cmp.l	#1,d0
	bls.b	L295
L294
	bra.b	L296
L295
	moveq	#1,d0
L296
	move.l	d0,$14(a0)
	move.l	$14(a0),d0
	mulu.l	_clockFreq__xTIMABLE,d0
	divul.l	#$3E8,d0
	move.l	d0,$10(a0)
	move.l	-$60(a5),-$50(a5)
	move.l	_TimerBase,a6
	move.l	#_current__xTIMABLE,a0
	jsr	-$3C(a6)
	move.l	-$50(a5),a0
	lea	$8(a0),a1
	lea	_current__xTIMABLE,a0
	move.l	(a0),(a1)
	move.l	4(a0),4(a1)
	lea	_current__xTIMABLE,a1
	move.l	-$60(a5),a0
	move.l	(a1),(a0)
	move.l	4(a1),4(a0)
	move.l	-$48(a5),sym_handlers
	lea	-$1C(a5),a1
	move.l	a1,-(a1)
	move.l	#_0dt__xTIMER__T,-(a1)
	move.l	sym_handlers,-(a1)
	move.l	a1,sym_handlers
;	t.Set();
	lea	-$1C(a5),a0
	move.l	a0,-$54(a5)
	move.l	_TimerBase,a6
	move.l	#_current__xTIMABLE,a0
	jsr	-$3C(a6)
	move.l	-$54(a5),a0
	lea	$8(a0),a1
	lea	_current__xTIMABLE,a0
	move.l	(a0),(a1)
	move.l	4(a0),4(a1)
;	xDRAW::Begin();
	move.l	_nestCount__xDRAW,d0
	addq.l	#1,_nestCount__xDRAW
	tst.l	d0
	bne.b	L302
L297
	move.l	_flags__xDRAW,d0
	and.l	#1,d0
	beq.b	L299
L298
	bra	L311
L299
	or.l	#3,_flags__xDRAW
	move.l	_flags__xDRAW,d0
	and.l	#$40,d0
	beq.b	L301
L300
	and.l	#-$41,_flags__xDRAW
	bra.b	L302
L301
	clr.l	_vBufPos__xDRAW
L302
	move.l	_flags__xDRAW,d0
	and.l	#$10,d0
	beq.b	L310
L303
	move.l	_flags__xDRAW,d0
	and.l	#$20,d0
	beq.b	L305
L304
	moveq	#0,d0
	bra.b	L308
L305
	move.l	_context__x3D,a0
	move.l	_Warp3DBase,a6
	jsr	-$3C(a6)
	tst.l	d0
	bne.b	L307
L306
	or.l	#$20,_flags__xDRAW
	moveq	#0,d0
	bra.b	L308
L307
	and.l	#-$21,_flags__xDRAW
	move.l	#-$3050005,d0
L308
	tst.l	d0
L309
L310
L311
;		xDRAW::Clear();
	move.l	_context__x3D,a0
	move.l	_Warp3DBase,a6
	moveq	#0,d0
	jsr	-$1C2(a6)
;		for (sint32 i = 0;
	moveq	#0,d2
	bra	L313
L312
;			xDRAW::TriShA(fill1, Coord(i, 0), Coord(winW>>1,winH>>1)
	move.w	d2,d0
	ext.l	d0
	moveq	#$10,d5
	asl.l	d5,d0
	move.w	d4,d1
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.w	d4,d0
	ext.l	d0
	moveq	#1,d1
	asr.l	d1,d0
	move.w	d0,d1
	move.w	d3,d0
	ext.l	d0
	moveq	#1,d5
	asr.l	d5,d0
	ext.l	d0
	moveq	#$10,d5
	asl.l	d5,d0
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.w	d2,d0
	ext.l	d0
	moveq	#$10,d5
	asl.l	d5,d0
	moveq	#0,d1
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.l	#_fill1,a6
	jsr	TriShA__xDRAW__r14PUjUjUjUj
	add.w	#$C,a7
;			xDRAW::TriShA(fill2, Coord(0, i), Coord(winW>>1,winH>>1)
	move.w	d3,d0
	ext.l	d0
	moveq	#$10,d5
	asl.l	d5,d0
	move.w	d2,d1
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.w	d4,d0
	ext.l	d0
	moveq	#1,d1
	asr.l	d1,d0
	move.w	d0,d1
	move.w	d3,d0
	ext.l	d0
	moveq	#1,d5
	asr.l	d5,d0
	ext.l	d0
	moveq	#$10,d5
	asl.l	d5,d0
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	moveq	#0,d0
	ext.l	d0
	moveq	#$10,d5
	asl.l	d5,d0
	move.w	d2,d1
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.l	#_fill2,a6
	jsr	TriShA__xDRAW__r14PUjUjUjUj
	add.w	#$C,a7
	add.l	#$10,d2
L313
	move.w	d3,d0
	ext.l	d0
	cmp.l	d0,d2
	blt	L312
L314
;	xDRAW::End();
	tst.l	_nestCount__xDRAW
	bne.b	L316
L315
	bra	L327
L316
	subq.l	#1,_nestCount__xDRAW
	tst.l	_nestCount__xDRAW
	bne.b	L322
L317
	bra.b	L319
L318
	bra.b	L327
L319
	and.l	#-2,_flags__xDRAW
	move.l	_context__x3D,a0
	move.l	_Warp3DBase,a6
	jsr	-$1B0(a6)
	move.l	_vBufPos__xDRAW,d0
	cmp.l	_maxVBufPos__xDRAW,d0
	ble.b	L321
L320
	move.l	_vBufPos__xDRAW,_maxVBufPos__xDRAW
L321
	clr.l	_vBufPos__xDRAW
	addq.l	#1,_flushCnt__xDRAW
L322
	move.l	_flags__xDRAW,d0
	and.l	#$10,d0
	beq.b	L326
L323
	bra.b	L325
L324
	bra.b	L326
L325
	and.l	#-$21,_flags__xDRAW
	move.l	_context__x3D,a0
	move.l	_Warp3DBase,a6
	jsr	-$42(a6)
L326
L327
;	uint32 ms = t.ElapsedSet();
	lea	-$1C(a5),a0
	move.l	a0,-$5C(a5)
	move.l	_TimerBase,a6
	move.l	#_current__xTIMABLE,a0
	jsr	-$3C(a6)
	move.l	_current__xTIMABLE,d1
	move.l	-$5C(a5),a1
	cmp.l	$8(a1),d1
	bne.b	L329
L328
	move.l	_current__xTIMABLE+4,d0
	move.l	-$5C(a5),a1
	sub.l	$C(a1),d0
	bra.b	L330
L329
	move.l	-$5C(a5),a1
	moveq	#-1,d0
	sub.l	$C(a1),d0
	move.l	_current__xTIMABLE+4,d1
	add.l	d1,d0
L330
	move.l	d0,d2
	mulu.l	#$3E8,d2
	divul.l	_clockFreq__xTIMABLE,d2
;	win.Refresh();
	move.l	$8(a5),a1
	move.l	$52(a1),a0
	move.l	$8(a5),d0
	add.l	$24(a0),d0
	move.l	d0,$8(a5)
	move.l	$8(a5),-(a7)
	move.l	$20(a0),a0
	jsr	(a0)
	addq.w	#4,a7
	lea	-$28(a5),a0
	jsr	lib_destruct_a0
	move.l	d2,d0
	movem.l	(a7)+,d2-d5/a6
	unlk	a5
	rts

L286
	dc.b	'timer.device',0

	SECTION "BounceFX__R08xDISPLAY:0",CODE


;uint32 BounceFX(xDISPLAY& win)
	XDEF	BounceFX__R08xDISPLAY
BounceFX__R08xDISPLAY
L390	EQU	-$70
	link	a5,#L390
	movem.l	d2-d6/a6,-(a7)
L333
;	sint16 winW = win.Width();
	move.l	$8(a5),a0
	cmp.w	#0,a0
	beq.b	L335
L334
	move.l	4(a0),a0
L335
	move.l	$8(a0),a1
	move.l	a0,d0
	add.l	$2C(a1),d0
	move.l	d0,-(a7)
	move.l	$28(a1),a1
	jsr	(a1)
	addq.w	#4,a7
	move.w	d0,d4
;	sint16 winH = win.Height();
	move.l	$8(a5),a0
	cmp.w	#0,a0
	beq.b	L337
L336
	move.l	4(a0),a0
L337
	move.l	$8(a0),a1
	move.l	a0,d0
	add.l	$24(a1),d0
	move.l	d0,-(a7)
	move.l	$20(a1),a1
	jsr	(a1)
	addq.w	#4,a7
	move.w	d0,d5
;	xTIMER t;
	lea	-$1C(a5),a0
	move.l	a0,-$64(a5)
	moveq	#$32,d2
	move.l	sym_handlers,-$4C(a5)
	move.l	-$64(a5),-$5C(a5)
	tst.l	_TimerBase__xTIMABLE
	bne.b	L339
L338
	move.l	_SysBase,a1
	lea	$15E(a1),a0
	move.l	_SysBase,a6
	move.l	#L332,a1
	jsr	-$114(a6)
	move.l	d0,_TimerBase__xTIMABLE
	move.l	_TimerBase,a6
	move.l	#_current__xTIMABLE,a0
	jsr	-$3C(a6)
	move.l	d0,_clockFreq__xTIMABLE
L339
	lea	-$64(a5),a0
	move.l	-$5C(a5),-(a0)
	move.l	#_0dt__xTIMABLE__T,-(a0)
	move.l	sym_handlers,-(a0)
	move.l	a0,sym_handlers
	move.l	d2,d0
	move.l	-$64(a5),a0
	cmp.l	#1,d0
	bls.b	L341
L340
	bra.b	L342
L341
	moveq	#1,d0
L342
	move.l	d0,$14(a0)
	move.l	$14(a0),d0
	mulu.l	_clockFreq__xTIMABLE,d0
	divul.l	#$3E8,d0
	move.l	d0,$10(a0)
	move.l	-$64(a5),-$54(a5)
	move.l	_TimerBase,a6
	move.l	#_current__xTIMABLE,a0
	jsr	-$3C(a6)
	move.l	-$54(a5),a0
	lea	$8(a0),a1
	lea	_current__xTIMABLE,a0
	move.l	(a0),(a1)
	move.l	4(a0),4(a1)
	lea	_current__xTIMABLE,a1
	move.l	-$64(a5),a0
	move.l	(a1),(a0)
	move.l	4(a1),4(a0)
	move.l	-$4C(a5),sym_handlers
	lea	-$1C(a5),a1
	move.l	a1,-(a1)
	move.l	#_0dt__xTIMER__T,-(a1)
	move.l	sym_handlers,-(a1)
	move.l	a1,sym_handlers
;	t.Set();
	lea	-$1C(a5),a0
	move.l	a0,-$58(a5)
	move.l	_TimerBase,a6
	move.l	#_current__xTIMABLE,a0
	jsr	-$3C(a6)
	move.l	-$58(a5),a0
	lea	$8(a0),a1
	lea	_current__xTIMABLE,a0
	move.l	(a0),(a1)
	move.l	4(a0),4(a1)
;	xDRAW::Begin();
	move.l	_nestCount__xDRAW,d0
	addq.l	#1,_nestCount__xDRAW
	tst.l	d0
	bne.b	L348
L343
	move.l	_flags__xDRAW,d0
	and.l	#1,d0
	beq.b	L345
L344
	bra	L357
L345
	or.l	#3,_flags__xDRAW
	move.l	_flags__xDRAW,d0
	and.l	#$40,d0
	beq.b	L347
L346
	and.l	#-$41,_flags__xDRAW
	bra.b	L348
L347
	clr.l	_vBufPos__xDRAW
L348
	move.l	_flags__xDRAW,d0
	and.l	#$10,d0
	beq.b	L356
L349
	move.l	_flags__xDRAW,d0
	and.l	#$20,d0
	beq.b	L351
L350
	moveq	#0,d0
	bra.b	L354
L351
	move.l	_context__x3D,a0
	move.l	_Warp3DBase,a6
	jsr	-$3C(a6)
	tst.l	d0
	bne.b	L353
L352
	or.l	#$20,_flags__xDRAW
	moveq	#0,d0
	bra.b	L354
L353
	and.l	#-$21,_flags__xDRAW
	move.l	#-$3050005,d0
L354
	tst.l	d0
L355
L356
L357
;		xDRAW::Clear();
	move.l	_context__x3D,a0
	move.l	_Warp3DBase,a6
	moveq	#0,d0
	jsr	-$1C2(a6)
;		xDRAW::Disable(xDRAW::ALPHA_BLEND);
	move.l	_context__x3D,a0
	move.l	_Warp3DBase,a6
	move.l	#$2000,d0
	moveq	#2,d1
	jsr	-$30(a6)
;		xDRAW::RectShV(fill3, 0, Coord(winW,winH-180));
	move.w	d5,d0
	ext.l	d0
	sub.l	#$B4,d0
	move.w	d0,d1
	move.w	d4,d0
	ext.l	d0
	moveq	#$10,d2
	asl.l	d2,d0
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	clr.l	-(a7)
	move.l	#_fill3,a6
	jsr	RectShV__xDRAW__r14PUjUjUj
	addq.w	#$8,a7
;		xDRAW::RectShV(fill4, Coord(0,winH-180), Coord(winW,winH))
	move.w	d4,d0
	ext.l	d0
	moveq	#$10,d2
	asl.l	d2,d0
	move.w	d5,d1
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.w	d5,d0
	ext.l	d0
	sub.l	#$B4,d0
	move.w	d0,d1
	moveq	#0,d0
	ext.l	d0
	moveq	#$10,d2
	asl.l	d2,d0
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.l	#_fill4,a6
	jsr	RectShV__xDRAW__r14PUjUjUj
	addq.w	#$8,a7
;		xDRAW::Enable(xDRAW::ALPHA_BLEND);
	move.l	_context__x3D,a0
	move.l	_Warp3DBase,a6
	move.l	#$2000,d0
	moveq	#1,d1
	jsr	-$30(a6)
;		for (sint32 i = 0
	moveq	#0,d2
;		for (sint32 i = 0, n = 1;
	moveq	#1,d3
	bra.b	L359
L358
;			xDRAW::CircleShPt(fill5, Coord(winW>>1,96+i), Coord(-24
	pea	$40.w
	moveq	#-$18,d0
	ext.l	d0
	moveq	#$10,d6
	asl.l	d6,d0
	moveq	#-$20,d1
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.l	d2,d0
	add.l	#$60,d0
	move.w	d0,d1
	move.w	d4,d0
	ext.l	d0
	moveq	#1,d6
	asr.l	d6,d0
	ext.l	d0
	moveq	#$10,d6
	asl.l	d6,d0
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.l	#_fill5,a6
	jsr	CircleShPt__xDRAW__r14PUjUjUjUj
	add.w	#$C,a7
	add.l	d3,d2
	addq.l	#2,d3
L359
	move.w	d5,d0
	ext.l	d0
	sub.l	#$100,d0
	cmp.l	d0,d2
	blt.b	L358
L360
;		xDRAW::Elipse(0x30000000, Coord((winW>>1)+64,176+i), Coor
	moveq	#$4C,d0
	ext.l	d0
	moveq	#$10,d3
	asl.l	d3,d0
	moveq	#$10,d1
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.l	d2,d0
	add.l	#$B0,d0
	move.w	d0,d1
	move.w	d4,d0
	ext.l	d0
	moveq	#1,d3
	asr.l	d3,d0
	add.l	#$40,d0
	ext.l	d0
	moveq	#$10,d3
	asl.l	d3,d0
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.l	#$30000000,-(a7)
	jsr	Elipse__xDRAW__UjUjUj
	add.w	#$C,a7
;		xDRAW::Disable(xDRAW::ALPHA_BLEND);
	move.l	_context__x3D,a0
	move.l	_Warp3DBase,a6
	move.l	#$2000,d0
	moveq	#2,d1
	jsr	-$30(a6)
;		xDRAW::CircleShPt(fill5, Coord(winW>>1,96+i), Coord(-24,-
	pea	$40.w
	moveq	#-$18,d0
	ext.l	d0
	moveq	#$10,d3
	asl.l	d3,d0
	moveq	#-$20,d1
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.l	d2,d0
	add.l	#$60,d0
	move.w	d0,d1
	move.w	d4,d0
	ext.l	d0
	moveq	#1,d2
	asr.l	d2,d0
	ext.l	d0
	moveq	#$10,d2
	asl.l	d2,d0
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.l	#_fill5,a6
	jsr	CircleShPt__xDRAW__r14PUjUjUjUj
	add.w	#$C,a7
;		xDRAW::End();
	tst.l	_nestCount__xDRAW
	bne.b	L362
L361
	bra	L373
L362
	subq.l	#1,_nestCount__xDRAW
	tst.l	_nestCount__xDRAW
	bne.b	L368
L363
	bra.b	L365
L364
	bra.b	L373
L365
	and.l	#-2,_flags__xDRAW
	move.l	_context__x3D,a0
	move.l	_Warp3DBase,a6
	jsr	-$1B0(a6)
	move.l	_vBufPos__xDRAW,d0
	cmp.l	_maxVBufPos__xDRAW,d0
	ble.b	L367
L366
	move.l	_vBufPos__xDRAW,_maxVBufPos__xDRAW
L367
	clr.l	_vBufPos__xDRAW
	addq.l	#1,_flushCnt__xDRAW
L368
	move.l	_flags__xDRAW,d0
	and.l	#$10,d0
	beq.b	L372
L369
	bra.b	L371
L370
	bra.b	L372
L371
	and.l	#-$21,_flags__xDRAW
	move.l	_context__x3D,a0
	move.l	_Warp3DBase,a6
	jsr	-$42(a6)
L372
L373
;		win.Refresh();
	move.l	$8(a5),a1
	move.l	$52(a1),a0
	move.l	$8(a5),d0
	add.l	$24(a0),d0
	move.l	d0,-(a7)
	move.l	$20(a0),a0
	jsr	(a0)
	addq.w	#4,a7
;	xDRAW::End();
	tst.l	_nestCount__xDRAW
	bne.b	L375
L374
	bra	L386
L375
	subq.l	#1,_nestCount__xDRAW
	tst.l	_nestCount__xDRAW
	bne.b	L381
L376
	bra.b	L378
L377
	bra.b	L386
L378
	and.l	#-2,_flags__xDRAW
	move.l	_context__x3D,a0
	move.l	_Warp3DBase,a6
	jsr	-$1B0(a6)
	move.l	_vBufPos__xDRAW,d0
	cmp.l	_maxVBufPos__xDRAW,d0
	ble.b	L380
L379
	move.l	_vBufPos__xDRAW,_maxVBufPos__xDRAW
L380
	clr.l	_vBufPos__xDRAW
	addq.l	#1,_flushCnt__xDRAW
L381
	move.l	_flags__xDRAW,d0
	and.l	#$10,d0
	beq.b	L385
L382
	bra.b	L384
L383
	bra.b	L385
L384
	and.l	#-$21,_flags__xDRAW
	move.l	_context__x3D,a0
	move.l	_Warp3DBase,a6
	jsr	-$42(a6)
L385
L386
;	uint32 ms = t.ElapsedSet();
	lea	-$1C(a5),a0
	move.l	a0,-$60(a5)
	move.l	_TimerBase,a6
	move.l	#_current__xTIMABLE,a0
	jsr	-$3C(a6)
	move.l	_current__xTIMABLE,d1
	move.l	-$60(a5),a1
	cmp.l	$8(a1),d1
	bne.b	L388
L387
	move.l	_current__xTIMABLE+4,d0
	move.l	-$60(a5),a1
	sub.l	$C(a1),d0
	bra.b	L389
L388
	move.l	-$60(a5),a1
	moveq	#-1,d0
	sub.l	$C(a1),d0
	move.l	_current__xTIMABLE+4,d1
	add.l	d1,d0
L389
	move.l	d0,d2
	mulu.l	#$3E8,d2
	divul.l	_clockFreq__xTIMABLE,d2
;	win.Refresh();
	move.l	$8(a5),a1
	move.l	$52(a1),a0
	move.l	$8(a5),d0
	add.l	$24(a0),d0
	move.l	d0,$8(a5)
	move.l	$8(a5),-(a7)
	move.l	$20(a0),a0
	jsr	(a0)
	addq.w	#4,a7
	lea	-$28(a5),a0
	jsr	lib_destruct_a0
	move.l	d2,d0
	movem.l	(a7)+,d2-d6/a6
	unlk	a5
	rts

L332
	dc.b	'timer.device',0

	SECTION "CampFireFX__R08xDISPLAY:0",CODE


;uint32 CampFireFX(xDISPLAY& win)
	XDEF	CampFireFX__R08xDISPLAY
CampFireFX__R08xDISPLAY
L464	EQU	-$20C
	link	a5,#L464
	movem.l	d2-d6/a2/a3/a6,-(a7)
	fmovem.x fp2/fp3,-(a7)
L399
;		float32 w = win.Width();
	move.l	$8(a5),a0
	cmp.w	#0,a0
	beq.b	L401
L400
	move.l	4(a0),a0
L401
	move.l	$8(a0),a1
	move.l	a0,d0
	add.l	$2C(a1),d0
	move.l	d0,-(a7)
	move.l	$28(a1),a1
	jsr	(a1)
	addq.w	#4,a7
	fmove.l	d0,fp2
;		float32 h = win.Height();
	move.l	$8(a5),a0
	cmp.w	#0,a0
	beq.b	L403
L402
	move.l	4(a0),a0
L403
	move.l	$8(a0),a1
	move.l	a0,d0
	add.l	$24(a1),d0
	move.l	d0,-(a7)
	move.l	$20(a1),a1
	jsr	(a1)
	addq.w	#4,a7
	fmove.l	d0,fp1
;		for (i = 0;
	moveq	#0,d0
	bra.b	L405
L404
;			sint16 x = (posF[(i<<1)]*w);
	move.l	d0,d1
	moveq	#1,d2
	asl.l	d2,d1
	move.l	#_posF__CampFireFX__R08xDISPLAY,a1
	fmove.s	0(a1,d1.l*4),fp0
	fmul.x	fp2,fp0
	fmove.l	fp0,d1
	move.w	d1,d3
;			sint16 y = (posF[(i<<1)+1]*h);
	move.l	d0,d1
	moveq	#1,d2
	asl.l	d2,d1
	addq.l	#1,d1
	move.l	#_posF__CampFireFX__R08xDISPLAY,a1
	fmove.s	0(a1,d1.l*4),fp0
	fmul.x	fp1,fp0
	fmove.l	fp0,d1
;			pos[i] = Coord(x,y);
	move.w	d1,d2
	move.w	d3,d1
	ext.l	d1
	moveq	#$10,d3
	asl.l	d3,d1
	ext.l	d2
	and.l	#$FFFF,d2
	or.l	d2,d1
	lea	-$60(a5),a0
	move.l	d1,0(a0,d0.l*4)
	addq.l	#1,d0
L405
	cmp.l	#$18,d0
	blt.b	L404
L406
;	ICOORD2D* skyPos			= pos;
	lea	-$60(a5),a0
	move.l	a0,-$64(a5)
;	ICOORD2D* treePos			= pos+6;
	lea	-$60(a5),a0
	move.l	a0,-$68(a5)
	moveq	#$18,d0
	add.l	d0,-$68(a5)
;	ICOORD2D* firePos			= pos+20;
	lea	-$60(a5),a0
	move.l	a0,-$6C(a5)
	moveq	#$50,d0
	add.l	d0,-$6C(a5)
;	uint32*		skyCol			= bGrad;
	move.l	#_bGrad__CampFireFX__R08xDISPLAY,-$70(a5)
;	uint32*		treeCol			= bGrad+4;
	moveq	#$10,d0
	add.l	#_bGrad__CampFireFX__R08xDISPLAY,d0
	move.l	d0,-$74(a5)
;	uint32*		fireCol			= bGrad+8;
	moveq	#$20,d0
	add.l	#_bGrad__CampFireFX__R08xDISPLAY,d0
	move.l	d0,-$78(a5)
;	xTEXTURE flame;
	move.l	#_0virttab__08xTEXTURE__08xTEXTURE,-$A8(a5)
	lea	-$B0(a5),a0
	move.l	sym_handlers,a1
	clr.w	(a0)
	clr.w	2(a0)
	clr.w	4(a0)
	move.w	#$F,6(a0)
	lea	-$1E8(a5),a2
	move.l	a0,-(a2)
	move.l	#_0dt__AREA__T,-(a2)
	move.l	sym_handlers,-(a2)
	move.l	a2,sym_handlers
	clr.l	$C(a0)
	clr.l	$10(a0)
	clr.l	$14(a0)
	clr.l	$18(a0)
	clr.l	$1C(a0)
	clr.l	$20(a0)
	move.l	a1,sym_handlers
	lea	-$B0(a5),a1
	move.l	a1,-(a1)
	move.l	#_0dt__xTEXTURE__T,-(a1)
	move.l	sym_handlers,-(a1)
	move.l	a1,sym_handlers
;	if (flame.LoadPPM("flame.ppm",0xFFFFFFA0)!=OK)
	move.l	#-$60,-(a7)
	move.l	#L391,-(a7)
	pea	-$B0(a5)
	jsr	LoadPPM__xTEXTURE__TPCcUj
	add.w	#$C,a7
	tst.l	d0
	beq.b	L408
L407
;		sysBASELIB::MessageBox("Error", "OK", "Couldn't load
	move.l	#L392,-(a7)
	move.l	#L393,-(a7)
	move.l	#L394,-(a7)
	jsr	MessageBox__sysBASELIB__PcPcPce
	add.w	#$C,a7
	lea	-$BC(a5),a0
	jsr	lib_destruct_a0
	moveq	#0,d0
	fmovem.x (a7)+,fp2/fp3
	movem.l	(a7)+,d2-d6/a2/a3/a6
	unlk	a5
	rts
L408
;		flame.SetFilter(W3D_LINEAR);
	lea	-$B0(a5),a0
	move.l	$10(a0),a1
	move.l	_Warp3DBase,a6
	moveq	#1,d0
	moveq	#2,d1
	move.l	$C(a0),a0
	jsr	-$78(a6)
;		flame.SetEnv(xTEXTURE::REPLACE);
	lea	-$B0(a5),a0
	move.l	$10(a0),a1
	move.l	_Warp3DBase,a6
	moveq	#1,d1
	move.l	$C(a0),a0
	sub.l	a2,a2
	jsr	-$7E(a6)
;		flame.DefineCell(Coord(32,128), 8, 1);
	move.w	#1,-(a7)
	move.w	#$8,-(a7)
	moveq	#$20,d0
	ext.l	d0
	moveq	#$10,d2
	asl.l	d2,d0
	move.w	#$80,d1
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	pea	-$B0(a5)
	jsr	DefineCell__xTEXTURE__TUjss
	add.w	#$C,a7
;	xTEXTURE ground;
	move.l	#_0virttab__08xTEXTURE__08xTEXTURE,-$EC(a5)
	lea	-$F4(a5),a0
	move.l	sym_handlers,a1
	clr.w	(a0)
	clr.w	2(a0)
	clr.w	4(a0)
	move.w	#$F,6(a0)
	lea	-$1F4(a5),a2
	move.l	a0,-(a2)
	move.l	#_0dt__AREA__T,-(a2)
	move.l	sym_handlers,-(a2)
	move.l	a2,sym_handlers
	clr.l	$C(a0)
	clr.l	$10(a0)
	clr.l	$14(a0)
	clr.l	$18(a0)
	clr.l	$1C(a0)
	clr.l	$20(a0)
	move.l	a1,sym_handlers
	lea	-$F4(a5),a1
	move.l	a1,-(a1)
	move.l	#_0dt__xTEXTURE__T,-(a1)
	move.l	sym_handlers,-(a1)
	move.l	a1,sym_handlers
;	if (ground.LoadPPM("ground.ppm")!=OK)
	move.l	#-$1000000,-(a7)
	move.l	#L395,-(a7)
	pea	-$F4(a5)
	jsr	LoadPPM__xTEXTURE__TPCcUj
	add.w	#$C,a7
	tst.l	d0
	beq.b	L410
L409
;		flame.Delete();
	pea	-$B0(a5)
	jsr	Delete__xTEXTURE__T
	addq.w	#4,a7
;		sysBASELIB::MessageBox("Error", "OK", "Couldn't load
	move.l	#L392,-(a7)
	move.l	#L393,-(a7)
	move.l	#L394,-(a7)
	jsr	MessageBox__sysBASELIB__PcPcPce
	add.w	#$C,a7
	lea	-$100(a5),a0
	jsr	lib_destruct_a0
	lea	-$BC(a5),a0
	jsr	lib_destruct_a0
	moveq	#0,d0
	fmovem.x (a7)+,fp2/fp3
	movem.l	(a7)+,d2-d6/a2/a3/a6
	unlk	a5
	rts
L410
;		ground.SetFilter(W3D_LINEAR);
	lea	-$F4(a5),a0
	move.l	$10(a0),a1
	move.l	_Warp3DBase,a6
	moveq	#1,d0
	moveq	#2,d1
	move.l	$C(a0),a0
	jsr	-$78(a6)
;		ground.SetEnv(xTEXTURE::MODULATE);
	lea	-$F4(a5),a0
	move.l	$10(a0),a1
	move.l	_Warp3DBase,a6
	moveq	#3,d1
	move.l	$C(a0),a0
	sub.l	a2,a2
	jsr	-$7E(a6)
;	xTEXTURE tree;
	move.l	#_0virttab__08xTEXTURE__08xTEXTURE,-$130(a5)
	lea	-$138(a5),a0
	move.l	sym_handlers,a1
	clr.w	(a0)
	clr.w	2(a0)
	clr.w	4(a0)
	move.w	#$F,6(a0)
	lea	-$200(a5),a2
	move.l	a0,-(a2)
	move.l	#_0dt__AREA__T,-(a2)
	move.l	sym_handlers,-(a2)
	move.l	a2,sym_handlers
	clr.l	$C(a0)
	clr.l	$10(a0)
	clr.l	$14(a0)
	clr.l	$18(a0)
	clr.l	$1C(a0)
	clr.l	$20(a0)
	move.l	a1,sym_handlers
	lea	-$138(a5),a1
	move.l	a1,-(a1)
	move.l	#_0dt__xTEXTURE__T,-(a1)
	move.l	sym_handlers,-(a1)
	move.l	a1,sym_handlers
;	if (tree.Load("tree.tex")!=OK)
	move.l	#-1,-(a7)
	move.l	#L396,-(a7)
	pea	-$138(a5)
	jsr	Load__xTEXTURE__TPCcj
	add.w	#$C,a7
	tst.l	d0
	beq.b	L412
L411
;		flame.Delete();
	pea	-$B0(a5)
	jsr	Delete__xTEXTURE__T
	addq.w	#4,a7
;		ground.Delete();
	pea	-$F4(a5)
	jsr	Delete__xTEXTURE__T
	addq.w	#4,a7
;		sysBASELIB::MessageBox("Error", "OK", "Couldn't load
	move.l	#L397,-(a7)
	move.l	#L393,-(a7)
	move.l	#L394,-(a7)
	jsr	MessageBox__sysBASELIB__PcPcPce
	add.w	#$C,a7
	lea	-$144(a5),a0
	jsr	lib_destruct_a0
	lea	-$100(a5),a0
	jsr	lib_destruct_a0
	lea	-$BC(a5),a0
	jsr	lib_destruct_a0
	moveq	#0,d0
	fmovem.x (a7)+,fp2/fp3
	movem.l	(a7)+,d2-d6/a2/a3/a6
	unlk	a5
	rts
L412
;		tree.SetFilter(W3D_LINEAR);
	lea	-$138(a5),a0
	move.l	$10(a0),a1
	move.l	_Warp3DBase,a6
	moveq	#1,d0
	moveq	#2,d1
	move.l	$C(a0),a0
	jsr	-$78(a6)
;		tree.SetEnv(xTEXTURE::MODULATE);
	lea	-$138(a5),a0
	move.l	$10(a0),a1
	move.l	_Warp3DBase,a6
	moveq	#3,d1
	move.l	$C(a0),a0
	sub.l	a2,a2
	jsr	-$7E(a6)
;	MEM::DebugInfo();
	jsr	DebugInfo__MEM_
;	sint16 flameX  = CoordX(firePos[0]);
	move.l	-$6C(a5),a0
	move.l	(a0),d0
	moveq	#$10,d1
	asr.l	d1,d0
	move.w	d0,-$146(a5)
;	sint16 flameY1 = CoordY(firePos[0]);
	move.l	-$6C(a5),a0
	move.l	(a0),d0
	and.l	#$FFFF,d0
	move.w	d0,-$148(a5)
;	sint16 flameY2 = CoordY(firePos[1]);
	move.l	-$6C(a5),a1
	move.l	4(a1),d0
	and.l	#$FFFF,d0
	move.w	d0,-$14A(a5)
;	uint32 ms		= 0;
	clr.l	-$14E(a5)
;	sint32 size = 64+(16*rand())/RAND_MAX;
	jsr	_rand
	moveq	#4,d1
	asl.l	d1,d0
	divsl.l	#$7FFF,d0
	move.l	d0,d2
	add.l	#$40,d2
;	xTIMER t;
	lea	-$16A(a5),a0
	move.l	a0,-$1D8(a5)
	moveq	#$32,d3
	move.l	sym_handlers,-$1A0(a5)
	move.l	-$1D8(a5),-$1D0(a5)
	tst.l	_TimerBase__xTIMABLE
	bne.b	L414
L413
	move.l	_SysBase,a1
	lea	$15E(a1),a0
	move.l	_SysBase,a6
	move.l	#L398,a1
	jsr	-$114(a6)
	move.l	d0,_TimerBase__xTIMABLE
	move.l	_TimerBase,a6
	move.l	#_current__xTIMABLE,a0
	jsr	-$3C(a6)
	move.l	d0,_clockFreq__xTIMABLE
L414
	lea	-$1D8(a5),a0
	move.l	-$1D0(a5),-(a0)
	move.l	#_0dt__xTIMABLE__T,-(a0)
	move.l	sym_handlers,-(a0)
	move.l	a0,sym_handlers
	move.l	d3,d0
	move.l	-$1D8(a5),a0
	cmp.l	#1,d0
	bls.b	L416
L415
	bra.b	L417
L416
	moveq	#1,d0
L417
	move.l	d0,$14(a0)
	move.l	$14(a0),d0
	mulu.l	_clockFreq__xTIMABLE,d0
	divul.l	#$3E8,d0
	move.l	d0,$10(a0)
	move.l	-$1D8(a5),-$1C8(a5)
	move.l	_TimerBase,a6
	move.l	#_current__xTIMABLE,a0
	jsr	-$3C(a6)
	move.l	-$1C8(a5),a0
	lea	$8(a0),a1
	lea	_current__xTIMABLE,a0
	move.l	(a0),(a1)
	move.l	4(a0),4(a1)
	lea	_current__xTIMABLE,a1
	move.l	-$1D8(a5),a0
	move.l	(a1),(a0)
	move.l	4(a1),4(a0)
	move.l	-$1A0(a5),sym_handlers
	lea	-$16A(a5),a1
	move.l	a1,-(a1)
	move.l	#_0dt__xTIMER__T,-(a1)
	move.l	sym_handlers,-(a1)
	move.l	a1,sym_handlers
;	for (sint32 i = 0
	moveq	#0,d3
;	for (sint32 i = 0, j = 0;
	moveq	#0,d4
	bra	L462
L418
;		if (j>=flame.Cells())
	moveq	#0,d0
	move.w	-$7C(a5),d0
	cmp.l	d0,d4
	blt.b	L420
L419
;			j = 0;
	moveq	#0,d4
L420
;		t.Set();
	lea	-$16A(a5),a0
	move.l	a0,-$1CC(a5)
	move.l	_TimerBase,a6
	move.l	#_current__xTIMABLE,a0
	jsr	-$3C(a6)
	move.l	-$1CC(a5),a0
	lea	$8(a0),a1
	lea	_current__xTIMABLE,a0
	move.l	(a0),(a1)
	move.l	4(a0),4(a1)
;		xDRAW::Begin();
	move.l	_nestCount__xDRAW,d0
	addq.l	#1,_nestCount__xDRAW
	tst.l	d0
	bne.b	L426
L421
	move.l	_flags__xDRAW,d0
	and.l	#1,d0
	beq.b	L423
L422
	bra	L435
L423
	or.l	#3,_flags__xDRAW
	move.l	_flags__xDRAW,d0
	and.l	#$40,d0
	beq.b	L425
L424
	and.l	#-$41,_flags__xDRAW
	bra.b	L426
L425
	clr.l	_vBufPos__xDRAW
L426
	move.l	_flags__xDRAW,d0
	and.l	#$10,d0
	beq.b	L434
L427
	move.l	_flags__xDRAW,d0
	and.l	#$20,d0
	beq.b	L429
L428
	moveq	#0,d0
	bra.b	L432
L429
	move.l	_context__x3D,a0
	move.l	_Warp3DBase,a6
	jsr	-$3C(a6)
	tst.l	d0
	bne.b	L431
L430
	or.l	#$20,_flags__xDRAW
	moveq	#0,d0
	bra.b	L432
L431
	and.l	#-$21,_flags__xDRAW
	move.l	#-$3050005,d0
L432
	tst.l	d0
L433
L434
L435
;			xDRAW::Disable(xDRAW::ALPHA_BLEND);
	move.l	_context__x3D,a0
	move.l	_Warp3DBase,a6
	move.l	#$2000,d0
	moveq	#2,d1
	jsr	-$30(a6)
;			xDRAW::RectShV(skyCol, 		skyPos[0], skyPos[1]);
	move.l	-$64(a5),a1
	move.l	4(a1),-(a7)
	move.l	-$64(a5),a0
	move.l	(a0),-(a7)
	move.l	-$70(a5),a6
	jsr	RectShV__xDRAW__r14PUjUjUj
	addq.w	#$8,a7
;			xDRAW::RectShV(skyCol+1,	skyPos[2], skyPos[3]);
	move.l	-$64(a5),a1
	move.l	$C(a1),-(a7)
	move.l	-$64(a5),a1
	move.l	$8(a1),-(a7)
	move.l	-$70(a5),a0
	lea	4(a0),a6
	jsr	RectShV__xDRAW__r14PUjUjUj
	addq.w	#$8,a7
;			xDRAW::RectShV(skyCol+2,	skyPos[4], skyPos[5]);
	move.l	-$64(a5),a1
	move.l	$14(a1),-(a7)
	move.l	-$64(a5),a1
	move.l	$10(a1),-(a7)
	move.l	-$70(a5),a0
	lea	$8(a0),a6
	jsr	RectShV__xDRAW__r14PUjUjUj
	addq.w	#$8,a7
;			xDRAW::Enable(xDRAW::ALPHA_BLEND);
	move.l	_context__x3D,a0
	move.l	_Warp3DBase,a6
	move.l	#$2000,d0
	moveq	#1,d1
	jsr	-$30(a6)
;				if (rand()>(14*RAND_MAX/16))
	jsr	_rand
	cmp.l	#$6FFF,d0
	ble.b	L437
L436
;					size += rand()/(RAND_MAX/32);
	jsr	_rand
	divsl.l	#$3FF,d0
	add.l	d0,d2
L437
;				uint32 m = size+(rand()/(RAND_MAX/16));
	jsr	_rand
	divsl.l	#$7FF,d0
	add.l	d2,d0
;				SetCol32A(fireCol[0],0x6F+m);
	move.l	d0,d5
	add.l	#$6F,d5
	move.l	-$78(a5),a0
	and.l	#$FFFFFF,(a0)
	moveq	#$18,d1
	asl.l	d1,d5
	or.l	d5,(a0)
;				SetCol32G(treeCol[1],0x60+m);
	move.l	d0,d1
	add.l	#$60,d1
	move.l	-$74(a5),a1
	lea	4(a1),a0
	and.l	#-$FF01,(a0)
	moveq	#$8,d0
	asl.l	d0,d1
	or.l	d1,(a0)
;			if ((i&3L)==0)
	move.l	d3,d0
	and.l	#3,d0
	bne.b	L439
L438
;				SetCol32B(skyCol[0], 0x4F-(i>>3));
	move.l	d3,d1
	moveq	#3,d0
	asr.l	d0,d1
	moveq	#$4F,d0
	sub.l	d1,d0
	move.l	d0,d1
	move.l	-$70(a5),a0
	and.l	#-$100,(a0)
	or.l	d1,(a0)
;				SetCol32R(skyCol[1], 0xA0-(i>>2));
	move.l	d3,d0
	moveq	#2,d1
	asr.l	d1,d0
	move.l	#$A0,d1
	sub.l	d0,d1
	move.l	d1,d0
	move.l	-$70(a5),a1
	lea	4(a1),a0
	and.l	#-$FF0001,(a0)
	moveq	#$10,d1
	asl.l	d1,d0
	or.l	d0,(a0)
;				SetCol32G(skyCol[1], 0x40-(i>>3));
	move.l	d3,d0
	moveq	#3,d1
	asr.l	d1,d0
	moveq	#$40,d1
	sub.l	d0,d1
	move.l	d1,d0
	move.l	-$70(a5),a1
	lea	4(a1),a0
	and.l	#-$FF01,(a0)
	moveq	#$8,d1
	asl.l	d1,d0
	or.l	d0,(a0)
L439
;			xDRAW::ElipseScTxShC(fireCol, firePos[2], firePos[3], g
	move.l	-$6C(a5),a2
	move.l	$C(a2),-(a7)
	move.l	-$6C(a5),a2
	move.l	$8(a2),-(a7)
	lea	-$F4(a5),a0
	move.l	a0,a3
	move.l	-$78(a5),a6
	jsr	ElipseScTxShC__xDRAW__r14PUjUjUjr11R08xTEXTURE
	addq.w	#$8,a7
;				xDRAW::RectScTxShV(treeCol+2,	treePos[0], treePos[1],
	move.l	-$68(a5),a2
	move.l	4(a2),-(a7)
	move.l	-$68(a5),a1
	move.l	(a1),-(a7)
	move.l	-$74(a5),a1
	lea	-$138(a5),a0
	move.l	a0,a3
	lea	$8(a1),a6
	jsr	RectScTxShV__xDRAW__r14PUjUjUjr11R08xTEXTURE
	addq.w	#$8,a7
;				xDRAW::RectScTxShV(treeCol+2,	treePos[2], treePos[3],
	move.l	-$68(a5),a2
	move.l	$C(a2),-(a7)
	move.l	-$68(a5),a2
	move.l	$8(a2),-(a7)
	move.l	-$74(a5),a1
	lea	-$138(a5),a0
	move.l	a0,a3
	lea	$8(a1),a6
	jsr	RectScTxShV__xDRAW__r14PUjUjUjr11R08xTEXTURE
	addq.w	#$8,a7
;				xDRAW::RectScTxShV(treeCol+2,	treePos[4], treePos[5],
	move.l	-$68(a5),a2
	move.l	$14(a2),-(a7)
	move.l	-$68(a5),a2
	move.l	$10(a2),-(a7)
	move.l	-$74(a5),a1
	lea	-$138(a5),a0
	move.l	a0,a3
	lea	$8(a1),a6
	jsr	RectScTxShV__xDRAW__r14PUjUjUjr11R08xTEXTURE
	addq.w	#$8,a7
;				xDRAW::RectScTxShV(treeCol,	treePos[6], treePos[7], t
	move.l	-$68(a5),a2
	move.l	$1C(a2),-(a7)
	move.l	-$68(a5),a2
	move.l	$18(a2),-(a7)
	lea	-$138(a5),a0
	move.l	a0,a3
	move.l	-$74(a5),a6
	jsr	RectScTxShV__xDRAW__r14PUjUjUjr11R08xTEXTURE
	addq.w	#$8,a7
;				xDRAW::RectScTxShV(treeCol,	treePos[8], treePos[9], t
	move.l	-$68(a5),a2
	move.l	$24(a2),-(a7)
	move.l	-$68(a5),a2
	move.l	$20(a2),-(a7)
	lea	-$138(a5),a0
	move.l	a0,a3
	move.l	-$74(a5),a6
	jsr	RectScTxShV__xDRAW__r14PUjUjUjr11R08xTEXTURE
	addq.w	#$8,a7
;				xDRAW::RectScTxShV(treeCol,	treePos[10], treePos[11],
	move.l	-$68(a5),a2
	move.l	$2C(a2),-(a7)
	move.l	-$68(a5),a2
	move.l	$28(a2),-(a7)
	lea	-$138(a5),a0
	move.l	a0,a3
	move.l	-$74(a5),a6
	jsr	RectScTxShV__xDRAW__r14PUjUjUjr11R08xTEXTURE
	addq.w	#$8,a7
;				xDRAW::RectScTxShV(treeCol,	treePos[12], treePos[13],
	move.l	-$68(a5),a2
	move.l	$34(a2),-(a7)
	move.l	-$68(a5),a2
	move.l	$30(a2),-(a7)
	lea	-$138(a5),a0
	move.l	a0,a3
	move.l	-$74(a5),a6
	jsr	RectScTxShV__xDRAW__r14PUjUjUjr11R08xTEXTURE
	addq.w	#$8,a7
;			flame.Cell(j);
	move.w	d4,d0
	lea	-$B0(a5),a0
	move.l	$20(a0),d1
	and.l	#4,d1
	beq.b	L444
L440
	tst.w	d0
	bmi.b	L442
L441
	move.w	d0,d5
	ext.l	d5
	moveq	#0,d1
	move.w	$34(a0),d1
	cmp.l	d1,d5
	ble.b	L443
L442
	bra.b	L445
L443
	move.w	d0,$36(a0)
	move.w	$2C(a0),d5
	ext.l	d5
	move.w	d0,d1
	ext.l	d1
	move.w	$30(a0),-$18A(a5)
	divs	-$18A(a5),d1
	swap	d1
	ext.l	d1
	muls.l	d1,d5
	move.w	d5,$24(a0)
	move.w	$2E(a0),d1
	ext.l	d1
	ext.l	d0
	divs	$30(a0),d0
	ext.l	d0
	muls.l	d0,d1
	move.w	d1,$26(a0)
	move.w	$24(a0),d0
	ext.l	d0
	move.w	$2C(a0),d1
	ext.l	d1
	add.l	d1,d0
	move.w	d0,$28(a0)
	move.w	$26(a0),d0
	ext.l	d0
	move.w	$2E(a0),d1
	ext.l	d1
	add.l	d1,d0
	move.w	d0,$2A(a0)
L444
L445
;			xDRAW::RectScTx(0xFFFFFFFF, Coord(flameX-(size>>1), fla
	move.w	-$146(a5),d0
	ext.l	d0
	move.l	d2,d1
	moveq	#1,d6
	asr.l	d6,d1
	add.l	d1,d0
	ext.l	d0
	moveq	#$10,d1
	asl.l	d1,d0
	move.w	-$14A(a5),d1
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.w	-$148(a5),d0
	ext.l	d0
	sub.l	d2,d0
	move.w	d0,d5
	move.w	-$146(a5),d0
	ext.l	d0
	move.l	d2,d1
	moveq	#1,d6
	asr.l	d6,d1
	sub.l	d1,d0
	ext.l	d0
	moveq	#$10,d1
	asl.l	d1,d0
	move.w	d5,d1
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.l	#-1,-(a7)
	lea	-$B0(a5),a6
	jsr	RectScTx__xDRAW__UjUjUjr14R08xTEXTURE
	add.w	#$C,a7
;			size = (size<<3) - size + 64;
	move.l	d2,d0
	moveq	#3,d1
	asl.l	d1,d0
	sub.l	d2,d0
	move.l	d0,d2
	add.l	#$40,d2
;	size>>=3;
	moveq	#3,d0
	asr.l	d0,d2
;		xDRAW::End();
	tst.l	_nestCount__xDRAW
	bne.b	L447
L446
	bra	L458
L447
	subq.l	#1,_nestCount__xDRAW
	tst.l	_nestCount__xDRAW
	bne.b	L453
L448
	bra.b	L450
L449
	bra.b	L458
L450
	and.l	#-2,_flags__xDRAW
	move.l	_context__x3D,a0
	move.l	_Warp3DBase,a6
	jsr	-$1B0(a6)
	move.l	_vBufPos__xDRAW,d0
	cmp.l	_maxVBufPos__xDRAW,d0
	ble.b	L452
L451
	move.l	_vBufPos__xDRAW,_maxVBufPos__xDRAW
L452
	clr.l	_vBufPos__xDRAW
	addq.l	#1,_flushCnt__xDRAW
L453
	move.l	_flags__xDRAW,d0
	and.l	#$10,d0
	beq.b	L457
L454
	bra.b	L456
L455
	bra.b	L457
L456
	and.l	#-$21,_flags__xDRAW
	move.l	_context__x3D,a0
	move.l	_Warp3DBase,a6
	jsr	-$42(a6)
L457
L458
;		ms += t.ElapsedSet();
	lea	-$16A(a5),a0
	move.l	a0,-$1D4(a5)
	move.l	_TimerBase,a6
	move.l	#_current__xTIMABLE,a0
	jsr	-$3C(a6)
	move.l	_current__xTIMABLE,d1
	move.l	-$1D4(a5),a1
	cmp.l	$8(a1),d1
	bne.b	L460
L459
	move.l	_current__xTIMABLE+4,d0
	move.l	-$1D4(a5),a1
	sub.l	$C(a1),d0
	bra.b	L461
L460
	move.l	-$1D4(a5),a1
	moveq	#-1,d0
	sub.l	$C(a1),d0
	move.l	_current__xTIMABLE+4,d1
	add.l	d1,d0
L461
	mulu.l	#$3E8,d0
	divul.l	_clockFreq__xTIMABLE,d0
	add.l	d0,-$14E(a5)
;		win.Refresh();
	move.l	$8(a5),a1
	move.l	$52(a1),a0
	move.l	$8(a5),d0
	add.l	$24(a0),d0
	move.l	d0,-(a7)
	move.l	$20(a0),a0
	jsr	(a0)
	addq.w	#4,a7
;		win.WaitSync();
	move.l	_GfxBase,a6
	jsr	-$10E(a6)
	addq.l	#1,d3
	addq.l	#1,d4
L462
	cmp.l	#$200,d3
	blt	L418
L463
	lea	-$176(a5),a0
	jsr	lib_destruct_a0
	lea	-$144(a5),a0
	jsr	lib_destruct_a0
	lea	-$100(a5),a0
	jsr	lib_destruct_a0
	lea	-$BC(a5),a0
	jsr	lib_destruct_a0
	move.l	-$14E(a5),d0
	fmovem.x (a7)+,fp2/fp3
	movem.l	(a7)+,d2-d6/a2/a3/a6
	unlk	a5
	rts

L392
	dc.b	'Couldn't load texture',0
L397
	dc.b	'Couldn't load tree texture',0
L394
	dc.b	'Error',0
L393
	dc.b	'OK',0
L391
	dc.b	'flame.ppm',0
L395
	dc.b	'ground.ppm',0
L398
	dc.b	'timer.device',0
L396
	dc.b	'tree.tex',0

	SECTION "CampFireFX__R08xDISPLAY:1",DATA

_posF__CampFireFX__R08xDISPLAY
	dc.l	0,0,$3F800000,$3EC00000,0,$3EC00000,$3F800000,$3F000000,0,$3F000000,$3F800000
	dc.l	$3F800000,$3E2E0008,$3E900000,$3EFD000D,$3F1B0005,$3D07FFF9,$3EA70005,$3EB70005,$3F138002,$3F1E8007,$3EA70005
	dc.l	$3F717FFB,$3F15E03F,$3EAD000E,$3E61FFF7,$3F238002,$3F187FFD,$BE7C0011,$3D87FFF9,$3ECE0008,$3F3DFFF7,$3ED80001
	dc.l	$3D83FFFC,$3F71FFF9,$3F29FFF9,$3F2E8006,$3E03FFF0,$3F9DBFF0,$3F340001,$3F000000,$3EC00000,$3F000000,$3F400000
	dc.l	$3F000000,$3F400000,$3F19999A,$3DCCCCCD
_bGrad__CampFireFX__R08xDISPLAY
	dc.l	-$FFFFB1,-$5FBF01,-$1000000,-$FFF7FE,-$F7F7E0,-$9FD0,-$F7F7E0,-$70BFE0,$7FFFE030,-$F5F7FE

	SECTION "LightSourceTXFX__R08xDISPLAY:0",CODE


;uint32 LightSourceTXFX(xDISPLAY& win)
	XDEF	LightSourceTXFX__R08xDISPLAY
LightSourceTXFX__R08xDISPLAY
L583	EQU	-$10C
	link	a5,#L583
	movem.l	d2-d6/a2/a6,-(a7)
L470
;	xTEXTURE robot;
	move.l	#_0virttab__08xTEXTURE__08xTEXTURE,-$30(a5)
	lea	-$38(a5),a0
	move.l	sym_handlers,a1
	clr.w	(a0)
	clr.w	2(a0)
	clr.w	4(a0)
	move.w	#$F,6(a0)
	lea	-$100(a5),a2
	move.l	a0,-(a2)
	move.l	#_0dt__AREA__T,-(a2)
	move.l	sym_handlers,-(a2)
	move.l	a2,sym_handlers
	clr.l	$C(a0)
	clr.l	$10(a0)
	clr.l	$14(a0)
	clr.l	$18(a0)
	clr.l	$1C(a0)
	clr.l	$20(a0)
	move.l	a1,sym_handlers
	lea	-$38(a5),a1
	move.l	a1,-(a1)
	move.l	#_0dt__xTEXTURE__T,-(a1)
	move.l	sym_handlers,-(a1)
	move.l	a1,sym_handlers
;	sint32 r = robot.LoadLST("robot.tex",TXS_ARGB_4444);
	move.w	#4,-(a7)
	move.l	#L465,-(a7)
	pea	-$38(a5)
	jsr	LoadLST__xTEXTURE__TPCcs
	add.w	#$A,a7
	move.l	d0,d2
;	robot.SetEnv(xTEXTURE::MODULATE);
	lea	-$38(a5),a0
	move.l	$10(a0),a1
	move.l	_Warp3DBase,a6
	moveq	#3,d1
	move.l	$C(a0),a0
	sub.l	a2,a2
	jsr	-$7E(a6)
;	if(r!=OK)
	tst.l	d2
	beq.b	L472
L471
;		sysBASELIB::MessageBox("Error", "OK", "Couldn't load
	clr.l	-(a7)
	move.l	d2,-(a7)
	jsr	Error__xBASELIB__jPc
	addq.w	#$8,a7
	move.l	d0,-(a7)
	move.l	#L466,-(a7)
	move.l	#L467,-(a7)
	move.l	#L468,-(a7)
	jsr	MessageBox__sysBASELIB__PcPcPce
	add.w	#$10,a7
	lea	-$44(a5),a0
	jsr	lib_destruct_a0
	moveq	#0,d0
	movem.l	(a7)+,d2-d6/a2/a6
	unlk	a5
	rts
L472
;	uint32 background[] = {0xFF000000, 0xFF000000, 0xFF000000, 0xFF000
	lea	-$58(a5),a0
	move.l	#-$1000000,(a0)+
	move.l	#-$1000000,(a0)+
	move.l	#-$1000000,(a0)+
	move.l	#-$1000000,(a0)
;	uint32 ambient = 0xFF202020;
	move.l	#-$DFDFE0,-$5C(a5)
;	uint32 top     = 0x00C0D0FF;
	move.l	#$C0D0FF,-$60(a5)
;	uint32 bottom  = 0xFFFF0000;
	move.l	#-$10000,-$64(a5)
;	uint32 left    = 0x000080FF;
	move.l	#$80FF,-$68(a5)
;	uint32 right   = 0xFFFFFF00;
	move.l	#-$100,-$6C(a5)
;	sint16 winW = win.Width();
	move.l	$8(a5),a0
	cmp.w	#0,a0
	beq.b	L474
L473
	move.l	4(a0),a0
L474
	move.l	$8(a0),a1
	move.l	a0,d0
	add.l	$2C(a1),d0
	move.l	d0,-(a7)
	move.l	$28(a1),a1
	jsr	(a1)
	addq.w	#4,a7
	move.w	d0,-$6E(a5)
;	sint16 winH = win.Height();
	move.l	$8(a5),a0
	cmp.w	#0,a0
	beq.b	L476
L475
	move.l	4(a0),a0
L476
	move.l	$8(a0),a1
	move.l	a0,d0
	add.l	$24(a1),d0
	move.l	d0,-(a7)
	move.l	$20(a1),a1
	jsr	(a1)
	addq.w	#4,a7
	move.w	d0,d3
;	uint32 ms = 0;
	clr.l	-$74(a5)
;	xTIMER t;
	lea	-$8C(a5),a0
	move.l	a0,-$F0(a5)
	moveq	#$32,d2
	move.l	sym_handlers,-$D4(a5)
	move.l	-$F0(a5),-$E8(a5)
	tst.l	_TimerBase__xTIMABLE
	bne.b	L478
L477
	move.l	_SysBase,a1
	lea	$15E(a1),a0
	move.l	_SysBase,a6
	move.l	#L469,a1
	jsr	-$114(a6)
	move.l	d0,_TimerBase__xTIMABLE
	move.l	_TimerBase,a6
	move.l	#_current__xTIMABLE,a0
	jsr	-$3C(a6)
	move.l	d0,_clockFreq__xTIMABLE
L478
	lea	-$F0(a5),a0
	move.l	-$E8(a5),-(a0)
	move.l	#_0dt__xTIMABLE__T,-(a0)
	move.l	sym_handlers,-(a0)
	move.l	a0,sym_handlers
	move.l	d2,d0
	move.l	-$F0(a5),a0
	cmp.l	#1,d0
	bls.b	L480
L479
	bra.b	L481
L480
	moveq	#1,d0
L481
	move.l	d0,$14(a0)
	move.l	$14(a0),d0
	mulu.l	_clockFreq__xTIMABLE,d0
	divul.l	#$3E8,d0
	move.l	d0,$10(a0)
	move.l	-$F0(a5),-$E0(a5)
	move.l	_TimerBase,a6
	move.l	#_current__xTIMABLE,a0
	jsr	-$3C(a6)
	move.l	-$E0(a5),a0
	lea	$8(a0),a1
	lea	_current__xTIMABLE,a0
	move.l	(a0),(a1)
	move.l	4(a0),4(a1)
	lea	_current__xTIMABLE,a1
	move.l	-$F0(a5),a0
	move.l	(a1),(a0)
	move.l	4(a1),4(a0)
	move.l	-$D4(a5),sym_handlers
	lea	-$8C(a5),a1
	move.l	a1,-(a1)
	move.l	#_0dt__xTIMER__T,-(a1)
	move.l	sym_handlers,-(a1)
	move.l	a1,sym_handlers
;	xDRAW::Disable(xDRAW::ALPHA_BLEND);
	move.l	_context__x3D,a0
	move.l	_Warp3DBase,a6
	move.l	#$2000,d0
	moveq	#2,d1
	jsr	-$30(a6)
;	for (sint32 i=0
	clr.l	-$9C(a5)
;	for (sint32 i=0, j=0;
	clr.l	-$A0(a5)
	bra	L581
L482
;		if (j>=robot.CellsH()) 
	move.w	-$8(a5),d0
	ext.l	d0
	move.l	-$A0(a5),d1
	cmp.l	d0,d1
	blt.b	L484
L483
;		if (j>=robot.CellsH()) j = 0;
	clr.l	-$A0(a5)
L484
;		t.Set();
	lea	-$8C(a5),a0
	move.l	a0,-$E4(a5)
	move.l	_TimerBase,a6
	move.l	#_current__xTIMABLE,a0
	jsr	-$3C(a6)
	move.l	-$E4(a5),a0
	lea	$8(a0),a1
	lea	_current__xTIMABLE,a0
	move.l	(a0),(a1)
	move.l	4(a0),4(a1)
;		xDRAW::Begin();
	move.l	_nestCount__xDRAW,d0
	addq.l	#1,_nestCount__xDRAW
	tst.l	d0
	bne.b	L490
L485
	move.l	_flags__xDRAW,d0
	and.l	#1,d0
	beq.b	L487
L486
	bra	L499
L487
	or.l	#3,_flags__xDRAW
	move.l	_flags__xDRAW,d0
	and.l	#$40,d0
	beq.b	L489
L488
	and.l	#-$41,_flags__xDRAW
	bra.b	L490
L489
	clr.l	_vBufPos__xDRAW
L490
	move.l	_flags__xDRAW,d0
	and.l	#$10,d0
	beq.b	L498
L491
	move.l	_flags__xDRAW,d0
	and.l	#$20,d0
	beq.b	L493
L492
	moveq	#0,d0
	bra.b	L496
L493
	move.l	_context__x3D,a0
	move.l	_Warp3DBase,a6
	jsr	-$3C(a6)
	tst.l	d0
	bne.b	L495
L494
	or.l	#$20,_flags__xDRAW
	moveq	#0,d0
	bra.b	L496
L495
	and.l	#-$21,_flags__xDRAW
	move.l	#-$3050005,d0
L496
	tst.l	d0
L497
L498
L499
;			background[1] = background[0] = Col32(0xFF, i>>1, i>>1, i>>1);
	move.l	-$9C(a5),d4
	moveq	#1,d0
	asr.l	d0,d4
	move.l	-$9C(a5),d2
	moveq	#1,d0
	asr.l	d0,d2
	move.l	-$9C(a5),d1
	moveq	#1,d0
	asr.l	d0,d1
	move.l	#$FF,d0
	moveq	#$18,d5
	asl.l	d5,d0
	moveq	#$10,d5
	asl.l	d5,d1
	or.l	d1,d0
	moveq	#$8,d1
	asl.l	d1,d2
	or.l	d2,d0
	or.l	d4,d0
	move.l	d0,-$58(a5)
	lea	-$58(a5),a0
	move.l	d0,4(a0)
;			background[2] = Col32(0xFF, 255-i, 128-(i>>1), 0);
	move.l	-$9C(a5),d1
	moveq	#1,d0
	asr.l	d0,d1
	move.l	#$80,d0
	sub.l	d1,d0
	move.l	d0,d1
	move.l	#$FF,d2
	sub.l	-$9C(a5),d2
	move.l	#$FF,d0
	moveq	#$18,d5
	asl.l	d5,d0
	moveq	#$10,d5
	asl.l	d5,d2
	or.l	d2,d0
	moveq	#$8,d2
	asl.l	d2,d1
	or.l	d1,d0
	lea	-$58(a5),a0
	move.l	d0,$8(a0)
;			background[3] = Col32(0xFF, 255-i, i>>1, i);
	move.l	-$9C(a5),d2
	moveq	#1,d0
	asr.l	d0,d2
	move.l	#$FF,d1
	sub.l	-$9C(a5),d1
	move.l	#$FF,d0
	moveq	#$18,d5
	asl.l	d5,d0
	moveq	#$10,d5
	asl.l	d5,d1
	or.l	d1,d0
	moveq	#$8,d1
	asl.l	d1,d2
	or.l	d2,d0
	or.l	-$9C(a5),d0
	lea	-$58(a5),a0
	move.l	d0,$C(a0)
;			xDRAW::RectShA(background, 0, Coord(winW, winH));
	move.w	-$6E(a5),d0
	ext.l	d0
	moveq	#$10,d2
	asl.l	d2,d0
	move.w	d3,d1
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	clr.l	-(a7)
	lea	-$58(a5),a6
	jsr	RectShA__xDRAW__r14PUjUjUj
	addq.w	#$8,a7
;			xDRAW::Enable(xDRAW::ALPHA_BLEND);
	move.l	_context__x3D,a0
	move.l	_Warp3DBase,a6
	move.l	#$2000,d0
	moveq	#1,d1
	jsr	-$30(a6)
;				robot.Cell(j);
	move.w	-$9E(a5),d0
	lea	-$38(a5),a0
	move.l	$20(a0),d1
	and.l	#4,d1
	beq.b	L504
L500
	tst.w	d0
	bmi.b	L502
L501
	move.w	d0,d2
	ext.l	d2
	moveq	#0,d1
	move.w	$34(a0),d1
	cmp.l	d1,d2
	ble.b	L503
L502
	bra.b	L505
L503
	move.w	d0,$36(a0)
	move.w	$2C(a0),d2
	ext.l	d2
	move.w	d0,d1
	ext.l	d1
	divs	$30(a0),d1
	swap	d1
	ext.l	d1
	muls.l	d1,d2
	move.w	d2,$24(a0)
	move.w	$2E(a0),d1
	ext.l	d1
	ext.l	d0
	divs	$30(a0),d0
	ext.l	d0
	muls.l	d0,d1
	move.w	d1,$26(a0)
	move.w	$24(a0),d0
	ext.l	d0
	move.w	$2C(a0),d1
	ext.l	d1
	add.l	d1,d0
	move.w	d0,$28(a0)
	move.w	$26(a0),d0
	ext.l	d0
	move.w	$2E(a0),d1
	ext.l	d1
	add.l	d1,d0
	move.w	d0,$2A(a0)
L504
L505
;				robot.SetFilter(xTEXTURE::LINEAR);
	lea	-$38(a5),a0
	move.l	$10(a0),a1
	move.l	_Warp3DBase,a6
	moveq	#1,d0
	moveq	#2,d1
	move.l	$C(a0),a0
	jsr	-$78(a6)
;				xDRAW::RectScTx(ambient, Coord((winW>>1)+160,(winH>>1)
	move.w	d3,d0
	ext.l	d0
	moveq	#1,d1
	asr.l	d1,d0
	add.l	#$A0,d0
	move.w	d0,d1
	move.w	-$6E(a5),d0
	ext.l	d0
	moveq	#1,d2
	asr.l	d2,d0
	sub.l	#$A0,d0
	ext.l	d0
	moveq	#$10,d2
	asl.l	d2,d0
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.w	d3,d0
	ext.l	d0
	moveq	#1,d1
	asr.l	d1,d0
	sub.l	#$A0,d0
	move.w	d0,d1
	move.w	-$6E(a5),d0
	ext.l	d0
	moveq	#1,d2
	asr.l	d2,d0
	add.l	#$A0,d0
	ext.l	d0
	moveq	#$10,d2
	asl.l	d2,d0
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.l	-$5C(a5),-(a7)
	lea	-$38(a5),a6
	jsr	RectScTx__xDRAW__UjUjUjr14R08xTEXTURE
	add.w	#$C,a7
;				robot.Cell(j+robot.CellsH());
	move.w	-$8(a5),d0
	ext.l	d0
	add.l	-$A0(a5),d0
	lea	-$38(a5),a0
	move.l	$20(a0),d1
	and.l	#4,d1
	beq.b	L510
L506
	tst.w	d0
	bmi.b	L508
L507
	move.w	d0,d2
	ext.l	d2
	moveq	#0,d1
	move.w	$34(a0),d1
	cmp.l	d1,d2
	ble.b	L509
L508
	bra.b	L511
L509
	move.w	d0,$36(a0)
	move.w	$2C(a0),d2
	ext.l	d2
	move.w	d0,d1
	ext.l	d1
	divs	$30(a0),d1
	swap	d1
	ext.l	d1
	muls.l	d1,d2
	move.w	d2,$24(a0)
	move.w	$2E(a0),d1
	ext.l	d1
	ext.l	d0
	divs	$30(a0),d0
	ext.l	d0
	muls.l	d0,d1
	move.w	d1,$26(a0)
	move.w	$24(a0),d0
	ext.l	d0
	move.w	$2C(a0),d1
	ext.l	d1
	add.l	d1,d0
	move.w	d0,$28(a0)
	move.w	$26(a0),d0
	ext.l	d0
	move.w	$2E(a0),d1
	ext.l	d1
	add.l	d1,d0
	move.w	d0,$2A(a0)
L510
L511
;				xDRAW::RectScTx(top, Coord((winW>>1)+160,(winH>>1)-16
	move.w	d3,d0
	ext.l	d0
	moveq	#1,d1
	asr.l	d1,d0
	add.l	#$A0,d0
	move.w	d0,d1
	move.w	-$6E(a5),d0
	ext.l	d0
	moveq	#1,d2
	asr.l	d2,d0
	sub.l	#$A0,d0
	ext.l	d0
	moveq	#$10,d2
	asl.l	d2,d0
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.w	d3,d0
	ext.l	d0
	moveq	#1,d1
	asr.l	d1,d0
	sub.l	#$A0,d0
	move.w	d0,d1
	move.w	-$6E(a5),d0
	ext.l	d0
	moveq	#1,d2
	asr.l	d2,d0
	add.l	#$A0,d0
	ext.l	d0
	moveq	#$10,d2
	asl.l	d2,d0
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.l	-$60(a5),-(a7)
	lea	-$38(a5),a6
	jsr	RectScTx__xDRAW__UjUjUjr14R08xTEXTURE
	add.w	#$C,a7
;				robot.Cell(j+robot.CellsH()*2);
	move.w	-$8(a5),d0
	ext.l	d0
	moveq	#1,d1
	asl.l	d1,d0
	add.l	-$A0(a5),d0
	lea	-$38(a5),a0
	move.l	$20(a0),d1
	and.l	#4,d1
	beq.b	L516
L512
	tst.w	d0
	bmi.b	L514
L513
	move.w	d0,d2
	ext.l	d2
	moveq	#0,d1
	move.w	$34(a0),d1
	cmp.l	d1,d2
	ble.b	L515
L514
	bra.b	L517
L515
	move.w	d0,$36(a0)
	move.w	$2C(a0),d2
	ext.l	d2
	move.w	d0,d1
	ext.l	d1
	divs	$30(a0),d1
	swap	d1
	ext.l	d1
	muls.l	d1,d2
	move.w	d2,$24(a0)
	move.w	$2E(a0),d1
	ext.l	d1
	ext.l	d0
	divs	$30(a0),d0
	ext.l	d0
	muls.l	d0,d1
	move.w	d1,$26(a0)
	move.w	$24(a0),d0
	ext.l	d0
	move.w	$2C(a0),d1
	ext.l	d1
	add.l	d1,d0
	move.w	d0,$28(a0)
	move.w	$26(a0),d0
	ext.l	d0
	move.w	$2E(a0),d1
	ext.l	d1
	add.l	d1,d0
	move.w	d0,$2A(a0)
L516
L517
;				xDRAW::RectScTx(bottom, Coord((winW>>1)+160,(winH>>1)
	move.w	d3,d0
	ext.l	d0
	moveq	#1,d1
	asr.l	d1,d0
	add.l	#$A0,d0
	move.w	d0,d1
	move.w	-$6E(a5),d0
	ext.l	d0
	moveq	#1,d2
	asr.l	d2,d0
	sub.l	#$A0,d0
	ext.l	d0
	moveq	#$10,d2
	asl.l	d2,d0
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.w	d3,d0
	ext.l	d0
	moveq	#1,d1
	asr.l	d1,d0
	sub.l	#$A0,d0
	move.w	d0,d1
	move.w	-$6E(a5),d0
	ext.l	d0
	moveq	#1,d2
	asr.l	d2,d0
	add.l	#$A0,d0
	ext.l	d0
	moveq	#$10,d2
	asl.l	d2,d0
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.l	-$64(a5),-(a7)
	lea	-$38(a5),a6
	jsr	RectScTx__xDRAW__UjUjUjr14R08xTEXTURE
	add.w	#$C,a7
;				robot.Cell(j+robot.CellsH()*3);
	move.w	-$8(a5),d0
	muls	#3,d0
	add.l	-$A0(a5),d0
	lea	-$38(a5),a0
	move.l	$20(a0),d1
	and.l	#4,d1
	beq	L522
L518
	tst.w	d0
	bmi.b	L520
L519
	move.w	d0,d2
	ext.l	d2
	moveq	#0,d1
	move.w	$34(a0),d1
	cmp.l	d1,d2
	ble.b	L521
L520
	bra.b	L523
L521
	move.w	d0,$36(a0)
	move.w	$2C(a0),d2
	ext.l	d2
	move.w	d0,d1
	ext.l	d1
	divs	$30(a0),d1
	swap	d1
	ext.l	d1
	muls.l	d1,d2
	move.w	d2,$24(a0)
	move.w	$2E(a0),d1
	ext.l	d1
	ext.l	d0
	divs	$30(a0),d0
	ext.l	d0
	muls.l	d0,d1
	move.w	d1,$26(a0)
	move.w	$24(a0),d0
	ext.l	d0
	move.w	$2C(a0),d1
	ext.l	d1
	add.l	d1,d0
	move.w	d0,$28(a0)
	move.w	$26(a0),d0
	ext.l	d0
	move.w	$2E(a0),d1
	ext.l	d1
	add.l	d1,d0
	move.w	d0,$2A(a0)
L522
L523
;				xDRAW::RectScTx(left, Coord((winW>>1)+160,(winH>>1)-1
	move.w	d3,d0
	ext.l	d0
	moveq	#1,d1
	asr.l	d1,d0
	add.l	#$A0,d0
	move.w	d0,d1
	move.w	-$6E(a5),d0
	ext.l	d0
	moveq	#1,d2
	asr.l	d2,d0
	sub.l	#$A0,d0
	ext.l	d0
	moveq	#$10,d2
	asl.l	d2,d0
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.w	d3,d0
	ext.l	d0
	moveq	#1,d1
	asr.l	d1,d0
	sub.l	#$A0,d0
	move.w	d0,d1
	move.w	-$6E(a5),d0
	ext.l	d0
	moveq	#1,d2
	asr.l	d2,d0
	add.l	#$A0,d0
	ext.l	d0
	moveq	#$10,d2
	asl.l	d2,d0
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.l	-$68(a5),-(a7)
	lea	-$38(a5),a6
	jsr	RectScTx__xDRAW__UjUjUjr14R08xTEXTURE
	add.w	#$C,a7
;				robot.Cell(j+robot.CellsH()*4);
	move.w	-$8(a5),d0
	ext.l	d0
	moveq	#2,d1
	asl.l	d1,d0
	add.l	-$A0(a5),d0
	lea	-$38(a5),a0
	move.l	$20(a0),d1
	and.l	#4,d1
	beq	L528
L524
	tst.w	d0
	bmi.b	L526
L525
	move.w	d0,d2
	ext.l	d2
	moveq	#0,d1
	move.w	$34(a0),d1
	cmp.l	d1,d2
	ble.b	L527
L526
	bra.b	L529
L527
	move.w	d0,$36(a0)
	move.w	$2C(a0),d2
	ext.l	d2
	move.w	d0,d1
	ext.l	d1
	divs	$30(a0),d1
	swap	d1
	ext.l	d1
	muls.l	d1,d2
	move.w	d2,$24(a0)
	move.w	$2E(a0),d1
	ext.l	d1
	ext.l	d0
	divs	$30(a0),d0
	ext.l	d0
	muls.l	d0,d1
	move.w	d1,$26(a0)
	move.w	$24(a0),d0
	ext.l	d0
	move.w	$2C(a0),d1
	ext.l	d1
	add.l	d1,d0
	move.w	d0,$28(a0)
	move.w	$26(a0),d0
	ext.l	d0
	move.w	$2E(a0),d1
	ext.l	d1
	add.l	d1,d0
	move.w	d0,$2A(a0)
L528
L529
;				xDRAW::RectScTx(right, Coord((winW>>1)+160,(winH>>1)-
	move.w	d3,d0
	ext.l	d0
	moveq	#1,d1
	asr.l	d1,d0
	add.l	#$A0,d0
	move.w	d0,d1
	move.w	-$6E(a5),d0
	ext.l	d0
	moveq	#1,d2
	asr.l	d2,d0
	sub.l	#$A0,d0
	ext.l	d0
	moveq	#$10,d2
	asl.l	d2,d0
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.w	d3,d0
	ext.l	d0
	moveq	#1,d1
	asr.l	d1,d0
	sub.l	#$A0,d0
	move.w	d0,d1
	move.w	-$6E(a5),d0
	ext.l	d0
	moveq	#1,d2
	asr.l	d2,d0
	add.l	#$A0,d0
	ext.l	d0
	moveq	#$10,d2
	asl.l	d2,d0
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.l	-$6C(a5),-(a7)
	lea	-$38(a5),a6
	jsr	RectScTx__xDRAW__UjUjUjr14R08xTEXTURE
	add.w	#$C,a7
;			robot.SetFilter(xTEXTURE::NEAREST);
	lea	-$38(a5),a0
	move.l	$10(a0),a1
	move.l	_Warp3DBase,a6
	moveq	#1,d0
	moveq	#1,d1
	move.l	$C(a0),a0
	jsr	-$78(a6)
;			for (sint32 k=80
	moveq	#$50,d2
;			for (sint32 k=80, n=j;
	move.l	-$A0(a5),d4
	bra	L563
L530
;				if (n>=robot.CellsH()) 
	move.w	-$8(a5),d0
	ext.l	d0
	cmp.l	d0,d4
	blt.b	L532
L531
;				if (n>=robot.CellsH()) n = 0;
	moveq	#0,d4
L532
;				robot.Cell(n);
	move.w	d4,d0
	lea	-$38(a5),a0
	move.l	$20(a0),d1
	and.l	#4,d1
	beq	L537
L533
	tst.w	d0
	bmi.b	L535
L534
	move.w	d0,d5
	ext.l	d5
	moveq	#0,d1
	move.w	$34(a0),d1
	cmp.l	d1,d5
	ble.b	L536
L535
	bra.b	L538
L536
	move.w	d0,$36(a0)
	move.w	$2C(a0),d5
	ext.l	d5
	move.w	d0,d1
	ext.l	d1
	move.w	$30(a0),-$BE(a5)
	divs	-$BE(a5),d1
	swap	d1
	ext.l	d1
	muls.l	d1,d5
	move.w	d5,$24(a0)
	move.w	$2E(a0),d1
	ext.l	d1
	ext.l	d0
	divs	$30(a0),d0
	ext.l	d0
	muls.l	d0,d1
	move.w	d1,$26(a0)
	move.w	$24(a0),d0
	ext.l	d0
	move.w	$2C(a0),d1
	ext.l	d1
	add.l	d1,d0
	move.w	d0,$28(a0)
	move.w	$26(a0),d0
	ext.l	d0
	move.w	$2E(a0),d1
	ext.l	d1
	add.l	d1,d0
	move.w	d0,$2A(a0)
L537
L538
;				xDRAW::RectScTx(ambient, Coord(k, winH-120), Coord(k-
	move.w	d3,d0
	ext.l	d0
	sub.l	#$28,d0
	move.w	d0,d1
	move.l	d2,d0
	sub.l	#$50,d0
	ext.l	d0
	moveq	#$10,d5
	asl.l	d5,d0
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.w	d3,d0
	ext.l	d0
	sub.l	#$78,d0
	move.w	d0,d1
	move.w	d2,d0
	ext.l	d0
	moveq	#$10,d5
	asl.l	d5,d0
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.l	-$5C(a5),-(a7)
	lea	-$38(a5),a6
	jsr	RectScTx__xDRAW__UjUjUjr14R08xTEXTURE
	add.w	#$C,a7
;				robot.Cell(n+robot.CellsH());
	move.w	-$8(a5),d0
	ext.l	d0
	add.l	d4,d0
	lea	-$38(a5),a0
	move.l	$20(a0),d1
	and.l	#4,d1
	beq	L543
L539
	tst.w	d0
	bmi.b	L541
L540
	move.w	d0,d5
	ext.l	d5
	moveq	#0,d1
	move.w	$34(a0),d1
	cmp.l	d1,d5
	ble.b	L542
L541
	bra.b	L544
L542
	move.w	d0,$36(a0)
	move.w	$2C(a0),d5
	ext.l	d5
	move.w	d0,d1
	ext.l	d1
	move.w	$30(a0),-$BC(a5)
	divs	-$BC(a5),d1
	swap	d1
	ext.l	d1
	muls.l	d1,d5
	move.w	d5,$24(a0)
	move.w	$2E(a0),d1
	ext.l	d1
	ext.l	d0
	divs	$30(a0),d0
	ext.l	d0
	muls.l	d0,d1
	move.w	d1,$26(a0)
	move.w	$24(a0),d0
	ext.l	d0
	move.w	$2C(a0),d1
	ext.l	d1
	add.l	d1,d0
	move.w	d0,$28(a0)
	move.w	$26(a0),d0
	ext.l	d0
	move.w	$2E(a0),d1
	ext.l	d1
	add.l	d1,d0
	move.w	d0,$2A(a0)
L543
L544
;				xDRAW::RectScTx(top, Coord(k, winH-120), Coord(k-80, 
	move.w	d3,d0
	ext.l	d0
	sub.l	#$28,d0
	move.w	d0,d1
	move.l	d2,d0
	sub.l	#$50,d0
	ext.l	d0
	moveq	#$10,d5
	asl.l	d5,d0
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.w	d3,d0
	ext.l	d0
	sub.l	#$78,d0
	move.w	d0,d1
	move.w	d2,d0
	ext.l	d0
	moveq	#$10,d5
	asl.l	d5,d0
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.l	-$60(a5),-(a7)
	lea	-$38(a5),a6
	jsr	RectScTx__xDRAW__UjUjUjr14R08xTEXTURE
	add.w	#$C,a7
;				robot.Cell(n+robot.CellsH()*2);
	move.w	-$8(a5),d0
	ext.l	d0
	moveq	#1,d1
	asl.l	d1,d0
	add.l	d4,d0
	lea	-$38(a5),a0
	move.l	$20(a0),d1
	and.l	#4,d1
	beq	L549
L545
	tst.w	d0
	bmi.b	L547
L546
	move.w	d0,d5
	ext.l	d5
	moveq	#0,d1
	move.w	$34(a0),d1
	cmp.l	d1,d5
	ble.b	L548
L547
	bra.b	L550
L548
	move.w	d0,$36(a0)
	move.w	$2C(a0),d5
	ext.l	d5
	move.w	d0,d1
	ext.l	d1
	move.w	$30(a0),-$BA(a5)
	divs	-$BA(a5),d1
	swap	d1
	ext.l	d1
	muls.l	d1,d5
	move.w	d5,$24(a0)
	move.w	$2E(a0),d1
	ext.l	d1
	ext.l	d0
	divs	$30(a0),d0
	ext.l	d0
	muls.l	d0,d1
	move.w	d1,$26(a0)
	move.w	$24(a0),d0
	ext.l	d0
	move.w	$2C(a0),d1
	ext.l	d1
	add.l	d1,d0
	move.w	d0,$28(a0)
	move.w	$26(a0),d0
	ext.l	d0
	move.w	$2E(a0),d1
	ext.l	d1
	add.l	d1,d0
	move.w	d0,$2A(a0)
L549
L550
;				xDRAW::RectScTx(bottom, Coord(k, winH-120), Coord(k-8
	move.w	d3,d0
	ext.l	d0
	sub.l	#$28,d0
	move.w	d0,d1
	move.l	d2,d0
	sub.l	#$50,d0
	ext.l	d0
	moveq	#$10,d5
	asl.l	d5,d0
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.w	d3,d0
	ext.l	d0
	sub.l	#$78,d0
	move.w	d0,d1
	move.w	d2,d0
	ext.l	d0
	moveq	#$10,d5
	asl.l	d5,d0
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.l	-$64(a5),-(a7)
	lea	-$38(a5),a6
	jsr	RectScTx__xDRAW__UjUjUjr14R08xTEXTURE
	add.w	#$C,a7
;				robot.Cell(n+robot.CellsH()*3);
	move.w	-$8(a5),d0
	muls	#3,d0
	add.l	d4,d0
	lea	-$38(a5),a0
	move.l	$20(a0),d1
	and.l	#4,d1
	beq	L555
L551
	tst.w	d0
	bmi.b	L553
L552
	move.w	d0,d5
	ext.l	d5
	moveq	#0,d1
	move.w	$34(a0),d1
	cmp.l	d1,d5
	ble.b	L554
L553
	bra.b	L556
L554
	move.w	d0,$36(a0)
	move.w	$2C(a0),d5
	ext.l	d5
	move.w	d0,d1
	ext.l	d1
	move.w	$30(a0),-$B8(a5)
	divs	-$B8(a5),d1
	swap	d1
	ext.l	d1
	muls.l	d1,d5
	move.w	d5,$24(a0)
	move.w	$2E(a0),d1
	ext.l	d1
	ext.l	d0
	divs	$30(a0),d0
	ext.l	d0
	muls.l	d0,d1
	move.w	d1,$26(a0)
	move.w	$24(a0),d0
	ext.l	d0
	move.w	$2C(a0),d1
	ext.l	d1
	add.l	d1,d0
	move.w	d0,$28(a0)
	move.w	$26(a0),d0
	ext.l	d0
	move.w	$2E(a0),d1
	ext.l	d1
	add.l	d1,d0
	move.w	d0,$2A(a0)
L555
L556
;				xDRAW::RectScTx(left, Coord(k, winH-120), Coord(k-80,
	move.w	d3,d0
	ext.l	d0
	sub.l	#$28,d0
	move.w	d0,d1
	move.l	d2,d0
	sub.l	#$50,d0
	ext.l	d0
	moveq	#$10,d5
	asl.l	d5,d0
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.w	d3,d0
	ext.l	d0
	sub.l	#$78,d0
	move.w	d0,d1
	move.w	d2,d0
	ext.l	d0
	moveq	#$10,d5
	asl.l	d5,d0
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.l	-$68(a5),-(a7)
	lea	-$38(a5),a6
	jsr	RectScTx__xDRAW__UjUjUjr14R08xTEXTURE
	add.w	#$C,a7
;				robot.Cell(n+robot.CellsH()*4);
	move.w	-$8(a5),d0
	ext.l	d0
	moveq	#2,d1
	asl.l	d1,d0
	add.l	d4,d0
	lea	-$38(a5),a0
	move.l	$20(a0),d1
	and.l	#4,d1
	beq	L561
L557
	tst.w	d0
	bmi.b	L559
L558
	move.w	d0,d5
	ext.l	d5
	moveq	#0,d1
	move.w	$34(a0),d1
	cmp.l	d1,d5
	ble.b	L560
L559
	bra.b	L562
L560
	move.w	d0,$36(a0)
	move.w	$2C(a0),d5
	ext.l	d5
	move.w	d0,d1
	ext.l	d1
	move.w	$30(a0),-$B6(a5)
	divs	-$B6(a5),d1
	swap	d1
	ext.l	d1
	muls.l	d1,d5
	move.w	d5,$24(a0)
	move.w	$2E(a0),d1
	ext.l	d1
	ext.l	d0
	divs	$30(a0),d0
	ext.l	d0
	muls.l	d0,d1
	move.w	d1,$26(a0)
	move.w	$24(a0),d0
	ext.l	d0
	move.w	$2C(a0),d1
	ext.l	d1
	add.l	d1,d0
	move.w	d0,$28(a0)
	move.w	$26(a0),d0
	ext.l	d0
	move.w	$2E(a0),d1
	ext.l	d1
	add.l	d1,d0
	move.w	d0,$2A(a0)
L561
L562
;				xDRAW::RectScTx(right, Coord(k, winH-120), Coord(k-80
	move.w	d3,d0
	ext.l	d0
	sub.l	#$28,d0
	move.w	d0,d1
	move.l	d2,d0
	sub.l	#$50,d0
	ext.l	d0
	moveq	#$10,d5
	asl.l	d5,d0
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.w	d3,d0
	ext.l	d0
	sub.l	#$78,d0
	move.w	d0,d1
	move.w	d2,d0
	ext.l	d0
	moveq	#$10,d5
	asl.l	d5,d0
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.l	-$6C(a5),-(a7)
	lea	-$38(a5),a6
	jsr	RectScTx__xDRAW__UjUjUjr14R08xTEXTURE
	add.w	#$C,a7
	add.l	#$50,d2
	addq.l	#1,d4
L563
	move.w	-$6E(a5),d0
	ext.l	d0
	cmp.l	d0,d2
	ble	L530
L564
;			xDRAW::Disable(xDRAW::ALPHA_BLEND);
	move.l	_context__x3D,a0
	move.l	_Warp3DBase,a6
	move.l	#$2000,d0
	moveq	#2,d1
	jsr	-$30(a6)
;			xDRAW::Rect(ambient,	Coord(16,4), Coord(16+GetCol32A(am
	move.l	-$5C(a5),d0
	moveq	#$18,d2
	lsr.l	d2,d0
	add.l	#$10,d0
	ext.l	d0
	moveq	#$10,d2
	asl.l	d2,d0
	moveq	#$C,d1
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	moveq	#$10,d0
	ext.l	d0
	moveq	#$10,d2
	asl.l	d2,d0
	moveq	#4,d1
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.l	-$5C(a5),-(a7)
	jsr	Rect__xDRAW__UjUjUj
	add.w	#$C,a7
;			xDRAW::Rect(top, 			Coord(16,16),Coord(16+GetCol32A(top)
	move.l	-$60(a5),d0
	moveq	#$18,d2
	lsr.l	d2,d0
	add.l	#$10,d0
	ext.l	d0
	moveq	#$10,d2
	asl.l	d2,d0
	moveq	#$18,d1
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	moveq	#$10,d0
	ext.l	d0
	moveq	#$10,d2
	asl.l	d2,d0
	moveq	#$10,d1
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.l	-$60(a5),-(a7)
	jsr	Rect__xDRAW__UjUjUj
	add.w	#$C,a7
;			xDRAW::Rect(bottom, 	Coord(16,28),Coord(16+GetCol32A(bo
	move.l	-$64(a5),d0
	moveq	#$18,d2
	lsr.l	d2,d0
	add.l	#$10,d0
	ext.l	d0
	moveq	#$10,d2
	asl.l	d2,d0
	moveq	#$24,d1
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	moveq	#$10,d0
	ext.l	d0
	moveq	#$10,d2
	asl.l	d2,d0
	moveq	#$1C,d1
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.l	-$64(a5),-(a7)
	jsr	Rect__xDRAW__UjUjUj
	add.w	#$C,a7
;			xDRAW::Rect(left, 		Coord(16,40),Coord(16+GetCol32A(lef
	move.l	-$68(a5),d0
	moveq	#$18,d2
	lsr.l	d2,d0
	add.l	#$10,d0
	ext.l	d0
	moveq	#$10,d2
	asl.l	d2,d0
	moveq	#$30,d1
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	moveq	#$10,d0
	ext.l	d0
	moveq	#$10,d2
	asl.l	d2,d0
	moveq	#$28,d1
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.l	-$68(a5),-(a7)
	jsr	Rect__xDRAW__UjUjUj
	add.w	#$C,a7
;			xDRAW::Rect(right, 		Coord(16,52),Coord(16+GetCol32A(ri
	move.l	-$6C(a5),d0
	moveq	#$18,d2
	lsr.l	d2,d0
	add.l	#$10,d0
	ext.l	d0
	moveq	#$10,d2
	asl.l	d2,d0
	moveq	#$3C,d1
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	moveq	#$10,d0
	ext.l	d0
	moveq	#$10,d2
	asl.l	d2,d0
	moveq	#$34,d1
	ext.l	d1
	and.l	#$FFFF,d1
	or.l	d1,d0
	move.l	d0,-(a7)
	move.l	-$6C(a5),-(a7)
	jsr	Rect__xDRAW__UjUjUj
	add.w	#$C,a7
;			SetCol32A(top, i);
	move.l	-$9C(a5),d1
	lea	-$60(a5),a0
	and.l	#$FFFFFF,(a0)
	moveq	#$18,d0
	asl.l	d0,d1
	or.l	d1,(a0)
;			SetCol32A(bottom, 255-i);
	move.l	#$FF,d1
	sub.l	-$9C(a5),d1
	lea	-$64(a5),a0
	and.l	#$FFFFFF,(a0)
	moveq	#$18,d0
	asl.l	d0,d1
	or.l	d1,(a0)
;			SetCol32A(left, i);
	move.l	-$9C(a5),d1
	lea	-$68(a5),a0
	and.l	#$FFFFFF,(a0)
	moveq	#$18,d0
	asl.l	d0,d1
	or.l	d1,(a0)
;			SetCol32A(right, 255-i);
	move.l	#$FF,d1
	sub.l	-$9C(a5),d1
	lea	-$6C(a5),a0
	and.l	#$FFFFFF,(a0)
	moveq	#$18,d0
	asl.l	d0,d1
	or.l	d1,(a0)
;		xDRAW::End();
	tst.l	_nestCount__xDRAW
	bne.b	L566
L565
	bra	L577
L566
	subq.l	#1,_nestCount__xDRAW
	tst.l	_nestCount__xDRAW
	bne.b	L572
L567
	bra.b	L569
L568
	bra	L577
L569
	and.l	#-2,_flags__xDRAW
	move.l	_context__x3D,a0
	move.l	_Warp3DBase,a6
	jsr	-$1B0(a6)
	move.l	_vBufPos__xDRAW,d0
	cmp.l	_maxVBufPos__xDRAW,d0
	ble.b	L571
L570
	move.l	_vBufPos__xDRAW,_maxVBufPos__xDRAW
L571
	clr.l	_vBufPos__xDRAW
	addq.l	#1,_flushCnt__xDRAW
L572
	move.l	_flags__xDRAW,d0
	and.l	#$10,d0
	beq.b	L576
L573
	bra.b	L575
L574
	bra.b	L576
L575
	and.l	#-$21,_flags__xDRAW
	move.l	_context__x3D,a0
	move.l	_Warp3DBase,a6
	jsr	-$42(a6)
L576
L577
;		ms += t.ElapsedSet();
	lea	-$8C(a5),a0
	move.l	a0,-$EC(a5)
	move.l	_TimerBase,a6
	move.l	#_current__xTIMABLE,a0
	jsr	-$3C(a6)
	move.l	_current__xTIMABLE,d1
	move.l	-$EC(a5),a1
	cmp.l	$8(a1),d1
	bne.b	L579
L578
	move.l	_current__xTIMABLE+4,d0
	move.l	-$EC(a5),a1
	sub.l	$C(a1),d0
	bra.b	L580
L579
	move.l	-$EC(a5),a1
	moveq	#-1,d0
	sub.l	$C(a1),d0
	move.l	_current__xTIMABLE+4,d1
	add.l	d1,d0
L580
	mulu.l	#$3E8,d0
	divul.l	_clockFreq__xTIMABLE,d0
	add.l	d0,-$74(a5)
;		win.Refresh();
	move.l	$8(a5),a1
	move.l	$52(a1),a0
	move.l	$8(a5),d0
	add.l	$24(a0),d0
	move.l	d0,-(a7)
	move.l	$20(a0),a0
	jsr	(a0)
	addq.w	#4,a7
;		win.WaitSync();
	move.l	_GfxBase,a6
	jsr	-$10E(a6)
	addq.l	#1,-$9C(a5)
	addq.l	#1,-$A0(a5)
L581
	move.l	-$9C(a5),d0
	cmp.l	#$100,d0
	blt	L482
L582
	lea	-$98(a5),a0
	jsr	lib_destruct_a0
	lea	-$44(a5),a0
	jsr	lib_destruct_a0
	move.l	-$74(a5),d0
	movem.l	(a7)+,d2-d6/a2/a6
	unlk	a5
	rts

L466
	dc.b	'Couldn't load texture',$A,'Reason %s',0
L468
	dc.b	'Error',0
L467
	dc.b	'OK',0
L465
	dc.b	'robot.tex',0
L469
	dc.b	'timer.device',0

	SECTION "BenchmarkQuadrics__R08xDISPLAY:0",CODE


;uint32 BenchmarkQuadrics(xDISPLAY& test)
	XDEF	BenchmarkQuadrics__R08xDISPLAY
BenchmarkQuadrics__R08xDISPLAY
L585	EQU	0
	link	a5,#L585
L584
	moveq	#0,d0
	unlk	a5
	rts

	SECTION "_0dt__xTIMABLE__T:0",CODE

	CNOP	0,2

	XDEF	_0dt__xTIMABLE__T
_0dt__xTIMABLE__T
L587	EQU	0
	link	a5,#L587
L586
	unlk	a5
	rts

	SECTION "_0dt__xTIMER__T:0",CODE

	CNOP	0,2

	XDEF	_0dt__xTIMER__T
_0dt__xTIMER__T
L589	EQU	-4
	link	a5,#L589
L588
	unlk	a5
	rts

	SECTION "Width__AREA__T:0",CODE

	CNOP	0,2

	XDEF	Width__AREA__T
Width__AREA__T
L591	EQU	0
	link	a5,#L591
	move.l	$8(a5),a0
L590
	move.w	(a0),d0
	ext.l	d0
	unlk	a5
	rts

	SECTION "Height__AREA__T:0",CODE

	CNOP	0,2

	XDEF	Height__AREA__T
Height__AREA__T
L593	EQU	0
	link	a5,#L593
	move.l	$8(a5),a0
L592
	move.w	2(a0),d0
	ext.l	d0
	unlk	a5
	rts

	SECTION "Depth__AREA__T:0",CODE

	CNOP	0,2

	XDEF	Depth__AREA__T
Depth__AREA__T
L595	EQU	0
	link	a5,#L595
	move.l	$8(a5),a0
L594
	move.w	4(a0),d0
	ext.l	d0
	unlk	a5
	rts

	SECTION "Format__AREA__T:0",CODE

	CNOP	0,2

	XDEF	Format__AREA__T
Format__AREA__T
L597	EQU	0
	link	a5,#L597
	move.l	$8(a5),a0
L596
	move.w	6(a0),d0
	ext.l	d0
	unlk	a5
	rts

	SECTION "_0dt__AREA__T:0",CODE

	CNOP	0,2

	XDEF	_0dt__AREA__T
_0dt__AREA__T
L599	EQU	0
	link	a5,#L599
L598
	unlk	a5
	rts

	SECTION "_0dt__xTEXTURE__T:0",CODE

	CNOP	0,2

	XDEF	_0dt__xTEXTURE__T
_0dt__xTEXTURE__T
L601	EQU	-4
	link	a5,#L601
	move.l	$8(a5),a0
L600
	move.l	a0,-(a7)
	jsr	Delete__xTEXTURE__T
	addq.w	#4,a7
	unlk	a5
	rts

	SECTION "_0virttab__08xTEXTURE__08xTEXTURE:0",CODE

	XDEF	_0virttab__08xTEXTURE__08xTEXTURE
_0virttab__08xTEXTURE__08xTEXTURE
	dc.l	$38,0
	dc.l	_0dt__xTEXTURE__T,0
	dc.l	Format__AREA__T,0
	dc.l	Depth__AREA__T,0
	dc.l	Height__AREA__T,0
	dc.l	Width__AREA__T,0
	dc.l	$38,0
	dc.l	_0dt__xTEXTURE__T,0

	END
